### 缘起

+ 《深入理解Linux网络技术内幕》中没有分析到传输层
+ 《LINUX内核源码剖析》下册chap33讲到了UDP，*tcp实在是太复杂了，先从UDP开始*
+ 《深入理解Linux内核架构》12.9.1讲的是udp

### 内容

#### 2.1、学到前面的

+ udp对应的rfc768，总共没几页，*自己大概看了一下*
+ **之前不知道的是**，有个rfc2828对应的UDP-lite，代码也有实现，*轻量级体现在哪里呢*

##### 2.1.1、UDP的输入udp_rcv

+ IP层从`ip_local_deliver()`到网络层的UDP`udp_rcv()`是开始
+ *这一系列数据的组装，自己还没看呢*，或者说*看了也没记住*

##### 2.1.2、UPD的输出udp_sendmsg

+ 直接调用IP层的`ip_append_data()`

#### 2.2、自己的疑惑

##### 2.2.1、怎么匹配目标套接口

+ `__udp4_lib_lookup()`

##### 2.2.2、数据放到哪个接收队列中

+ sock结构中的`sk_receive_queue`是UDP的接收队列

#### 2.3、常用的结构

##### 2.3.1、inet_protosw结构中指定了SOCK_DGRAM

##### 2.3.2、udp_sock是对inet_sock的扩展

##### 2.3.3、一些系统调用

+ bind
+ close
+ connect
+ select
+ sendmsg
+ recvmsg
+ udp_rcv
+ *以上几个细节，都没好好看*

#### 2.4、其它

##### 2.4.1、套接口选项

+ *没想到，这里还有个 套接口选项*

##### 2.4.2、校验和

+ **这个是可选的**，不知道在一些项目中，是不是必然打开的

### 最后

+ 初步看了一遍，具体的udp.c没有好好读一下，留着后面慢慢读吧，前面只是为了建立个框架知识
+ 还是回到了sock结构和socket结构的区别
  + sock是到网络访问层的接口
  + socket是到用户空间的接口