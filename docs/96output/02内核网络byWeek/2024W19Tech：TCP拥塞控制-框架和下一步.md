## 缘起

+ 19周在看《Linux内核源码剖析-tcpip实现(下)》chap29拥塞控制
+ 之前在网络中学过**拥塞控制**，但又没完全学透，*现在也没有，想通过这部分，给学透*
  + 比如会知道**慢启动，快速重传**这些名词，*但也就是考试的时候提提，没有真正学好*
  + [协议：TCP缓冲区&滑窗&拥塞控制&慢启动 (建议收藏!)](https://blog.csdn.net/shengqianfeng/article/details/107379400)
+ 2024-05-08，用时25min，22:17-22:42

## 内容

### 2.1、理论知识

+ 目前先配合一下《图解TCPIP》从6.4.6-6.4.9，从窗口控制到拥塞控制，自己要有个数

### 2.2、chap29讲的内容

#### 1、拥塞控制引擎

+ 对应29.1，*实话，目前没看懂*

#### 2、状态变化，转换

+ 状态变化，对应29.2，

+ 有了个概念，**open、loss**，但状态怎么迁移，*我可能知识密度不够，没太懂那个图*

+ 书上是v2的，自己看了下v6的内核，tcp_input.c中的确实有`tcp_enter_loss()`函数，*但代码还没有逐行去读*

+ **状态转换**用到了一些默认的状态，对应29.5，一些处理函数是

  + `tcp_fastretrans_alert()`，**虽然fastretrans有点难认，但应该是快速重传的意思**
  + `tcp_ack()`
  + *这个里面，应该都是核心的细节，但应该也不会变动啥了*

  + 

#### 3、状态撤销

+ 对应29.3，
+ *这部分的背景知识不是太了解*
+ 通用函数是`tcp_undo_cwnd_reduction()`这是V6的，书上的是`tcp_undo_cwr()`已经废弃了，但**其它的调用函数还是存在的**，比如
  + `tcp_try_undo_partial()`

#### 4、算法（F-RTO），已废弃

+ 对应书29.7，
+ V6里就不太有这个函数了，会有一些配置，也能搜到

#### 5、多拥塞控制

+ 对应书29.9
+ 对应的是tcp_cong.c
+ **书中提到的算法**
  + **我知道的cubic，bbr**，好像没提到
  + net/ipv4/tcp_vegas.c，算法是**tcp_vegas**，给我看代码提供了思路
  + net/ipv4/tcp_bic.c
+ *得找个理论，然后对应代码实现一样*，就像看paper，找到伪代码，再看作者的开源代码，互相对应理解一下
+ **重新看了下，就找到了tcp_bbr.c，tcp_cubic.c**，https://elixir.bootlin.com/linux/latest/source/net/ipv4
  + 不知道这个bbr和webrtc里的bbr是不是一样
  + cubic，可能跟tcp_bic.c有点关系，https://elixir.bootlin.com/linux/latest/source/net/ipv4/tcp_bic.c，找个理论看一看

## 最后

### 总结

+ 大概3个方面（也是下阶段要细化的）
  + 1、拥塞控制的理论（前因后果），*至少要能讲出来，不是说 碎片化的*
  + 2、从**状态的类型，到状态转换的代码逻辑**
  + 3、具体拥塞控制算法，**比如cubic或bbr，从理论到代码实现**
+ *要是把这3方面梳理出来，也是一篇好的技术blog*

### 下一步

+ 按上面的目标去完善内容