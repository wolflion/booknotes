{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u7f51\u7edc\u7f16\u7a0b \u00b6 \u300aTCP/IP\u7f51\u7edc\u7f16\u7a0b\u300b \u60f3\u5199\u4e00\u4e0b\uff0c\u5404\u4e2atopic\u7684\u5b66\u4e60\u4e4b\u8def 2023\u5e74 \u00b6 \u4e3b\u9898\u662f \u64cd\u4f5c\u7cfb\u7edf \uff0c\u884d\u751f\u51fa\u6765\uff0cunix\u73af\u5883\u7f16\u7a0b\u3001\u7f51\u7edc\u7f16\u7a0b\u3001\u6587\u4ef6\u7cfb\u7edf 2023\u5e74Q2\uff1a \u00b6 \u300aTCP/IP\u7f51\u7edc\u7f16\u7a0b\u300b\u5168\u4e66\u7406\u89e380%\u4ee5\u4e0a\uff0c \u8003\u8651\u5148\u628a\u5168\u4e66\u5b8c\u5168\u8bfb\u61c2\uff0c\u518d\u505a\u4e0b\u540e\u9762\u4e60\u9898 \uff0c \u6ca1\u6709\u5b8c\u5168\u4e0d\u61c2\u7684\u77e5\u8bc6\u70b9 \u300aUnix\u7f16\u7a0b\u624b\u518c\u300bsocket\u90e8\u5206\uff0c\u7406\u89e380%\u4ee5\u4e0a\uff0c \u6ca1\u6709\u5b8c\u5168\u4e0d\u61c2\u7684\u77e5\u8bc6\u70b9","title":"\u7b80\u4ecb"},{"location":"#_1","text":"\u300aTCP/IP\u7f51\u7edc\u7f16\u7a0b\u300b \u60f3\u5199\u4e00\u4e0b\uff0c\u5404\u4e2atopic\u7684\u5b66\u4e60\u4e4b\u8def","title":"\u7f51\u7edc\u7f16\u7a0b"},{"location":"#2023","text":"\u4e3b\u9898\u662f \u64cd\u4f5c\u7cfb\u7edf \uff0c\u884d\u751f\u51fa\u6765\uff0cunix\u73af\u5883\u7f16\u7a0b\u3001\u7f51\u7edc\u7f16\u7a0b\u3001\u6587\u4ef6\u7cfb\u7edf","title":"2023\u5e74"},{"location":"#2023q2","text":"\u300aTCP/IP\u7f51\u7edc\u7f16\u7a0b\u300b\u5168\u4e66\u7406\u89e380%\u4ee5\u4e0a\uff0c \u8003\u8651\u5148\u628a\u5168\u4e66\u5b8c\u5168\u8bfb\u61c2\uff0c\u518d\u505a\u4e0b\u540e\u9762\u4e60\u9898 \uff0c \u6ca1\u6709\u5b8c\u5168\u4e0d\u61c2\u7684\u77e5\u8bc6\u70b9 \u300aUnix\u7f16\u7a0b\u624b\u518c\u300bsocket\u90e8\u5206\uff0c\u7406\u89e380%\u4ee5\u4e0a\uff0c \u6ca1\u6709\u5b8c\u5168\u4e0d\u61c2\u7684\u77e5\u8bc6\u70b9","title":"2023\u5e74Q2\uff1a"},{"location":"01daily/","text":"2023\u5e74 \u00b6 2023Q2 \u00b6 20230402\u540c\u6b65\uff0c\u4e92\u65a5\uff0cPV\u64cd\u4f5c.md \uff0c \u4e92\u8054\u7f51 20230410\u5f00\u59cb\u7f51\u7edc\u7f16\u7a0b \uff0c\u539f\u578b\u300aTCP/IP\u7f51\u7edc\u7f16\u7a0b\u300b\u7684Part01","title":"daily"},{"location":"01daily/#2023","text":"","title":"2023\u5e74"},{"location":"01daily/#2023q2","text":"20230402\u540c\u6b65\uff0c\u4e92\u65a5\uff0cPV\u64cd\u4f5c.md \uff0c \u4e92\u8054\u7f51 20230410\u5f00\u59cb\u7f51\u7edc\u7f16\u7a0b \uff0c\u539f\u578b\u300aTCP/IP\u7f51\u7edc\u7f16\u7a0b\u300b\u7684Part01","title":"2023Q2"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/","text":"Part01\u3001TCP/IP\u534f\u8bae\u8be6\u89e3\uff081-4\uff09 \u00b6 chap1\u3001TCP/IP\u534f\u8bae\u65cf 1.1\u3001TCP/IP\u534f\u8bae\u65cf\u4f53\u7cfb\u7ed3\u6784\u4ee5\u53ca\u4e3b\u8981\u534f\u8bae \u00b6 0 \u00b6 \u56db\u5c42\uff0c \u4e3b\u8981\u662f socket() \u4e0a\u9762\u7684\u662f\u5e94\u7528\u5c42\uff0c\uff08\u4f20\u8f93\u5c42\u53ca\u4ee5\u4e0b\uff0c\u662f\u5185\u6838\u5c42\uff09 \uff0c \u8fd9\u662f\u4e4b\u524d\u6ca1\u6709\u6ce8\u610f\u5230\u7684,lionel 1.1.1\u3001\u6570\u636e\u94fe\u8def\u5c42 \u00b6 ARP,RARP 1.1.2\u3001\u7f51\u7edc\u5c42 \u00b6 \u6570\u636e\u5305\u7684\u9009\u8def\u548c\u8f6c\u53d1\u3002 IP\u534f\u8bae\u4f7f\u7528\u9010\u8df3\uff08hop by hop\uff09\u7684\u65b9\u5f0f\u786e\u5b9a\u901a\u4fe1\u8def\u5f84 \u4e24\u7c7bIP\u3001ICMP ICMP\u5206\u4e3a\u4e24\u79cd\uff1a\u5dee\u9519\u62a5\u6587\uff1b\u67e5\u8be2\u62a5\u6587 1.1.3\u3001\u4f20\u8f93\u5c42 \u00b6 \u4e3a\u4e24\u53f0\u4e3b\u673a\u4e0a\u7684\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u7aef\u5230\u7aef\uff08end to end\uff09\u7684\u901a\u4fe1 TCP\u3001UDP\u3001SCTP 1.1.4\u3001\u5e94\u7528\u5c42 \u00b6 \u5904\u7406\u5e94\u7528\u7a0b\u5e8f\u7684\u903b\u8f91 telent\u662f\u534f\u8bae\uff0cospf\uff0cdns ping\u53ea\u662f\u547d\u4ee4\uff0c\u4e0d\u662f\u534f\u8bae\uff0c\u7528\u7684\u662fICMP\u534f\u8bae\u3002 1.2\u3001\u5c01\u88c5 \u00b6 1.3\u3001\u5206\u7528 \u00b6 1.4\u3001\u6d4b\u8bd5\u7f51\u7edc \u00b6 1.5\u3001arp\u534f\u8bae\u5de5\u4f5c\u539f\u7406 \u00b6 1.5.1\u3001\u4ee5\u592a\u7f51arp\u8bf7\u6c42/\u5e94\u7b54\u62a5\u6587\u8be6\u89e3 \u00b6 1.5.2\u3001arp\u9ad8\u901f\u7f13\u5b58\u7684\u67e5\u770b\u548c\u4fee\u6539 \u00b6 arp -a \u3010arp -d\u5220\u9664\uff0c-s\u6dfb\u52a0\u3011 1.5.3\u3001\u4f7f\u7528tcpdump\u89c2\u5bdfarp\u901a\u4fe1\u8fc7\u7a0b \u00b6 tcpdump -i eth0 -ent 'dst 192.168.1.109 and src 192.168.1.108' tcpdump\u6293\u53d6\u7684\u6570\u636e\u5305\u672c\u8d28\u4e0a\u662f\u4ee5\u592a\u7f51\u5e27 1.6\u3001dns\u5de5\u4f5c\u539f\u7406 \u00b6 1.6.1\u3001dns\u67e5\u8be2\u548c\u5e94\u7b54\u62a5\u6587\u8be6\u89e3 \u00b6 1.6.2\u3001linux\u4e0b\u8bbf\u95eedns\u670d\u52a1 \u00b6 more /etc/resolv.conf host -t A www.baidu.com 1.6.3\u3001\u4f7f\u7528tcpdump\u89c2\u5bdfdns\u901a\u4fe1\u8fc7\u7a0b \u00b6 tcpdump -i eth0 -nt -s 500 port domain 1.7\u3001socket\u4e0etcp/ip\u534f\u8bae\u65cf\u7684\u5173\u7cfb \u00b6 \u6570\u636e\u94fe\u8def\u5c42\u3001\u7f51\u7edc\u5c42\u3001\u4f20\u8f93\u5c42\u534f\u8bae\u90fd\u662f\u5728\u5185\u6838\u4e2d\u5b9e\u73b0\u7684 \uff0cOS\u5c31\u9700\u8981\u5b9e\u73b0\u4e00\u7ec4\u7cfb\u7edf\u8c03\u7528\uff0c\u4f7f\u5f97\u5e94\u7528\u7a0b\u5e8f\u80fd\u591f\u8bbf\u95ee\u8fd9\u4e9b\u534f\u8bae\u63d0\u4f9b\u7684\u670d\u52a1\u3002 socket\u7684\u8fd9\u7ec4API\u6709\u4e24\u70b9\u529f\u80fd\uff1a + 1\u3001\u5c06\u5e94\u7528\u7a0b\u5e8f\u6570\u636e\u4ece\u7528\u6237\u7f13\u51b2\u533a\u4e2d\u590d\u5236\u5230TCP/UDP\u5185\u6838\u7f13\u51b2\u533a\uff0c\u4ee5\u4ea4\u4ed8\u5185\u6838\u6765\u53d1\u9001\u6570\u636e\uff08\u6216\u8bfb\u53d6\u6570\u636e\uff09 + 2\u3001\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u901a\u8fc7\u5b83\u4eec\u6765\u4fee\u6539\u5185\u6838\u4e2d\u5404\u5c42\u534f\u8bae\u7684\u67d0\u4e9b\u5934\u90e8\u4fe1\u606f\u6216\u5176\u4ed6\u6570\u636e\u7ed3\u6784\uff0c\u4ece\u800c\u7cbe\u7ec6\u5730\u63a7\u5236\u5e95\u5c42\u901a\u4fe1\u7684\u884c\u4e3a chap2\u3001ip\u534f\u8bae\u8be6\u89e3 0\u3001 \u00b6 \u4ece2\u65b9\u9762\u63a2\u8ba8\uff1a + IP\u5934\u90e8\u4fe1\u606f + IP\u6570\u636e\u62a5\u7684\u8def\u7531\u548c\u8f6c\u53d1 2.1\u3001IP\u670d\u52a1\u7684\u7279\u70b9 \u00b6 \u4e3a\u4e0a\u5c42\u534f\u8bae\u63d0\u4f9b \u65e0\u72b6\u6001\u3001\u65e0\u8fde\u63a5\u3001\u4e0d\u53ef\u9760\u7684\u670d\u52a1 2.2\u3001IPv4\u5934\u90e8\u7ed3\u6784 \u00b6 2.2.1\u3001IPv4\u5934\u90e8\u7ed3\u6784 \u00b6 2.2.2\u3001\u4f7f\u7528tcpdump\u89c2\u5bdfipv4\u5934\u90e8\u7ed3\u6784 \u00b6 tcpdump -ntx -i lo \u6293\u53d6\u672c\u5730\u56de\u8def\u4e0a\u7684\u6570\u636e\u5305 2.3\u3001IP\u5206\u7247 \u00b6 \u5f53IP\u6570\u636e\u62a5\u7684\u957f\u5ea6\u8d85\u8fc7\u5e27\u7684MTU\u65f6\uff0c\u5b83\u5c06\u88ab\u5206\u7247\u4f20\u8f93 \uff08\u5206\u7247\u53ef\u80fd\u53d1\u751f\u5728\u53d1\u9001\u7aef\u3001\u53ef\u80fd\u5728\u4e2d\u8f6c\u8def\u7531\u5668\u4e0a\uff0c\u4e5f\u53ef\u80fd\u5728\u4f20\u8f93\u8fc7\u7a0b\u4e2d\uff09 \u4ee5\u592a\u7f51\u5e27\u7684MTU\u662f1500\u5b57\u8282\uff08\u51cf\u53bbIP\u5934\u90e820\u5b57\u8282\uff0c\u6700\u591a1480\u5b57\u8282\uff09 \u3010 ifconfig \u770b\u4e86\u4e0b, lo \u662f65535\u5b57\u8282\uff0c\u5176\u5b83\u662f1500\uff0c netstat -i \u4e5f\u53ef\u4ee5\u770b\u5230\u3011 2.4\u3001IP\u8def\u7531 \u00b6 2.4.1\u3001ip\u6a21\u5757\u5de5\u4f5c\u6d41\u7a0b \u00b6 2.4.2\u3001\u8def\u7531\u673a\u5236 \u00b6 route \u6216 netstat \u7684\u547d\u4ee4 2.4.3\u3001\u8def\u7531\u8868\u66f4\u65b0 \u00b6 2.5\u3001IP\u8f6c\u53d1 \u00b6 \u8981\u627e\u5f00\u4e00\u4e0b /proc/sys/net/ipv4/ip_forward \u5185\u6838\u53c2\u6570\u9ed8\u8ba4\u88ab\u8bbe\u7f6e\u4e3a0 2.6\u3001\u91cd\u5b9a\u5411 \u00b6 2.6.1\u3001icmp\u91cd\u5b9a\u5411\u62a5\u6587 \u00b6 /proc/sys/net/ipv4/conf/all/send_redirects \uff0c\u5185\u6838\u53c2\u6570\u6307\u5b9a\u662f\u5426\u5141\u8bb8\u53d1\u9001ICMP\u91cd\u5b9a\u5411\u62a5\u6587 /proc/sys/net/ipv4/conf/all/accept_redirects \uff0c\u63a5\u6536ICMP\u91cd\u5b9a\u5411\u62a5\u6587 2.6.2\u3001\u4e3b\u673a\u91cd\u5b9a\u5411\u5b9e\u4f8b \u00b6 2.7\u3001IPv6\u5934\u90e8\u7ed3\u6784 \u00b6 0\u3001 \u00b6 RFC 2460 2.7.1\u3001ipv6\u56fa\u5b9a\u5934\u90e8\u7ed3\u6784 \u00b6 40\u5b57\u8282\u5927\u5c0f 2.7.2\u3001ipv6\u6269\u5c55\u5934\u90e8 \u00b6 chap3\u3001tcp\u534f\u8bae\u8be6\u89e3 0 \u00b6 \u4ee5\u4e0b4\u4e2a\u65b9\u9762\u8ba8\u8bbaTCP\u534f\u8bae + TCP\u5934\u90e8\u4fe1\u606f\uff08\u7ba1\u7406TCP\u8fde\u63a5\uff0c\u63a7\u5236\u4e24\u4e2a\u65b9\u5411\u7684\u6570\u636e\u6d41\uff09 + TCP\u72b6\u6001\u8f6c\u79fb\u8fc7\u7a0b\uff08TCP\u8fde\u63a5\u7684\u4efb\u610f\u4e00\u7aef\u90fd\u662f\u4e00\u4e2a\u72b6\u6001\u673a\uff09 + TCP\u6570\u636e\u6d41\uff08\u4ea4\u4e92\u6570\u636e\u6d41\u3001\u6210\u5757\u6570\u636e\u6d41\uff09 + TCP\u6570\u636e\u6d41\u7684\u63a7\u5236\uff08\u8d85\u65f6\u91cd\u4f20\u3001\u62e5\u585e\u63a7\u5236\uff09 3.1\u3001tcp\u670d\u52a1\u7684\u7279\u70b9 \u00b6 TCP\u8fde\u63a5\u662f\u5168\u53cc\u5de5\u7684\uff0c \u5373\u53cc\u65b9\u7684\u6570\u636e\u8bfb\u5199\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u8fde\u63a5\u8fdb\u884c \u3002 TCP\u534f\u8bae\u662f\u4e00\u5bf9\u4e00\u7684\uff0c\u6240\u4ee5\u5e7f\u64ad\u548c\u591a\u64ad\u4e0d\u80fd\u4f7f\u7528TCP\u670d\u52a1 \u53d1\u9001\u7aef\u6267\u884c\u7684\u5199\u64cd\u4f5c\u6b21\u6570\u548c\u63a5\u6536\u7aef\u6267\u884c\u7684\u8bfb\u64cd\u4f5c\u6b21\u6570\u4e4b\u95f4\u6ca1\u6709\u4efb\u4f55\u6570\u91cf\u5173\u7cfb\uff0c \u8fd9\u5c31\u662f\u5b57\u8282\u6d41\u7684\u6982\u5ff5 3.2\u3001tcp\u5934\u90e8\u7ed3\u6784 \u00b6 3.2.1\u3001tcp\u56fa\u5b9a\u5934\u90e8\u7ed3\u6784 \u00b6 3.2.2\u3001tcp\u5934\u90e8\u9009\u9879 \u00b6 \u5934\u90e8\u9009\u9879\u6700\u591a40\u4e2a\u5b57\u8282\uff08\u5934\u90e8\u6700\u957f60\u5b57\u8282\uff0c\u51cf\u53bb 20\u5b57\u8282\u7684\u56fa\u5b9a\u90e8\u5206\uff09 7\u4e2a\u9009\u9879\uff0ckind\u7684\u53d6\u503c + 0 + 1 + 2 + 3 + 4 + 5 + 8 3.2.3\u3001\u4f7f\u7528tcpdump\u89c2\u5bdftcp\u5934\u90e8\u4fe1\u606f \u00b6 3.3\u3001tcp\u8fde\u63a5\u7684\u5efa\u7acb\u548c\u5173\u95ed \u00b6 3.3.1\u3001\u4f7f\u7528tcpdump\u89c2\u5bdftcp\u8fde\u63a5\u7684\u5efa\u7acb\u548c\u5173\u95ed \u00b6 3.3.2\u3001\u534a\u5173\u95ed\u72b6\u6001 \u00b6 3.3.3\u3001\u8fde\u63a5\u8d85\u65f6 \u00b6 /proc/sys/net/ipv4/tcp_syn_retries \u4e2d\u5b9a\u4e49\u4e86\u91cd\u8fde\u6b21\u6570 3.4\u3001tcp\u72b6\u6001\u8f6c\u79fb \u00b6 3.4.1\u3001tcp\u72b6\u6001\u8f6c\u79fb\u603b\u56fe \u00b6 3.4.2\u3001time_wait\u72b6\u6001 \u00b6 3.5\u3001\u590d\u4f4d\u62a5\u6587\u6bb5 \u00b6 3.5.1\u3001\u8bbf\u95ee\u4e0d\u5b58\u5728\u7684\u7aef\u53e3 \u00b6 3.5.2\u3001\u5f02\u5e38\u7ec8\u6b62\u8fde\u63a5 \u00b6 socket \u9009\u9879\u4e2d\u7684 SO_LINGER \u6765\u53d1\u9001\u590d\u4f4d\u62a5\u6587\u6bb5\uff0c\u4ee5\u5f02\u5e38\u7ec8\u6b62\u8fde\u63a5 3.5.3\u3001\u5904\u7406\u534a\u6253\u5f00\u8fde\u63a5 \u00b6 3.6\u3001tcp\u4ea4\u4e92\u6570\u636e\u6d41 \u00b6 \u4ec5\u5305\u542b\u5f88\u5c11\u7684\u5b57\u8282 \uff0c\u5bf9\u5b9e\u65f6\u6027\u8981\u6c42\u9ad8 3.7\u3001tcp\u6210\u5757\u6570\u636e\u6d41 \u00b6 tcpdump -nt -i eth0 port 20 #vsftpd\u670d\u52a1\u5668\u7a0b\u5e8f\u4f7f\u7528\u7aef\u53e3\u53f720 3.8\u3001tcp\u5e26\u5916\u6570\u636e \u00b6 \u7528\u4e8e\u8fc5\u901f\u901a\u544a\u5bf9\u65b9\u672c\u7aef\u53d1\u751f\u7684\u91cd\u8981\u4e8b\u4ef6 \uff0c\u6bd4\u666e\u901a\u6570\u636e\uff08\u4e5f\u53eb\u5e26\u5185\u6570\u636e\uff09\u6709\u66f4\u9ad8\u7684\u4f18\u5148\u7ea7 \u5229\u7528\u7684\u662fTCP\u5934\u90e8\u4e2d\u7684\u7d27\u6025\u6307\u9488\u6807\u5fd7\u548c\u7d27\u6025\u6307\u9488\u4e24\u4e2a\u5b57\u6bb5 3.9\u3001tcp\u8d85\u65f6\u91cd\u4f20 \u00b6 iperf\u662f\u4e00\u4e2a\u6d4b\u91cf\u7f51\u7edc\u72b6\u51b5\u7684\u5de5\u5177 3.10\u3001\u62e5\u585e\u63a7\u5236 \u00b6 3.10.1\u3001\u62e5\u585e\u63a7\u5236\u6982\u8ff0 \u00b6 rfc5681 3.10.2\u3001\u6162\u542f\u52a8\u548c\u62e5\u585e\u907f\u514d \u00b6 3.10.3\u3001\u5feb\u901f\u91cd\u4f20\u548c\u5feb\u901f\u6062\u590d \u00b6 chap4\u3001tcp/ip\u901a\u4fe1\u6848\u4f8b\uff1a\u8bbf\u95eeinternet\u4e0a\u7684Web\u670d\u52a1\u5668 4.1\u3001\u5b9e\u4f8b\u603b\u56fe \u00b6 4.2\u3001\u90e8\u7f72\u4ee3\u7406\u670d\u52a1\u5668 \u00b6 4.2.1\u3001http\u4ee3\u7406\u670d\u52a1\u5668\u7684\u5de5\u4f5c\u539f\u7406 \u00b6 4.2.2\u3001\u90e8\u7f72squid\u4ee3\u7406\u670d\u52a1\u5668 \u00b6 4.3\u3001\u4f7f\u7528tcpdup\u6293\u53d6\u4f20\u8f93\u6570\u636e\u5305 \u00b6 4.4\u3001\u8bbf\u95eedns\u670d\u52a1\u5668 \u00b6 4.5\u3001\u672c\u5730\u540d\u79f0\u67e5\u8be2 \u00b6 4.6\u3001HTTP\u901a\u4fe1 \u00b6 4.6.1\u3001http\u8bf7\u6c42 \u00b6 4.6.2\u3001http\u5e94\u7b54 \u00b6 4.7\u3001\u5b9e\u4f8b\u603b\u7ed3 \u00b6 Part02\u3001\u6df1\u5165\u89e3\u6790\u9ad8\u6027\u80fd\u670d\u52a1\u5668\u7f16\u7a0b\uff084-15\uff09 \u00b6 \u7f51\u7edc\u7f16\u7a0bAPI\uff085-7\uff09 \u9ad8\u6027\u80fd\u7a0b\u5e8f\u7684\u4e00\u822c\u6846\u67b6\uff088\uff09 \u670d\u52a1\u5668\u7a0b\u5e8f\u7684IO\u5355\u5143\uff089-12\uff09\uff1aIO\u4e8b\u4ef6\u3001\u4fe1\u53f7\u3001\u5b9a\u65f6\u3001libevent \u670d\u52a1\u5668\u7a0b\u5e8f\u7684\u903b\u8f91\u5355\u5143\uff0813-15\uff09\uff1a\u591a\u8fdb\u7a0b\u3001\u591a\u7ebf\u7a0b chap5\u3001Linux\u7f51\u7edc\u7f16\u7a0b\u57fa\u7840API \u00b6 0\u3001 \u00b6 3\u4e2a\u65b9\u9762\u8ba8\u8bbaLinux\u7f51\u7edcAPI socket\u5730\u5740API socket\u57fa\u7840API \u7f51\u7edc\u4fe1\u606fAPI 5.1\u3001socket\u5730\u5740api \u00b6 5.1.1\u3001 \u00b6 5-1\uff1a\u5224\u65ad\u673a\u5668\u5b57\u8282\u5e8f #include <stdio.h> void byteorder() { union{ short value; char union_bytes[sizeof(short)]; } test; test.value = 0x0102; if((test.union_bytes[0] == 1) && (test.union_bytes[1] == 2)){ printf(\"big endian\\n\"); } else if((test.union_bytes[0] == 2) && (test.union_bytes[1] == 1)){ printf(\"little endian\\n\"); }else{ printf(\"unknown...\\n\"); } } 5.1.2\u3001\u901a\u7528 \u00b6 5.1.3\u3001\u4e13\u7528 \u00b6 5.1.4\u3001IP\u5730\u5740\u8f6c\u6362\u51fd\u6570 \u00b6 5.8\u3001\u6570\u636e\u8bfb\u5199 \u00b6 5.8.1\u3001tcp\u6570\u636e\u8bfb\u5199 \u00b6 5-6\uff1a\u53d1\u9001\u5e26\u5916\u6570\u636e #include<sys/socket.h> #include<netinet/in.h> #include<arpa/inet.h> #include<asser.h> #include<stdio.h> #include<unistd.h> #include<string.h> #include<stdlib.h> int main(int argc, char *argv[]){ if(argc <= 2){ printf(\"usage: %s ip_address port_number\\n\", basename(argv[0])); return 1; } const char* ip = argv[1]; int port = atoi(argv[2]); struct sockaddr_in server_address; bzero(&server_address, sizeof(server_address)); server_address.sin_family = AF_INET; inet_pton(AF_INET, ip, &server_address.sin_addr); } 5-7\uff1a\u63a5\u6536\u5e26\u5916\u6570\u636e 5.8.2\u3001udp\u6570\u636e\u8bfb\u5199 \u00b6 5.8.3\u3001\u901a\u7528\u6570\u636e\u8bfb\u5199\u51fd\u6570 \u00b6 5.9\u3001\u5e26\u5916\u6807\u8bb0 \u00b6 Linux\u5185\u6838\u68c0\u6d4b\u5230TCP\u7d27\u6025\u6807\u5fd7\u65f6\uff0c\u5c06\u901a\u77e5\u5e94\u7528\u7a0b\u5e8f\u6709\u5e26\u5916\u6570\u636e\u9700\u8981\u63a5\u6536\u3002 \u5185\u6838\u901a\u77e5\u5e94\u7528\u7a0b\u5e8f\u5e26\u5916\u6570\u636e\u5230\u8fbe\u7684\u4e24\u79cd\u5e38\u89c1\u65b9\u5f0f\u662f\uff1a I/O\u590d\u7528\u4ea7\u751f\u7684\u5f02\u5e38\u4e8b\u4ef6 SIGURG\u4fe1\u53f7 5.11\u3001socket\u9009\u9879 \u00b6 5.12\u3001\u7f51\u7edc\u4fe1\u606fapi \u00b6 5.12.3\u3001getaddrinfo \u00b6 chap6\u3001\u9ad8\u7ea7I/O\u51fd\u6570 \u00b6 6.1\u3001pipe\u51fd\u6570 \u00b6 6.2\u3001dup\u51fd\u6570\u548cdup2\u51fd\u6570 \u00b6 6.3\u3001readv\u51fd\u6570\u548cwritev\u51fd\u6570 \u00b6 readv\u51fd\u6570\u5c06\u6570\u636e\u4ece\u6587\u4ef6\u63cf\u8ff0\u7b26\u8bfb\u5230\u5206\u6563\u7684\u5185\u5b58\u5757\u4e2d\uff0c\u5373 \u5206\u6563\u8bfb writev\u51fd\u6570\uff0c \u96c6\u4e2d\u5199 6.4\u3001sendfile\u51fd\u6570 \u00b6 \u5728\u4e24\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e4b\u95f4\u76f4\u63a5\u4f20\u9012\u6570\u636e\uff08\u5b8c\u5168\u5728\u5185\u6838\u4e2d\u64cd\u4f5c\uff09 \uff0c\u4ece\u800c\u907f\u514d\u4e86\u5185\u6838\u7f13\u51b2\u533a\u548c\u7528\u6237\u7f13\u51b2\u533a\u4e4b\u95f4\u7684\u6570\u636e\u62f7\u8d1d\uff0c\u6548\u7387\u5f88\u9ad8\uff0c\u79f0\u4e3a \u96f6\u62f7\u8d1d \u3002 #include <sys/sendfile.h> ssize_t sendfile(int out_fd, int in_fd, off_t *offset, size_t count); 6.5\u3001mmap\u51fd\u6570\u548cmunmap\u51fd\u6570 \u00b6 mmap\u51fd\u6570\u7528\u4e8e\u7533\u8bf7\u4e00\u6bb5\u5185\u5b58\u7a7a\u95f4 \u3002\u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u6bb5\u5185\u5b58\u4f5c\u4e3a\u8fdb\u7a0b\u95f4\u901a\u4fe1\u7684\u5171\u4eab\u5185\u5b58\uff0c\u4e5f\u53ef\u4ee5\u5c06\u6587\u4ef6\u76f4\u63a5\u6620\u5c04\u5230\u5176\u4e2d\u3002 6.6\u3001splice\u51fd\u6570 \u00b6 splice\u51fd\u6570\u7528\u4e8e\u5728\u4e24\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e4b\u95f4\u79fb\u52a8\u6570\u636e\uff0c\u4e5f\u662f\u96f6\u62f7\u8d1d\u64cd\u4f5c #include<fcntl.h> ssize_t splice(int fd_in, loff_t *off_in, int fd_out, loff_t* off_out, size_t len, unsigned int flags); 6.7\u3001tee\u51fd\u6570 \u00b6 tee\u51fd\u6570\u5728\u4e24\u4e2a\u7ba1\u9053\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e4b\u95f4\u590d\u5236\u6570\u636e\uff0c\u4e5f\u662f\u96f6\u62f7\u8d1d\u64cd\u4f5c \u3002\u5b83\u4e0d\u6d88\u8017\u6570\u636e\uff0c\u56e0\u6b64\u6e90\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0a\u7684\u6570\u636e\u4ecd\u7136\u53ef\u4ee5\u7528\u4e8e\u540e\u7eed\u7684\u8bfb\u64cd\u4f5c\u3002 6.8\u3001fcntl\u51fd\u6570 \u00b6 #include <fcntl.h> int fcntl(int fd, int cmd, ...); chap7\u3001Linux\u670d\u52a1\u5668\u7a0b\u5e8f\u89c4\u8303 \u00b6 7.1\u3001\u65e5\u5fd7 \u00b6 7.1.1\u3001linux\u7cfb\u7edf\u65e5\u5fd7 \u00b6 rsyslogd\u5b88\u62a4\u8fdb\u7a0b\u65e2\u80fd\u63a5\u6536\u7528\u6237\u8fdb\u7a0b\u8f93\u51fa\u7684\u65e5\u5fd7\uff0c\u53c8\u80fd\u63a5\u6536\u5185\u6838\u65e5\u5fd7\u3002 \u7ec8\u7aef\u8f93\u51fa\u5185\u6838\u4fe1\u606f dmesg \u5185\u6838 printk() ->\u5185\u6838\u73af\u72b6\u7f13\u5b58 -> /proc/kmsg \u7528\u6237\u8fc7\u7a0b syslog() -> /dev/log -> syslogd ->\u914d\u7f6e\u6587\u4ef6 /var/log/* 7.1.2\u3001syslog\u65e5\u5fd7 syslog() \u51fd\u6570\u4e0ersyslogd\u5b88\u62a4\u8fdb\u7a0b\u901a\u4fe1 openlog() \u51fd\u6570\u6539\u53d8syslog\u7684\u9ed8\u8ba4\u8f93\u51fa\u65b9\u5f0f\uff0c\u8fdb\u4e00\u6b65\u7ed3\u6784\u5316\u65e5\u5fd7\u5185\u5bb9 7.2\u3001\u7528\u6237\u4fe1\u606f \u00b6 7.2.1\u3001UID\u3001EUID\u3001GID\u548cEGID \u00b6 7.2.2\u3001\u5207\u6362\u7528\u6237 \u00b6 \u4ee3\u78017-2\uff1a\u5207\u6362\u7528\u6237 static bool switch_to_user(uid_t user_id, gid_t gp_id){ //\u5148\u786e\u4fdd\u76ee\u6807\u7528\u6237\u4e0d\u662froot if((user_id == 0) && (gp_id == 0)) { return false; } //\u786e\u4fdd\u5f53\u524d\u7528\u6237\u662f\u5408\u6cd5\u7528\u6237\uff1aroot\u6216\u8005\u76ee\u6807\u7528\u6237 gid_t gid = getgid(); uid_t uid = getuid(); if(((gid != 0) || (uid != 0)) && ((gid != gp_id) || (uid != user_id))){ return false; } //\u5982\u679c\u4e0d\u662froot\uff0c\u5219\u5df2\u7ecf\u662f\u76ee\u6807\u7528\u6237 if(uid != 0){ return true; } //\u5207\u6362\u5230\u76ee\u6807\u7528\u6237 if((setgid(gp_id) < 0) || (setuid(user_id) < 0)){ return false; } } 7.3\u3001\u8fdb\u7a0b\u95f4\u5173\u7cfb \u00b6 7.3.1\u3001\u8fdb\u7a0b\u7ec4 \u00b6 7.3.2\u3001\u4f1a\u8bdd \u00b6 7.3.3\u3001\u7528ps\u547d\u4ee4\u67e5\u770b\u8fdb\u7a0b\u5173\u7cfb \u00b6 ps -o pid,ppid,pgid,sid,comm | less + bash\uff08fork\u51fa\u67652\u4e2a\uff0cps\u548cless \u547d\u4ee4\uff09 7.4\u3001\u7cfb\u7edf\u8d44\u6e90\u9650\u5236 #include<sys/resource.h> int getrlimit(int resource, struct rlimit *rlim); int setrlimit(int resource, const struct rlimit *rlim); struct rlimit{ rlim_t rlim_cur; //\u6307\u5b9a\u8d44\u6e90\u7684\u8f6f\u9650\u5236 rlim_t rlim_max; //\u6307\u5b9a\u8d44\u6e90\u7684\u786c\u9650\u5236 } 7.5\u3001\u6539\u53d8\u5de5\u4f5c\u76ee\u5f55\u548c\u6839\u76ee\u5f55 chdir() #include <unistd.h> char* getcwd(char *buf, size_t size); int chdir(const char* path); 7.6\u3001\u670d\u52a1\u5668\u7a0b\u5e8f\u540e\u53f0\u5316 \u00b6 daemon \u4ee3\u7801\u6e05\u53557-3\uff1a\u5c06\u670d\u52a1\u5668\u7a0b\u5e8f\u4ee5\u5b88\u62a4\u8fdb\u7a0b\u7684\u65b9\u5f0f\u8fd0\u884c bool daemonize() { //\u521b\u5efa\u5b50\u8fdb\u7a0b\uff0c\u5173\u95ed\u7236\u8fdb\u7a0b\uff0c\u8fd9\u6837\u53ef\u4ee5\u4f7f\u7a0b\u5e8f\u5728\u540e\u53f0\u8fd0\u884c pid_t pid = fork(); if(pid < 0) { return false;} else if(pid > 0) {exit(0);} //\u8bbe\u7f6e\u6587\u4ef6\u6743\u9650\u63a9\u7801\u3002\u5f53\u8fdb\u7a0b\u521b\u5efa\u6587\u4ef6\uff08\u4f7f\u7528open()\uff09\u65f6\uff0c\u6587\u4ef6\u7684\u6743\u9650\u5c06\u662fmode&07777 umask(0); //\u521b\u5efa\u65b0\u7684\u4f1a\u8bdd\uff0c\u8bbe\u7f6e\u672c\u8fdb\u7a0b\u4e3a\u8fdb\u7a0b\u7ec4\u7684\u9996\u9886 pid_t sid = setsid(); if(sid < 0) {return false;} //\u5207\u6362\u5de5\u4f5c\u76ee\u5f55 if((chdir(\"/\")) < 0) {return false;} //\u5173\u95ed\u6807\u51c6\u8f93\u5165\u8bbe\u5907\u3001\u8f93\u51fa\u8bbe\u5907\u3001\u9519\u8bef\u8f93\u51fa\u8bbe\u5907 close(STDIN_FILENO);close(STDOUT_FILENO);close(STDERR_FILENO); //\u5173\u95ed\u5176\u5b83\u5df2\u7ecf\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u4ee3\u7801\u7701\u7565 //\u5c06\u6807\u51c6\u8f93\u5165\u3001\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u90fd\u5b9a\u5411\u5230 /dev/null\u6587\u4ef6 open(\"/dev/null\", O_RDONLY); open(\"/dev/null\", O_RDWR); open(\"/dev/null\", O_RDWR); return true; } chap8\u3001\u9ad8\u6027\u80fd\u670d\u52a1\u5668\u7a0b\u5e8f\u6846\u67b6 \u00b6 \u5c06\u670d\u52a1\u5668\u89e3\u6784\u4e3a\u4e09\u4e2a\u4e3b\u8981\u6a21\u5757\uff1a I/O\u5904\u7406\u5355\u5143\uff1a4\u79cdI/O\u6a21\u578b+2\u79cd\u9ad8\u6548\u4e8b\u4ef6\u5904\u7406\u6a21\u5f0f \u903b\u8f91\u5355\u5143\uff1a2\u79cd\u9ad8\u6548\u5e76\u53d1\u6a21\u5f0f\uff0c \u6709\u9650\u72b6\u6001\u673a \u5b58\u50a8\u5355\u5143\uff1a 8.1\u3001\u670d\u52a1\u5668\u6a21\u578b \u00b6 C/S\u6a21\u578b TCP/IP\u534f\u8bae\u5728\u8bbe\u8ba1\u548c\u5b9e\u73b0\u4e0a\u5e76\u6ca1\u6709\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7684\u6982\u5ff5\uff0c\u5728\u901a\u4fe1\u8fc7\u7a0b\u4e2d\u6240\u6709\u673a\u5668\u90fd\u662f\u5bf9\u7b49\u7684 \u3002 \u7531\u4e8e\u5ba2\u6237\u8fde\u63a5\u8bf7\u6c42\u662f \u968f\u673a\u5230\u8fbe\u7684\u5f02\u6b65\u4e8b\u4ef6 \uff0c\u670d\u52a1\u5668\u9700\u8981\u4f7f\u7528\u67d0\u79cdI/O\u6a21\u578b\u6765\u76d1\u542c\u8fd9\u4e00\u4e8b\u4ef6\uff08 select \u7cfb\u7edf\u8c03\u7528 \uff09 \u56fe8-2 \uff08142/363\uff09 P2P\u6a21\u578b \u7f3a\u70b9\uff1a 1\u3001\u5f53\u7528\u6237\u4e4b\u95f4\u4f20\u8f93\u7684\u8bf7\u6c42\u8fc7\u591a\u65f6\uff0c\u7f51\u7edc\u7684\u8d1f\u8f7d\u5c06\u52a0\u91cd 2\u3001 \u4e3b\u673a\u4e4b\u95f4\u5f88\u96be\u4e92\u76f8\u53d1\u73b0 \uff0c\u9700\u8981\u5e26\u6709\u4e00\u4e2a \u4e13\u95e8\u7684\u53d1\u73b0\u670d\u52a1\u5668 8.2\u3001\u670d\u52a1\u5668\u7f16\u7a0b\u6846\u67b6 \u00b6 I/O\u5904\u7406\u5355\u5143\u662f \u670d\u52a1\u5668\u7ba1\u7406\u5ba2\u6237\u8fde\u63a5\u7684\u6a21\u5757 \u3002 \u4e00\u4e2a\u903b\u8f91\u5355\u5143\u662f \u4e00\u4e2a\u8fdb\u7a0b\u6216\u7ebf\u7a0b \u7f51\u7edc\u5b58\u50a8\u5355\u5143 \u8bf7\u6c42\u961f\u5217\u662f \u5404\u5355\u5143\u4e4b\u95f4\u7684\u901a\u4fe1\u65b9\u5f0f\u7684\u62bd\u8c61 8.3\u3001I/O\u6a21\u578b \u00b6 \u963b\u585e\u4e0e\u975e\u963b\u585e \u963b\u585eI/O\uff1a \u975e\u963b\u585eI/O\u901a\u5e38\u8981\u548c\u5176\u4ed6I/O\u901a\u77e5\u673a\u5236\u4e00\u8d77\u4f7f\u7528\uff0c\u6bd4\u5982I/O\u590d\u7528\u548cSIGIO\u4fe1\u53f7 \u3002 I/O\u590d\u7528\uff1a \u901a\u8fc7I/O\u590d\u7528\u51fd\u6570\u5411\u5185\u6838\u6ce8\u518c\u4e00\u7ec4\u4e8b\u4ef6\uff0c\u5185\u6838\u901a\u8fc7I/O\u590d\u7528\u51fd\u6570\u628a\u5176\u4e2d\u5c31\u7eea\u7684\u4e8b\u4ef6\u901a\u77e5\u7ed9\u5e94\u7528\u7a0b\u5e8f select()\u3001poll()\u3001epoll_wait() \u4fe1\u53f7\u9a71\u52a8I/O\uff1a \u9760 SIGIO \u4fe1\u53f7 \u4ece\u7406\u8bba\u4e0a\u6765\u8bf4\uff0c\u963b\u585eI/O\u3001I/O\u590d\u7528\u548c\u4fe1\u53f7\u9a71\u52a8I/O\u90fd\u662f\u540c\u6b65I/O\u6a21\u578b \u3002 \u5f02\u6b65\u6a21\u578b \uff1a aio.h 8.4\u3001\u4e24\u79cd\u9ad8\u6548\u7684\u4e8b\u4ef6\u5904\u7406\u6a21\u5f0f \u00b6 \u670d\u52a1\u5668\u7a0b\u5e8f\u901a\u5e38\u9700\u8981\u5904\u7406\u4e09\u7c7b\u4e8b\u4ef6\uff1a I/O\u4e8b\u4ef6\u3001\u4fe1\u53f7\u53ca\u5b9a\u65f6\u4e8b\u4ef6 \u3002 8.4.1\u3001Reactor\u6a21\u5f0f\uff08\u540c\u6b65I/O\u6a21\u578b\uff09 \u00b6 Reactor\u6a21\u5f0f \uff1a\u5b83\u8981\u6c42\u4e3b\u7ebf\u7a0b\uff08I/O\u5904\u7406\u5355\u5143\uff09\u53ea\u8d1f\u8d23\u76d1\u542c\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0a\u662f\u5426\u6709\u4e8b\u4ef6\u53d1\u751f\uff0c\u6709\u7684\u8bdd\u5c31\u7acb\u5373\u5c06\u8be5\u4e8b\u4ef6\u901a\u77e5\u5de5\u4f5c\u7ebf\u7a0b\uff08\u903b\u8f91\u5355\u5143\uff09\u3002\u9664\u6b64\u4e4b\u5916\uff0c \u4e3b\u7ebf\u7a0b\u4e0d\u505a\u4efb\u4f55\u5176\u4ed6\u5b9e\u8d28\u6027\u5de5\u4f5c \u3002 \u56fe8-5\uff08147/363\uff09 \u4f7f\u7528\u540c\u6b65I/O\u6a21\u578b\uff08epoll_wait\u4e3a\u4f8b\uff09\u5b9e\u73b0\u7684Reactor\u6a21\u5f0f\u7684\u5de5\u4f5c\u6d41\u7a0b\u662f\uff1a 1\uff09\u4e3b\u7ebf\u7a0b\u5f80epoll\u5185\u6838\u4e8b\u4ef6\u8868\u4e2d\u6ce8\u518csocket\u4e0a\u7684\u8bfb\u5c31\u7eea\u4e8b\u4ef6 2\uff09\u4e3b\u7ebf\u7a0b\u8c03\u7528epoll_wait\u7b49\u5f85socket\u4e0a\u6709\u6570\u636e\u53ef\u8bfb 3\uff09\u5f53socket\u4e0a\u6709\u6570\u636e\u53ef\u8bfb\u65f6\uff0cepoll_wait\u901a\u77e5\u4e3b\u7ebf\u7a0b\u3002\u4e3b\u7ebf\u7a0b\u5219\u5c06socket\u53ef\u8bfb\u4e8b\u4ef6\u653e\u5165\u8bf7\u6c42\u961f\u5217 4\uff09\u7761\u7720\u5728\u8bf7\u6c42\u961f\u5217\u4e0a\u7684\u67d0\u4e2a\u5de5\u4f5c\u7ebf\u7a0b\u88ab\u5524\u9192\uff0c\u5b83\u4ecesocket\u8bfb\u53d6\u6570\u636e\uff0c\u5e76\u5904\u7406\u5ba2\u6237\u8bf7\u6c42\uff0c\u7136\u540e\u5f80epoll\u5185\u6838\u4e8b\u4ef6\u8868\u4e2d\u6ce8\u518c\u8be5socket\u4e0a\u7684\u5199\u5c31\u7eea\u4e8b\u4ef6 5\uff09\u4e3b\u7ebf\u7a0b\u8c03\u7528epoll_wait\u7b49\u5f85socket\u53ef\u5199 6\uff09\u5f53socket\u53ef\u5199\u65f6\uff0cepoll_wait\u901a\u77e5\u4e3b\u7ebf\u7a0b\u3002\u4e3b\u7ebf\u7a0b\u5c06socket\u53ef\u5199\u4e8b\u4ef6\u653e\u5165\u8bf7\u6c42\u961f\u5217\u3002 7\uff09\u7761\u7720\u5728\u8bf7\u6c42\u961f\u5217\u4e0a\u7684\u67d0\u4e2a\u5de5\u4f5c\u7ebf\u7a0b\u88ab\u5524\u9192\uff0c\u5b83\u5f80socket\u4e0a\u5199\u5165\u670d\u52a1\u5668\u5904\u7406\u5ba2\u6237\u8bf7\u6c42\u7684\u7ed3\u679c 8.4.2\u3001Proactor\u6a21\u5f0f \u00b6 Proactor\u6a21\u5f0f \uff1a\u5c06\u6240\u6709I/O\u64cd\u4f5c\u90fd\u4ea4\u7ed9\u4e3b\u7ebf\u7a0b\u548c\u5185\u6838\u6765\u5904\u7406\uff0c\u5de5\u4f5c\u7ebf\u7a0b\u4ec5\u4ec5\u8d1f\u8d23\u4e1a\u52a1\u903b\u8f91\u3002 \u56fe8-6\uff08147/363\uff09 \u4f7f\u7528\u5f02\u6b65I/O\u6a21\u578b\uff08\u4ee5aio_read\u548caio_write\u4e3a\u4f8b\uff09\u5b9e\u73b0\u7684Proactor\u6a21\u5f0f\u7684\u5de5\u4f5c\u6d41\u7a0b\uff1a 1\uff09\u4e3b\u7ebf\u7a0b\u8c03\u7528aio_read\u51fd\u6570\u5411\u5185\u6838\u6ce8\u518csocket\u4e0a\u7684\u8bfb\u5b8c\u6210\u4e8b\u4ef6\uff0c\u5e76\u544a\u8bc9\u5185\u6838\u7528\u6237\u8bfb\u7f13\u51b2\u533a\u7684\u4f4d\u7f6e\uff0c\u4ee5\u53ca\u8bfb\u64cd\u4f5c\u5b8c\u6210\u65f6\u5982\u4f55\u901a\u77e5\u5e94\u7528\u7a0b\u5e8f\uff08\u8fd9\u91cc\u4ee5\u4fe1\u53f7\u4e3a\u4f8b\uff0c\u8be6\u60c5\u53c2\u8003sigevent\u7684man\u624b\u518c\uff09 2\uff09\u4e3b\u7ebf\u7a0b\u7ee7\u7eed\u5904\u7406\u5176\u4ed6\u903b\u8f91 3\uff09\u5f53socket\u4e0a\u7684\u6570\u636e\u88ab\u8bfb\u5165\u7528\u6237\u7f13\u51b2\u533a\u540e\uff0c\u5185\u6838\u5c06\u5411\u5e94\u7528\u7a0b\u5e8f\u53d1\u9001\u4e00\u4e2a\u4fe1\u53f7\uff0c\u4ee5\u901a\u77e5\u5e94\u7528\u7a0b\u5e8f\u6570\u636e\u5df2\u7ecf\u53ef\u7528 4\uff09\u5e94\u7528\u7a0b\u5e8f\u9884\u5148\u5b9a\u4e49\u597d\u7684\u4fe1\u53f7\u5904\u7406\u51fd\u6570\u9009\u62e9\u4e00\u4e2a\u5de5\u4f5c\u7ebf\u7a0b\u6765\u5904\u7406\u5ba2\u6237\u8bf7\u6c42\u3002\u5de5\u4f5c\u7ebf\u7a0b\u5904\u7406\u5b8c\u5ba2\u6237\u8bf7\u6c42\u4e4b\u540e\uff0c\u8c03\u7528aio_write\u51fd\u6570\u5411\u5185\u6838\u6ce8\u518csocket\u4e0a\u7684\u5199\u5b8c\u6210\u4e8b\u4ef6\uff0c\u5e76\u544a\u8bc9\u5185\u6838\u7528\u6237\u5199\u7f13\u51b2\u533a\u7684\u4f4d\u7f6e\uff0c\u4ee5\u53ca\u5199\u64cd\u4f5c\u5b8c\u6210\u65f6\u5982\u4f55\u901a\u77e5\u5e94\u7528\u7a0b\u5e8f\uff08\u4ecd\u7136\u4ee5\u4fe1\u53f7\u4e3a\u4f8b\uff09 5\uff09\u4e3b\u7ebf\u8def\u7ee7\u7eed\u5904\u7406\u5176\u4ed6\u903b\u8f91 6\uff09\u5f53\u7528\u6237\u7f13\u51b2\u533a\u7684\u6570\u636e\u88ab\u5199\u5165socket\u4e4b\u540e\uff0c\u5185\u6838\u5c06\u5411\u5e94\u7528\u7a0b\u5e8f\u53d1\u9001\u4e00\u4e2a\u4fe1\u53f7\uff0c\u4ee5\u901a\u77e5\u5e94\u7528\u7a0b\u5e8f\u6570\u636e\u5df2\u7ecf\u53d1\u9001\u5b8c\u6bd5 7\uff09\u5e94\u7528\u7a0b\u5e8f\u9884\u5148\u5b9a\u4e49\u597d\u7684\u4fe1\u53f7\u5904\u7406\u51fd\u6570\u9009\u62e9\u4e00\u4e2a\u5de5\u4f5c\u7ebf\u7a0b\u6765\u505a\u5584\u540e\u5904\u7406\uff0c\u6bd4\u5982\u51b3\u5b9a\u662f\u5426\u5173\u95edsocket 8.4.3\u3001\u540c\u6b65\u7684\u65b9\u5f0f\u6a21\u62df\u51faProactor\u6a21\u5f0f \u00b6 8.5\u3001\u4e24\u79cd\u9ad8\u6548\u7684\u5e76\u53d1\u6a21\u5f0f \u00b6 8.5.1\u3001\u534a\u540c\u6b65/\u534a\u5f02\u6b65\u6a21\u5f0f \u00b6 8.5.2\u3001\u9886\u5bfc\u8005/\u8ffd\u968f\u8005\u6a21\u5f0f \u00b6 8.6\u3001\u6709\u9650\u72b6\u6001\u673a \u00b6 8.7\u3001\u63d0\u9ad8\u670d\u52a1\u5668\u6027\u80fd\u7684\u5176\u5b83\u5efa\u8bae \u00b6 8.7.1\u3001\u6c60 \u00b6 \u6c60 \uff1a\u662f\u4e00\u7ec4\u8d44\u6e90\u7684\u96c6\u5408\uff0c\u8fd9\u7ec4\u8d44\u6e90\u5728\u670d\u52a1\u5668\u542f\u52a8\u4e4b\u521d\u5c31\u88ab\u5b8c\u5168\u521b\u5efa\u597d\u5e76\u521d\u59cb\u5316\uff0c\u8fd9\u79f0\u4e3a \u9759\u6001\u8d44\u6e90\u5206\u914d \u3002 \u5185\u5b58\u6c60 \u8fdb\u7a0b\u6c60 \u7ebf\u7a0b\u6c60 \u8fde\u63a5\u6c60 8.7.2\u3001\u6570\u636e\u590d\u5236 \u00b6 \u5f53\u4e24\u4e2a\u5de5\u4f5c\u8fdb\u7a0b\u4e4b\u95f4\u8981\u4f20\u9012\u5927\u91cf\u7684\u6570\u636e\u65f6\uff0c\u6211\u4eec\u5c31\u5e94\u8be5\u8003\u8651\u4f7f\u7528\u5171\u4eab\u5185\u5b58\u6765\u5728\u5b83\u4eec\u4e4b\u95f4\u76f4\u63a5\u5171\u4eab\u8fd9\u4e9b\u6570\u636e\uff0c\u800c\u4e0d\u662f\u4f7f\u7528\u7ba1\u9053\u6216\u8005\u6d88\u606f\u961f\u5217\u6765\u4f20\u9012\u3002 8.7.3\u3001\u4e0a\u4e0b\u6587\u5207\u6362\u548c\u9501 \u00b6 chap9\u3001I/O\u590d\u7528 \u00b6 9.1\u3001select\u7cfb\u7edf\u8c03\u7528 \u00b6 select\u7cfb\u7edf\u8c03\u7528\u7684\u7528\u9014\u662f\uff1a \u5728\u4e00\u6bb5\u65f6\u95f4\u5185\uff0c\u76d1\u542c\u7528\u6237\u611f\u5174\u8da3\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0a\u7684\u53ef\u8bfb\u3001\u53ef\u5199\u548c\u5f02\u5e38\u7b49\u4e8b\u4ef6 \u3002 9.1.1\u3001select api \u00b6 #include <sys/select.h> int select(int nfds, fd_set *readfs, fd_set *writefds, fd_set* exceptfds, struct timeval* timeout); 9.1.2\u3001\u6587\u4ef6\u63cf\u8ff0\u7b26\u5c31\u7eea\u6587\u4ef6 \u00b6 \u4e0b\u5217socket\u53ef\u8bfb \u4e0b\u5217socket\u53ef\u5199 \u7f51\u7edc\u7a0b\u5e8f\u4e2d\uff0cselect\u80fd\u5904\u7406\u7684\u5f02\u5e38\u60c5\u51b5\u53ea\u6709\u4e00\u79cd\uff1asocket\u4e0a\u63a5\u6536\u5230\u5e26\u5916\u6570\u636e \u3002 9.1.3\u3001\u5904\u7406\u5e26\u5916\u6570\u636e\uff08out-of band OOB) \u00b6 9.2\u3001poll\u7cfb\u7edf\u8c03\u7528 \u00b6 #include <poll.h> int poll(struct pollfd* fds, nfds_t nfds, int timeout); 9.3\u3001epoll\u7cfb\u5217\u7cfb\u7edf\u8c03\u7528 \u00b6 9.3.1\u3001\u5185\u6838\u4e8b\u4ef6\u8868 \u00b6 epoll\u662fLinux\u7279\u6709\u7684I/O\u590d\u7528\u51fd\u6570\u3002\u5b83\u5728\u5b9e\u73b0\u548c\u4f7f\u7528\u4e0a\u4e0eselect\u548cpoll\u6709\u5f88\u5927\u5dee\u5f02\u3002 epoll\u4f7f\u7528\u4e00\u7ec4\u51fd\u6570\u6765\u5b8c\u6210\u4efb\u52a1\uff0c\u800c\u4e0d\u662f\u5355\u4e2a\u51fd\u6570\u3002 epoll\u628a\u7528\u6237\u5173\u5fc3\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0a\u7684\u4e8b\u4ef6\u653e\u5728\u5185\u6838\u91cc\u7684\u4e00\u4e2a\u4e8b\u4ef6\u8868\u4e2d\uff0c\u4ece\u800c\u65e0\u987b\u50cfselect\u548cpoll\u90a3\u6837\u6bcf\u6b21\u8c03\u7528\u90fd\u8981\u91cd\u590d\u4f20\u5165\u6587\u4ef6\u63cf\u8ff0\u7b26\u96c6\u6216\u4e8b\u4ef6\u96c6\u3002 epoll\u9700\u8981\u4f7f\u7528\u4e00\u4e2a\u989d\u5916\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u6765\u552f\u4e00\u6807\u8bc6\u5185\u6838\u4e2d\u7684\u8fd9\u4e2a\u4e8b\u4ef6\u8868 \u3002 \u8fd9\u4e2a\u989d\u5916\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u7528 epoll_create() \u521b\u5efa #include<sys/epoll.h> int epoll_create(int size); \u64cd\u4f5cepoll\u7684\u5185\u6838\u8868\u7684\u51fd\u6570\u662f epoll_ctl() #include<sys/epoll.h> int epoll_ctl(int epfd, int op, int fd, struct epoll_event *event); 9.3.2\u3001epoll_wait\u51fd\u6570 \u00b6 \u4f5c\u7528\u662f\uff1a \u5728\u4e00\u6bb5\u8d85\u65f6\u65f6\u95f4\u5185\u7b49\u5f85\u4e00\u7ec4\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0a\u7684\u4e8b\u4ef6 \u3002 #include <sys/epoll.h> int epoll_wait(int epfd, struct epoll_event *events, int maxevents, int timeout) 9.3.3\u3001lt\u548cet\u6a21\u5f0f \u00b6 epoll\u5bf9\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u64cd\u4f5c\u6709\u4e24\u79cd\u6a21\u5f0f\uff1a LT\uff08Level Trigger \u7535\u5e73\u89e6\u53d1\uff09\uff1a\u9ed8\u8ba4\u7684\u5de5\u4f5c\u65b9\u5f0f\uff0c\u8fd9\u79cd\u6a21\u5f0f\u4e0b\u76f8\u5f53\u4e8e\u4e00\u4e2a\u6548\u7387\u8f83\u9ad8\u7684poll\u3002 ET\uff08Edge Trigger \u8fb9\u6cbf\u89e6\u53d1\uff09\uff1a\u5f53epoll_wait\u68c0\u6d4b\u5230\u5176\u4e0a\u6709\u4e8b\u4ef6\u53d1\u751f\u5e76\u5c06\u6b64\u4e8b\u4ef6\u901a\u77e5\u5e94\u7528\u7a0b\u5e8f\u540e\uff0c\u5e94\u7528\u7a0b\u5e8f\u5fc5\u987b\u7acb\u5373\u5904\u7406\u8be5\u4e8b\u4ef6\uff0c\u56e0\u4e3a\u540e\u7eed\u7684epoll_wait\u8c03\u7528\u5c06\u4e0d\u518d\u5411\u5e94\u7528\u7a0b\u5e8f\u901a\u77e5\u8fd9\u4e00\u4e8b\u4ef6\u3002 9.3.4\u3001epolloneshot\u4e8b\u4ef6 \u00b6 9.4\u3001\u4e09\u7ec4I/O\u590d\u7528\u51fd\u6570\u7684\u6bd4\u8f83 \u00b6 9.5\u3001I/O\u590d\u7528\u7684\u9ad8\u7ea7\u5e94\u7528\u4e00\uff1a\u975e\u963b\u585econnect \u00b6 9.6\u3001I/O\u590d\u7528\u7684\u9ad8\u7ea7\u5e94\u7528\u4e8c\uff1a\u804a\u5929\u5ba4\u7a0b\u5e8f \u00b6 9.6.1\u3001\u5ba2\u6237\u7aef \u00b6 9.6.2\u3001\u670d\u52a1\u7aef \u00b6 9.7\u3001I/O\u590d\u7528\u7684\u9ad8\u7ea7\u5e94\u7528\u4e09\uff1a\u540c\u65f6\u5904\u7406tcp\u548cudp\u670d\u52a1 \u00b6 9.8\u3001\u8d85\u7ea7\u670d\u52a1xinetd \u00b6 9.8.1\u3001xinetd\u914d\u7f6e\u6587\u4ef6 \u00b6 \u91c7\u7528 /etc/xinetd.conf \u4e3b\u914d\u7f6e\u6587\u4ef6\u548c /etc/xinetd.d \u76ee\u5f55\u4e0b\u7684\u5b50\u914d\u7f6e\u6587\u4ef6 9.8.2\u3001xinetd\u5de5\u4f5c\u6d41\u7a0b \u00b6 \u6709\u65f6\u95f4\u65e5\u671f\u670d\u52a1daytime cat /var/run/xinetd.pid \u56fe9-1\uff08195/363\uff09 chap10\u3001\u4fe1\u53f7 chap11\u3001\u5b9a\u65f6\u5668 chap12\u3001\u9ad8\u6027\u80fdI/O\u6846\u67b6\u5e93Libevent chap13\u3001\u591a\u8fdb\u7a0b\u7f16\u7a0b \u00b6 0 \u00b6 \u590d\u5236\u8fdb\u7a0b\u6620\u50cf\u7684fork\u7cfb\u7edf\u8c03\u7528\u548c\u66ff\u6362\u8fdb\u7a0b\u6620\u50cf\u7684exec\u7cfb\u5217\u7cfb\u7edf\u8c03\u7528 \u50f5\u5c38\u8fdb\u7a0b\u4ee5\u53ca\u5982\u4f55\u907f\u514d\u50f5\u5c38\u8fdb\u7a0b 13.1\u3001fork\u7cfb\u7edf\u8c03\u7528 \u00b6 \u5b50\u8fdb\u7a0b\u7684\u4ee3\u7801\u4e0e\u7236\u8fdb\u7a0b\u5b8c\u5168\u76f8\u540c\uff0c\u540c\u65f6\u5b83\u8fd8\u4f1a\u590d\u5236\u7236\u8fdb\u7a0b\u7684\u6570\u636e\uff08\u5806\u6570\u636e\u3001\u6808\u6570\u636e\u548c\u9759\u6001\u6570\u636e\uff09\u3002 \u6570\u636e\u7684\u590d\u5236\u91c7\u7528\u7684\u662f\u6240\u8c13\u7684\u5199\u65f6\u590d\u5236\uff08copy on write\uff09\uff0c\u5373\u53ea\u6709\u5728\u4efb\u4e00\u8fdb\u7a0b\uff08\u7236\u8fdb\u7a0b\u6216\u5b50\u8fdb\u7a0b\uff09\u5bf9\u6570\u636e\u6267\u884c\u4e86\u5199\u64cd\u4f5c\u65f6\uff0c\u590d\u5236\u624d\u4f1a\u53d1\u751f\uff08\u5148\u662f\u7f3a\u9875\u4e2d\u65ad\uff0c\u7136\u540e\u64cd\u4f5c\u7cfb\u7edf\u7ed9\u5b50\u8fdb\u7a0b\u5206\u914d\u5185\u5b58\u534a\u590d\u5236\u7236\u8fdb\u7a0b\u7684\u6570\u636e\uff09 13.2\u3001exec\u7cfb\u5217\u7cfb\u7edf\u8c03\u7528 \u00b6 13.3\u3001\u5904\u7406\u50f5\u5c38\u8fdb\u7a0b \u00b6 13.4\u3001\u7ba1\u9053 \u00b6 \u7ba1\u9053\u80fd\u5728\u7236\u3001\u5b50\u8fdb\u7a0b\u95f4\u4f20\u9012\u6570\u636e\uff0c\u5229\u7528\u7684\u662ffork\u8c03\u7528\u4e4b\u540e\u4e24\u4e2a\u7ba1\u9053\u6587\u4ef6\u63cf\u8ff0\u7b26\uff08fd[0]\u548cfd[1]\uff09\u90fd\u4fdd\u6301\u6253\u5f00\u3002 13.5\u3001\u4fe1\u53f7\u91cf \u00b6 13.5.1\u3001\u4fe1\u53f7\u91cf\u539f\u8bed P\uff08passeren\uff0c\u4f20\u9012\uff0c\u8fdb\u5165\u4e34\u754c\u533a\uff09\u548cV\uff08vrijgeven\uff0c\u91ca\u653e\uff0c\u9000\u51fa\u4e34\u754c\u533a\uff09 sys/sem.h 13.5.2\u3001semget\u7cfb\u7edf\u8c03\u7528 \u521b\u5efa\u4fe1\u53f7\u91cf\u96c6 13.5.3\u3001semop\u7cfb\u7edf\u8c03\u7528 13.5.4\u3001semctl\u7cfb\u7edf\u8c03\u7528 \u5141\u8bb8\u8c03\u7528\u8005\u5bf9\u4fe1\u53f7\u91cf\u8fdb\u884c\u76f4\u63a5\u63a7\u5236 13.5.5\u3001\u7279\u6b8a\u952e\u503cipc_private 13.6\u3001\u5171\u4eab\u5185\u5b58 \u00b6 0\u3001 \u00b6 sys/shm.h 13.6.1\u3001shmget\u7cfb\u7edf\u8c03\u7528 13.6.2\u3001shmat\u548cshmdt\u7cfb\u7edf\u8c03\u7528 13.6.3\u3001shmctl\u7cfb\u7edf\u8c03\u7528 13.6.4\u3001\u5171\u4eab\u5185\u5b58\u7684posix\u65b9\u6cd5 13.6.5\u3001\u5171\u4eab\u5185\u5b58\u5b9e\u4f8b 13.7\u3001\u6d88\u606f\u961f\u5217 \u00b6 13.7.1\u3001msgget\u7cfb\u7edf\u8c03\u7528 13.7.2\u3001msgsnd\u7cfb\u7edf\u8c03\u7528 13.7.3\u3001msgrcv\u7cfb\u7edf\u8c03\u7528 13.7.4\u3001msgctl\u7cfb\u7edf\u8c03\u7528 13.8\u3001ipc\u547d\u4ee4 \u00b6 ipcs ipcrm \u547d\u4ee4\u6765\u5220\u9664\u9057\u7559\u5728\u7cfb\u7edf\u4e2d\u7684\u5171\u4eab\u8d44\u6e90 13.9\u3001\u5728\u8fdb\u7a0b\u95f4\u4f20\u9012\u6587\u4ef6\u63cf\u8ff0\u7b26 \u00b6 \u4f20\u9012\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u5e76\u4e0d\u662f\u4f20\u9012\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u503c\uff0c\u800c\u662f\u8981\u5728\u63a5\u6536\u8fdb\u7a0b\u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u5e76\u4e14\u8be5\u6587\u4ef6\u63cf\u8ff0\u7b26\u548c\u53d1\u9001\u8fdb\u7a0b\u4e2d\u88ab\u4f20\u9012\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u6307\u5411\u5185\u6838\u4e2d\u76f8\u540c\u7684\u6587\u4ef6\u8868\u9879 \u3002 \u4ee3\u780113-5\uff1a\u5728\u8fdb\u7a0b\u95f4\u4f20\u9012\u6587\u4ef6\u63cf\u8ff0\u7b26 int main() { int pipefd[2]; int fd_to_pass = 0; //\u521b\u5efa\u7236\u3001\u5b50\u8fdb\u7a0b\u95f4\u7684\u7ba1\u9053\uff0c\u6587\u4ef6\u63cf\u8ff0\u7b26pipefd[0]\u548cpipefd[1]\u90fd\u662fUNIX\u57dfsocket int ret = socketpair(PF_UNIX, SOCK_DGRAM, 0, pipefd); assert(ret != -1); pid_t pid = fork(); assert(pid >= 0); if(pid == 0){ close(pipefd[0]); fd_to_pass = open(\"test.txt\",O_RDWR,0666); //\u5b50\u8fdb\u7a0b\u901a\u8fc7\u7ba1\u9053\u5c06\u6587\u4ef6\u63cf\u8ff0\u7b26\u53d1\u9001\u5230\u7236\u8fdb\u7a0b\u3002\u5982\u679c\u6587\u4ef6test.txt\u6253\u5f00\u5931\u8d25\uff0c\u5219\u5b50\u8fdb\u7a0b\u5c06\u6807\u51c6\u8f93\u5165\u6587\u4ef6\u63cf\u8ff0\u7b26\u53d1\u9001\u5230\u7236\u8fdb\u7a0b send_fd(pipefd[1], (fd_to_pass > 0)?fd_to_pass:0); close(fd_to_pass); exit(0); } close(pipefd[1]); fd_to_pass = recv_fd(pipefd[0]); //\u7236\u8fdb\u7a0b\u4ece\u7ba1\u9053\u63a5\u6536\u76ee\u6807\u6587\u4ef6\u63cf\u8ff0\u7b26 char buf[1024]; memset(buf,'\\0',1024); read(fd_to_pass, buf, 1024); //\u8bfb\u76ee\u6807\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u4ee5\u9a8c\u8bc1\u5176\u6709\u6548\u6027 printf(\"I got fd %d and data %s\\n\", fd_to_pass, buf); close(fd_to_pass); } chap14\u3001\u591a\u7ebf\u7a0b\u7f16\u7a0b \u00b6 POSIX\u7ebf\u7a0b\u540c\u6b65\u65b9\u5f0f\uff1a POSIX\u4fe1\u53f7\u91cf\u3001\u4e92\u65a5\u9501\u548c\u6761\u4ef6\u53d8\u91cf 14.1\u3001linux\u7ebf\u7a0b\u6982\u8ff0 \u00b6 14.1.1\u3001\u7ebf\u7a0b\u6a21\u578b \u00b6 \u4e00\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u62e5\u6709M\u4e2a\u5185\u6838\u7ebf\u7a0b\u548cN\u4e2a\u7528\u6237\u7ebf\u7a0b\uff0c\u5176\u4e2dM<=N\u3002 \u5e76\u4e14\u5728\u4e00\u4e2a\u7cfb\u7edf\u7684\u6240\u6709\u8fdb\u7a0b\u4e2d\uff0cM\u548cN\u7684\u6bd4\u503c\u90fd\u662f\u56fa\u5b9a\u7684\u3002 \u6309\u7167M:N\u7684\u53d6\u503c\uff0c\u7ebf\u7a0b\u7684\u5b9e\u73b0\u65b9\u5f0f\u53ef\u5206\u4e3a\u4e09\u79cd\u6a21\u5f0f\uff1a \u5b8c\u5168\u5728\u7528\u6237\u7a7a\u95f4\u5b9e\u73b0 \u5b8c\u5168\u7531\u5185\u6838\u8c03\u5ea6 \u53cc\u5c42\u8c03\u5ea6\uff08two level scheduler\uff09 14.1.2\u3001linux\u7ebf\u7a0b\u5e93 \u00b6 14.2\u3001\u521b\u5efa\u7ebf\u7a0b\u548c\u7ed3\u675f\u7ebf\u7a0b \u00b6 pthread_create pthread_exit pthread_join pthread_cancel #include <pthread.h> int pthread_cancel(pthread_t thread); 14.3\u3001\u7ebf\u7a0b\u5c5e\u6027 \u00b6 14.4\u3001posix\u4fe1\u53f7\u91cf \u00b6 pthread_join \u53ef\u4ee5\u770b\u4f5c\u4e00\u79cd\u7b80\u5355\u7684\u7ebf\u7a0b\u540c\u6b65\u65b9\u5f0f \uff0c\u5b83\u65e0\u6cd5\u9ad8\u6548\u5730\u5b9e\u73b0\u590d\u6742\u7684\u540c\u6b65\u9700\u6c42\uff0c\u6bd4\u5982\u63a7\u5236\u5bf9\u5171\u4eab\u8d44\u6e90\u7684\u72ec\u5360\u5f0f\u8bbf\u95ee\uff0c\u53c8\u6291\u6216\u662f\u5728\u67d0\u4e2a\u6761\u4ef6\u6ee1\u8db3\u4e4b\u540e\u5524\u9192\u4e00\u4e2a\u7ebf\u7a0b\u3002 POSIX\u4fe1\u53f7\u91cf\u51fd\u6570\u7684\u540d\u5b57\u662f\u4ee5 sem_ \u5f00\u5934\uff0c\u5e38\u7528\u7684\u662f\u4e0b\u97625\u4e2a #include <semaphore.h> int sem_init(sem_t *sem, int pshard, unsigned int value); int sem_wait(sem_t *sem); 14.5\u3001\u4e92\u65a5\u9501 \u00b6 14.5.1\u3001\u4e92\u65a5\u9501\u57fa\u7840api \u00b6 14.5.2\u3001\u4e92\u65a5\u9501\u5c5e\u6027 \u00b6 14.5.3\u3001\u6b7b\u9501\u4e3e\u4f8b \u00b6 14.6\u3001\u6761\u4ef6\u53d8\u91cf \u00b6 \u5982\u679c\u8bf4\u4e92\u65a5\u9501\u662f\u7528\u4e8e\u540c\u6b65\u7ebf\u7a0b\u5bf9\u5171\u4eab\u6570\u636e\u7684\u8bbf\u95ee\u7684\u8bdd\uff0c\u90a3\u4e48\u6761\u4ef6\u53d8\u91cf\u5219\u662f \u7528\u4e8e\u5728\u7ebf\u7a0b\u4e4b\u95f4\u540c\u6b65\u5171\u4eab\u6570\u636e\u7684\u503c \u3002 \u6761\u4ef6\u53d8\u91cf\u63d0\u4f9b\u4e86\u4e00\u79cd \u7ebf\u7a0b\u95f4\u7684\u901a\u77e5\u673a\u5236 \uff1a\u5f53\u67d0\u4e2a\u5171\u4eab\u6570\u636e\u8fbe\u5230\u67d0\u4e2a\u503c\u7684\u65f6\u5019\uff0c\u5524\u9192\u7b49\u5f85\u8fd9\u4e2a\u5171\u4eab\u6570\u636e\u7684\u7ebf\u7a0b\u3002 5\u4e2a\u51fd\u6570 14.7\u3001\u7ebf\u7a0b\u540c\u6b65\u673a\u5236\u5305\u88c5\u7c7b \u00b6 14.8\u3001\u591a\u7ebf\u7a0b\u73af\u5883 \u00b6 14.8.1\u3001\u53ef\u91cd\u5165\u51fd\u6570 \u00b6 \u5982\u679c\u4e00\u4e2a\u51fd\u6570\u80fd\u88ab\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u8c03\u7528\u4e14\u4e0d\u53d1\u751f\u7ade\u6001\u6761\u4ef6\uff0c\u5219\u6211\u4eec\u79f0\u5b83\u662f \u7ebf\u7a0b\u5b89\u5168\u7684\uff08thread safe\uff09 \uff0c\u6216\u8005\u8bf4\u5b83\u662f \u53ef\u91cd\u5165\u51fd\u6570 \u3002 14.8.2\u3001\u7ebf\u7a0b\u548c\u8fdb\u7a0b \u00b6 \u5b50\u8fdb\u7a0b\u53ea\u62e5\u6709\u4e00\u4e2a\u6267\u884c\u7ebf\u7a0b 14.8.3\u3001\u7ebf\u7a0b\u548c\u4fe1\u53f7 \u00b6 \u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u53ef\u4ee5\u72ec\u7acb\u5730\u8bbe\u7f6e\u4fe1\u53f7\u63a9\u7801 \u3002 sigprocmask() chap15\u3001\u8fdb\u7a0b\u6c60\u548c\u7ebf\u7a0b\u6c60 Part03\u3001\u9ad8\u6027\u80fd\u670d\u52a1\u5668\u4f18\u5316\u4e0e\u76d1\u6d4b\uff0816-17\uff09 \u00b6","title":"\u300aLinux\u9ad8\u6027\u80fd\u670d\u52a1\u5668\u7f16\u7a0b\u300b"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#part01tcpip1-4","text":"chap1\u3001TCP/IP\u534f\u8bae\u65cf","title":"Part01\u3001TCP/IP\u534f\u8bae\u8be6\u89e3\uff081-4\uff09"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#11tcpip","text":"","title":"1.1\u3001TCP/IP\u534f\u8bae\u65cf\u4f53\u7cfb\u7ed3\u6784\u4ee5\u53ca\u4e3b\u8981\u534f\u8bae"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#0","text":"\u56db\u5c42\uff0c \u4e3b\u8981\u662f socket() \u4e0a\u9762\u7684\u662f\u5e94\u7528\u5c42\uff0c\uff08\u4f20\u8f93\u5c42\u53ca\u4ee5\u4e0b\uff0c\u662f\u5185\u6838\u5c42\uff09 \uff0c \u8fd9\u662f\u4e4b\u524d\u6ca1\u6709\u6ce8\u610f\u5230\u7684,lionel","title":"0"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#111","text":"ARP,RARP","title":"1.1.1\u3001\u6570\u636e\u94fe\u8def\u5c42"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#112","text":"\u6570\u636e\u5305\u7684\u9009\u8def\u548c\u8f6c\u53d1\u3002 IP\u534f\u8bae\u4f7f\u7528\u9010\u8df3\uff08hop by hop\uff09\u7684\u65b9\u5f0f\u786e\u5b9a\u901a\u4fe1\u8def\u5f84 \u4e24\u7c7bIP\u3001ICMP ICMP\u5206\u4e3a\u4e24\u79cd\uff1a\u5dee\u9519\u62a5\u6587\uff1b\u67e5\u8be2\u62a5\u6587","title":"1.1.2\u3001\u7f51\u7edc\u5c42"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#113","text":"\u4e3a\u4e24\u53f0\u4e3b\u673a\u4e0a\u7684\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u7aef\u5230\u7aef\uff08end to end\uff09\u7684\u901a\u4fe1 TCP\u3001UDP\u3001SCTP","title":"1.1.3\u3001\u4f20\u8f93\u5c42"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#114","text":"\u5904\u7406\u5e94\u7528\u7a0b\u5e8f\u7684\u903b\u8f91 telent\u662f\u534f\u8bae\uff0cospf\uff0cdns ping\u53ea\u662f\u547d\u4ee4\uff0c\u4e0d\u662f\u534f\u8bae\uff0c\u7528\u7684\u662fICMP\u534f\u8bae\u3002","title":"1.1.4\u3001\u5e94\u7528\u5c42"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#12","text":"","title":"1.2\u3001\u5c01\u88c5"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#13","text":"","title":"1.3\u3001\u5206\u7528"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#14","text":"","title":"1.4\u3001\u6d4b\u8bd5\u7f51\u7edc"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#15arp","text":"","title":"1.5\u3001arp\u534f\u8bae\u5de5\u4f5c\u539f\u7406"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#151arp","text":"","title":"1.5.1\u3001\u4ee5\u592a\u7f51arp\u8bf7\u6c42/\u5e94\u7b54\u62a5\u6587\u8be6\u89e3"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#152arp","text":"arp -a \u3010arp -d\u5220\u9664\uff0c-s\u6dfb\u52a0\u3011","title":"1.5.2\u3001arp\u9ad8\u901f\u7f13\u5b58\u7684\u67e5\u770b\u548c\u4fee\u6539"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#153tcpdumparp","text":"tcpdump -i eth0 -ent 'dst 192.168.1.109 and src 192.168.1.108' tcpdump\u6293\u53d6\u7684\u6570\u636e\u5305\u672c\u8d28\u4e0a\u662f\u4ee5\u592a\u7f51\u5e27","title":"1.5.3\u3001\u4f7f\u7528tcpdump\u89c2\u5bdfarp\u901a\u4fe1\u8fc7\u7a0b"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#16dns","text":"","title":"1.6\u3001dns\u5de5\u4f5c\u539f\u7406"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#161dns","text":"","title":"1.6.1\u3001dns\u67e5\u8be2\u548c\u5e94\u7b54\u62a5\u6587\u8be6\u89e3"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#162linuxdns","text":"more /etc/resolv.conf host -t A www.baidu.com","title":"1.6.2\u3001linux\u4e0b\u8bbf\u95eedns\u670d\u52a1"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#163tcpdumpdns","text":"tcpdump -i eth0 -nt -s 500 port domain","title":"1.6.3\u3001\u4f7f\u7528tcpdump\u89c2\u5bdfdns\u901a\u4fe1\u8fc7\u7a0b"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#17sockettcpip","text":"\u6570\u636e\u94fe\u8def\u5c42\u3001\u7f51\u7edc\u5c42\u3001\u4f20\u8f93\u5c42\u534f\u8bae\u90fd\u662f\u5728\u5185\u6838\u4e2d\u5b9e\u73b0\u7684 \uff0cOS\u5c31\u9700\u8981\u5b9e\u73b0\u4e00\u7ec4\u7cfb\u7edf\u8c03\u7528\uff0c\u4f7f\u5f97\u5e94\u7528\u7a0b\u5e8f\u80fd\u591f\u8bbf\u95ee\u8fd9\u4e9b\u534f\u8bae\u63d0\u4f9b\u7684\u670d\u52a1\u3002 socket\u7684\u8fd9\u7ec4API\u6709\u4e24\u70b9\u529f\u80fd\uff1a + 1\u3001\u5c06\u5e94\u7528\u7a0b\u5e8f\u6570\u636e\u4ece\u7528\u6237\u7f13\u51b2\u533a\u4e2d\u590d\u5236\u5230TCP/UDP\u5185\u6838\u7f13\u51b2\u533a\uff0c\u4ee5\u4ea4\u4ed8\u5185\u6838\u6765\u53d1\u9001\u6570\u636e\uff08\u6216\u8bfb\u53d6\u6570\u636e\uff09 + 2\u3001\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u901a\u8fc7\u5b83\u4eec\u6765\u4fee\u6539\u5185\u6838\u4e2d\u5404\u5c42\u534f\u8bae\u7684\u67d0\u4e9b\u5934\u90e8\u4fe1\u606f\u6216\u5176\u4ed6\u6570\u636e\u7ed3\u6784\uff0c\u4ece\u800c\u7cbe\u7ec6\u5730\u63a7\u5236\u5e95\u5c42\u901a\u4fe1\u7684\u884c\u4e3a chap2\u3001ip\u534f\u8bae\u8be6\u89e3","title":"1.7\u3001socket\u4e0etcp/ip\u534f\u8bae\u65cf\u7684\u5173\u7cfb"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#0_1","text":"\u4ece2\u65b9\u9762\u63a2\u8ba8\uff1a + IP\u5934\u90e8\u4fe1\u606f + IP\u6570\u636e\u62a5\u7684\u8def\u7531\u548c\u8f6c\u53d1","title":"0\u3001"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#21ip","text":"\u4e3a\u4e0a\u5c42\u534f\u8bae\u63d0\u4f9b \u65e0\u72b6\u6001\u3001\u65e0\u8fde\u63a5\u3001\u4e0d\u53ef\u9760\u7684\u670d\u52a1","title":"2.1\u3001IP\u670d\u52a1\u7684\u7279\u70b9"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#22ipv4","text":"","title":"2.2\u3001IPv4\u5934\u90e8\u7ed3\u6784"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#221ipv4","text":"","title":"2.2.1\u3001IPv4\u5934\u90e8\u7ed3\u6784"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#222tcpdumpipv4","text":"tcpdump -ntx -i lo \u6293\u53d6\u672c\u5730\u56de\u8def\u4e0a\u7684\u6570\u636e\u5305","title":"2.2.2\u3001\u4f7f\u7528tcpdump\u89c2\u5bdfipv4\u5934\u90e8\u7ed3\u6784"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#23ip","text":"\u5f53IP\u6570\u636e\u62a5\u7684\u957f\u5ea6\u8d85\u8fc7\u5e27\u7684MTU\u65f6\uff0c\u5b83\u5c06\u88ab\u5206\u7247\u4f20\u8f93 \uff08\u5206\u7247\u53ef\u80fd\u53d1\u751f\u5728\u53d1\u9001\u7aef\u3001\u53ef\u80fd\u5728\u4e2d\u8f6c\u8def\u7531\u5668\u4e0a\uff0c\u4e5f\u53ef\u80fd\u5728\u4f20\u8f93\u8fc7\u7a0b\u4e2d\uff09 \u4ee5\u592a\u7f51\u5e27\u7684MTU\u662f1500\u5b57\u8282\uff08\u51cf\u53bbIP\u5934\u90e820\u5b57\u8282\uff0c\u6700\u591a1480\u5b57\u8282\uff09 \u3010 ifconfig \u770b\u4e86\u4e0b, lo \u662f65535\u5b57\u8282\uff0c\u5176\u5b83\u662f1500\uff0c netstat -i \u4e5f\u53ef\u4ee5\u770b\u5230\u3011","title":"2.3\u3001IP\u5206\u7247"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#24ip","text":"","title":"2.4\u3001IP\u8def\u7531"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#241ip","text":"","title":"2.4.1\u3001ip\u6a21\u5757\u5de5\u4f5c\u6d41\u7a0b"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#242","text":"route \u6216 netstat \u7684\u547d\u4ee4","title":"2.4.2\u3001\u8def\u7531\u673a\u5236"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#243","text":"","title":"2.4.3\u3001\u8def\u7531\u8868\u66f4\u65b0"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#25ip","text":"\u8981\u627e\u5f00\u4e00\u4e0b /proc/sys/net/ipv4/ip_forward \u5185\u6838\u53c2\u6570\u9ed8\u8ba4\u88ab\u8bbe\u7f6e\u4e3a0","title":"2.5\u3001IP\u8f6c\u53d1"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#26","text":"","title":"2.6\u3001\u91cd\u5b9a\u5411"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#261icmp","text":"/proc/sys/net/ipv4/conf/all/send_redirects \uff0c\u5185\u6838\u53c2\u6570\u6307\u5b9a\u662f\u5426\u5141\u8bb8\u53d1\u9001ICMP\u91cd\u5b9a\u5411\u62a5\u6587 /proc/sys/net/ipv4/conf/all/accept_redirects \uff0c\u63a5\u6536ICMP\u91cd\u5b9a\u5411\u62a5\u6587","title":"2.6.1\u3001icmp\u91cd\u5b9a\u5411\u62a5\u6587"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#262","text":"","title":"2.6.2\u3001\u4e3b\u673a\u91cd\u5b9a\u5411\u5b9e\u4f8b"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#27ipv6","text":"","title":"2.7\u3001IPv6\u5934\u90e8\u7ed3\u6784"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#0_2","text":"RFC 2460","title":"0\u3001"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#271ipv6","text":"40\u5b57\u8282\u5927\u5c0f","title":"2.7.1\u3001ipv6\u56fa\u5b9a\u5934\u90e8\u7ed3\u6784"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#272ipv6","text":"chap3\u3001tcp\u534f\u8bae\u8be6\u89e3","title":"2.7.2\u3001ipv6\u6269\u5c55\u5934\u90e8"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#0_3","text":"\u4ee5\u4e0b4\u4e2a\u65b9\u9762\u8ba8\u8bbaTCP\u534f\u8bae + TCP\u5934\u90e8\u4fe1\u606f\uff08\u7ba1\u7406TCP\u8fde\u63a5\uff0c\u63a7\u5236\u4e24\u4e2a\u65b9\u5411\u7684\u6570\u636e\u6d41\uff09 + TCP\u72b6\u6001\u8f6c\u79fb\u8fc7\u7a0b\uff08TCP\u8fde\u63a5\u7684\u4efb\u610f\u4e00\u7aef\u90fd\u662f\u4e00\u4e2a\u72b6\u6001\u673a\uff09 + TCP\u6570\u636e\u6d41\uff08\u4ea4\u4e92\u6570\u636e\u6d41\u3001\u6210\u5757\u6570\u636e\u6d41\uff09 + TCP\u6570\u636e\u6d41\u7684\u63a7\u5236\uff08\u8d85\u65f6\u91cd\u4f20\u3001\u62e5\u585e\u63a7\u5236\uff09","title":"0"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#31tcp","text":"TCP\u8fde\u63a5\u662f\u5168\u53cc\u5de5\u7684\uff0c \u5373\u53cc\u65b9\u7684\u6570\u636e\u8bfb\u5199\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u8fde\u63a5\u8fdb\u884c \u3002 TCP\u534f\u8bae\u662f\u4e00\u5bf9\u4e00\u7684\uff0c\u6240\u4ee5\u5e7f\u64ad\u548c\u591a\u64ad\u4e0d\u80fd\u4f7f\u7528TCP\u670d\u52a1 \u53d1\u9001\u7aef\u6267\u884c\u7684\u5199\u64cd\u4f5c\u6b21\u6570\u548c\u63a5\u6536\u7aef\u6267\u884c\u7684\u8bfb\u64cd\u4f5c\u6b21\u6570\u4e4b\u95f4\u6ca1\u6709\u4efb\u4f55\u6570\u91cf\u5173\u7cfb\uff0c \u8fd9\u5c31\u662f\u5b57\u8282\u6d41\u7684\u6982\u5ff5","title":"3.1\u3001tcp\u670d\u52a1\u7684\u7279\u70b9"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#32tcp","text":"","title":"3.2\u3001tcp\u5934\u90e8\u7ed3\u6784"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#321tcp","text":"","title":"3.2.1\u3001tcp\u56fa\u5b9a\u5934\u90e8\u7ed3\u6784"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#322tcp","text":"\u5934\u90e8\u9009\u9879\u6700\u591a40\u4e2a\u5b57\u8282\uff08\u5934\u90e8\u6700\u957f60\u5b57\u8282\uff0c\u51cf\u53bb 20\u5b57\u8282\u7684\u56fa\u5b9a\u90e8\u5206\uff09 7\u4e2a\u9009\u9879\uff0ckind\u7684\u53d6\u503c + 0 + 1 + 2 + 3 + 4 + 5 + 8","title":"3.2.2\u3001tcp\u5934\u90e8\u9009\u9879"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#323tcpdumptcp","text":"","title":"3.2.3\u3001\u4f7f\u7528tcpdump\u89c2\u5bdftcp\u5934\u90e8\u4fe1\u606f"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#33tcp","text":"","title":"3.3\u3001tcp\u8fde\u63a5\u7684\u5efa\u7acb\u548c\u5173\u95ed"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#331tcpdumptcp","text":"","title":"3.3.1\u3001\u4f7f\u7528tcpdump\u89c2\u5bdftcp\u8fde\u63a5\u7684\u5efa\u7acb\u548c\u5173\u95ed"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#332","text":"","title":"3.3.2\u3001\u534a\u5173\u95ed\u72b6\u6001"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#333","text":"/proc/sys/net/ipv4/tcp_syn_retries \u4e2d\u5b9a\u4e49\u4e86\u91cd\u8fde\u6b21\u6570","title":"3.3.3\u3001\u8fde\u63a5\u8d85\u65f6"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#34tcp","text":"","title":"3.4\u3001tcp\u72b6\u6001\u8f6c\u79fb"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#341tcp","text":"","title":"3.4.1\u3001tcp\u72b6\u6001\u8f6c\u79fb\u603b\u56fe"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#342time_wait","text":"","title":"3.4.2\u3001time_wait\u72b6\u6001"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#35","text":"","title":"3.5\u3001\u590d\u4f4d\u62a5\u6587\u6bb5"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#351","text":"","title":"3.5.1\u3001\u8bbf\u95ee\u4e0d\u5b58\u5728\u7684\u7aef\u53e3"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#352","text":"socket \u9009\u9879\u4e2d\u7684 SO_LINGER \u6765\u53d1\u9001\u590d\u4f4d\u62a5\u6587\u6bb5\uff0c\u4ee5\u5f02\u5e38\u7ec8\u6b62\u8fde\u63a5","title":"3.5.2\u3001\u5f02\u5e38\u7ec8\u6b62\u8fde\u63a5"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#353","text":"","title":"3.5.3\u3001\u5904\u7406\u534a\u6253\u5f00\u8fde\u63a5"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#36tcp","text":"\u4ec5\u5305\u542b\u5f88\u5c11\u7684\u5b57\u8282 \uff0c\u5bf9\u5b9e\u65f6\u6027\u8981\u6c42\u9ad8","title":"3.6\u3001tcp\u4ea4\u4e92\u6570\u636e\u6d41"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#37tcp","text":"tcpdump -nt -i eth0 port 20 #vsftpd\u670d\u52a1\u5668\u7a0b\u5e8f\u4f7f\u7528\u7aef\u53e3\u53f720","title":"3.7\u3001tcp\u6210\u5757\u6570\u636e\u6d41"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#38tcp","text":"\u7528\u4e8e\u8fc5\u901f\u901a\u544a\u5bf9\u65b9\u672c\u7aef\u53d1\u751f\u7684\u91cd\u8981\u4e8b\u4ef6 \uff0c\u6bd4\u666e\u901a\u6570\u636e\uff08\u4e5f\u53eb\u5e26\u5185\u6570\u636e\uff09\u6709\u66f4\u9ad8\u7684\u4f18\u5148\u7ea7 \u5229\u7528\u7684\u662fTCP\u5934\u90e8\u4e2d\u7684\u7d27\u6025\u6307\u9488\u6807\u5fd7\u548c\u7d27\u6025\u6307\u9488\u4e24\u4e2a\u5b57\u6bb5","title":"3.8\u3001tcp\u5e26\u5916\u6570\u636e"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#39tcp","text":"iperf\u662f\u4e00\u4e2a\u6d4b\u91cf\u7f51\u7edc\u72b6\u51b5\u7684\u5de5\u5177","title":"3.9\u3001tcp\u8d85\u65f6\u91cd\u4f20"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#310","text":"","title":"3.10\u3001\u62e5\u585e\u63a7\u5236"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#3101","text":"rfc5681","title":"3.10.1\u3001\u62e5\u585e\u63a7\u5236\u6982\u8ff0"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#3102","text":"","title":"3.10.2\u3001\u6162\u542f\u52a8\u548c\u62e5\u585e\u907f\u514d"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#3103","text":"chap4\u3001tcp/ip\u901a\u4fe1\u6848\u4f8b\uff1a\u8bbf\u95eeinternet\u4e0a\u7684Web\u670d\u52a1\u5668","title":"3.10.3\u3001\u5feb\u901f\u91cd\u4f20\u548c\u5feb\u901f\u6062\u590d"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#41","text":"","title":"4.1\u3001\u5b9e\u4f8b\u603b\u56fe"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#42","text":"","title":"4.2\u3001\u90e8\u7f72\u4ee3\u7406\u670d\u52a1\u5668"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#421http","text":"","title":"4.2.1\u3001http\u4ee3\u7406\u670d\u52a1\u5668\u7684\u5de5\u4f5c\u539f\u7406"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#422squid","text":"","title":"4.2.2\u3001\u90e8\u7f72squid\u4ee3\u7406\u670d\u52a1\u5668"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#43tcpdup","text":"","title":"4.3\u3001\u4f7f\u7528tcpdup\u6293\u53d6\u4f20\u8f93\u6570\u636e\u5305"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#44dns","text":"","title":"4.4\u3001\u8bbf\u95eedns\u670d\u52a1\u5668"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#45","text":"","title":"4.5\u3001\u672c\u5730\u540d\u79f0\u67e5\u8be2"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#46http","text":"","title":"4.6\u3001HTTP\u901a\u4fe1"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#461http","text":"","title":"4.6.1\u3001http\u8bf7\u6c42"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#462http","text":"","title":"4.6.2\u3001http\u5e94\u7b54"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#47","text":"","title":"4.7\u3001\u5b9e\u4f8b\u603b\u7ed3"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#part024-15","text":"\u7f51\u7edc\u7f16\u7a0bAPI\uff085-7\uff09 \u9ad8\u6027\u80fd\u7a0b\u5e8f\u7684\u4e00\u822c\u6846\u67b6\uff088\uff09 \u670d\u52a1\u5668\u7a0b\u5e8f\u7684IO\u5355\u5143\uff089-12\uff09\uff1aIO\u4e8b\u4ef6\u3001\u4fe1\u53f7\u3001\u5b9a\u65f6\u3001libevent \u670d\u52a1\u5668\u7a0b\u5e8f\u7684\u903b\u8f91\u5355\u5143\uff0813-15\uff09\uff1a\u591a\u8fdb\u7a0b\u3001\u591a\u7ebf\u7a0b","title":"Part02\u3001\u6df1\u5165\u89e3\u6790\u9ad8\u6027\u80fd\u670d\u52a1\u5668\u7f16\u7a0b\uff084-15\uff09"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#chap5linuxapi","text":"","title":"chap5\u3001Linux\u7f51\u7edc\u7f16\u7a0b\u57fa\u7840API"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#0_4","text":"3\u4e2a\u65b9\u9762\u8ba8\u8bbaLinux\u7f51\u7edcAPI socket\u5730\u5740API socket\u57fa\u7840API \u7f51\u7edc\u4fe1\u606fAPI","title":"0\u3001"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#51socketapi","text":"","title":"5.1\u3001socket\u5730\u5740api"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#511","text":"5-1\uff1a\u5224\u65ad\u673a\u5668\u5b57\u8282\u5e8f #include <stdio.h> void byteorder() { union{ short value; char union_bytes[sizeof(short)]; } test; test.value = 0x0102; if((test.union_bytes[0] == 1) && (test.union_bytes[1] == 2)){ printf(\"big endian\\n\"); } else if((test.union_bytes[0] == 2) && (test.union_bytes[1] == 1)){ printf(\"little endian\\n\"); }else{ printf(\"unknown...\\n\"); } }","title":"5.1.1\u3001"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#512","text":"","title":"5.1.2\u3001\u901a\u7528"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#513","text":"","title":"5.1.3\u3001\u4e13\u7528"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#514ip","text":"","title":"5.1.4\u3001IP\u5730\u5740\u8f6c\u6362\u51fd\u6570"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#58","text":"","title":"5.8\u3001\u6570\u636e\u8bfb\u5199"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#581tcp","text":"5-6\uff1a\u53d1\u9001\u5e26\u5916\u6570\u636e #include<sys/socket.h> #include<netinet/in.h> #include<arpa/inet.h> #include<asser.h> #include<stdio.h> #include<unistd.h> #include<string.h> #include<stdlib.h> int main(int argc, char *argv[]){ if(argc <= 2){ printf(\"usage: %s ip_address port_number\\n\", basename(argv[0])); return 1; } const char* ip = argv[1]; int port = atoi(argv[2]); struct sockaddr_in server_address; bzero(&server_address, sizeof(server_address)); server_address.sin_family = AF_INET; inet_pton(AF_INET, ip, &server_address.sin_addr); } 5-7\uff1a\u63a5\u6536\u5e26\u5916\u6570\u636e","title":"5.8.1\u3001tcp\u6570\u636e\u8bfb\u5199"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#582udp","text":"","title":"5.8.2\u3001udp\u6570\u636e\u8bfb\u5199"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#583","text":"","title":"5.8.3\u3001\u901a\u7528\u6570\u636e\u8bfb\u5199\u51fd\u6570"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#59","text":"Linux\u5185\u6838\u68c0\u6d4b\u5230TCP\u7d27\u6025\u6807\u5fd7\u65f6\uff0c\u5c06\u901a\u77e5\u5e94\u7528\u7a0b\u5e8f\u6709\u5e26\u5916\u6570\u636e\u9700\u8981\u63a5\u6536\u3002 \u5185\u6838\u901a\u77e5\u5e94\u7528\u7a0b\u5e8f\u5e26\u5916\u6570\u636e\u5230\u8fbe\u7684\u4e24\u79cd\u5e38\u89c1\u65b9\u5f0f\u662f\uff1a I/O\u590d\u7528\u4ea7\u751f\u7684\u5f02\u5e38\u4e8b\u4ef6 SIGURG\u4fe1\u53f7","title":"5.9\u3001\u5e26\u5916\u6807\u8bb0"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#511socket","text":"","title":"5.11\u3001socket\u9009\u9879"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#512api","text":"","title":"5.12\u3001\u7f51\u7edc\u4fe1\u606fapi"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#5123getaddrinfo","text":"","title":"5.12.3\u3001getaddrinfo"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#chap6io","text":"","title":"chap6\u3001\u9ad8\u7ea7I/O\u51fd\u6570"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#61pipe","text":"","title":"6.1\u3001pipe\u51fd\u6570"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#62dupdup2","text":"","title":"6.2\u3001dup\u51fd\u6570\u548cdup2\u51fd\u6570"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#63readvwritev","text":"readv\u51fd\u6570\u5c06\u6570\u636e\u4ece\u6587\u4ef6\u63cf\u8ff0\u7b26\u8bfb\u5230\u5206\u6563\u7684\u5185\u5b58\u5757\u4e2d\uff0c\u5373 \u5206\u6563\u8bfb writev\u51fd\u6570\uff0c \u96c6\u4e2d\u5199","title":"6.3\u3001readv\u51fd\u6570\u548cwritev\u51fd\u6570"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#64sendfile","text":"\u5728\u4e24\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e4b\u95f4\u76f4\u63a5\u4f20\u9012\u6570\u636e\uff08\u5b8c\u5168\u5728\u5185\u6838\u4e2d\u64cd\u4f5c\uff09 \uff0c\u4ece\u800c\u907f\u514d\u4e86\u5185\u6838\u7f13\u51b2\u533a\u548c\u7528\u6237\u7f13\u51b2\u533a\u4e4b\u95f4\u7684\u6570\u636e\u62f7\u8d1d\uff0c\u6548\u7387\u5f88\u9ad8\uff0c\u79f0\u4e3a \u96f6\u62f7\u8d1d \u3002 #include <sys/sendfile.h> ssize_t sendfile(int out_fd, int in_fd, off_t *offset, size_t count);","title":"6.4\u3001sendfile\u51fd\u6570"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#65mmapmunmap","text":"mmap\u51fd\u6570\u7528\u4e8e\u7533\u8bf7\u4e00\u6bb5\u5185\u5b58\u7a7a\u95f4 \u3002\u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u6bb5\u5185\u5b58\u4f5c\u4e3a\u8fdb\u7a0b\u95f4\u901a\u4fe1\u7684\u5171\u4eab\u5185\u5b58\uff0c\u4e5f\u53ef\u4ee5\u5c06\u6587\u4ef6\u76f4\u63a5\u6620\u5c04\u5230\u5176\u4e2d\u3002","title":"6.5\u3001mmap\u51fd\u6570\u548cmunmap\u51fd\u6570"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#66splice","text":"splice\u51fd\u6570\u7528\u4e8e\u5728\u4e24\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e4b\u95f4\u79fb\u52a8\u6570\u636e\uff0c\u4e5f\u662f\u96f6\u62f7\u8d1d\u64cd\u4f5c #include<fcntl.h> ssize_t splice(int fd_in, loff_t *off_in, int fd_out, loff_t* off_out, size_t len, unsigned int flags);","title":"6.6\u3001splice\u51fd\u6570"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#67tee","text":"tee\u51fd\u6570\u5728\u4e24\u4e2a\u7ba1\u9053\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e4b\u95f4\u590d\u5236\u6570\u636e\uff0c\u4e5f\u662f\u96f6\u62f7\u8d1d\u64cd\u4f5c \u3002\u5b83\u4e0d\u6d88\u8017\u6570\u636e\uff0c\u56e0\u6b64\u6e90\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0a\u7684\u6570\u636e\u4ecd\u7136\u53ef\u4ee5\u7528\u4e8e\u540e\u7eed\u7684\u8bfb\u64cd\u4f5c\u3002","title":"6.7\u3001tee\u51fd\u6570"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#68fcntl","text":"#include <fcntl.h> int fcntl(int fd, int cmd, ...);","title":"6.8\u3001fcntl\u51fd\u6570"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#chap7linux","text":"","title":"chap7\u3001Linux\u670d\u52a1\u5668\u7a0b\u5e8f\u89c4\u8303"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#71","text":"","title":"7.1\u3001\u65e5\u5fd7"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#711linux","text":"rsyslogd\u5b88\u62a4\u8fdb\u7a0b\u65e2\u80fd\u63a5\u6536\u7528\u6237\u8fdb\u7a0b\u8f93\u51fa\u7684\u65e5\u5fd7\uff0c\u53c8\u80fd\u63a5\u6536\u5185\u6838\u65e5\u5fd7\u3002 \u7ec8\u7aef\u8f93\u51fa\u5185\u6838\u4fe1\u606f dmesg \u5185\u6838 printk() ->\u5185\u6838\u73af\u72b6\u7f13\u5b58 -> /proc/kmsg \u7528\u6237\u8fc7\u7a0b syslog() -> /dev/log -> syslogd ->\u914d\u7f6e\u6587\u4ef6 /var/log/* 7.1.2\u3001syslog\u65e5\u5fd7 syslog() \u51fd\u6570\u4e0ersyslogd\u5b88\u62a4\u8fdb\u7a0b\u901a\u4fe1 openlog() \u51fd\u6570\u6539\u53d8syslog\u7684\u9ed8\u8ba4\u8f93\u51fa\u65b9\u5f0f\uff0c\u8fdb\u4e00\u6b65\u7ed3\u6784\u5316\u65e5\u5fd7\u5185\u5bb9","title":"7.1.1\u3001linux\u7cfb\u7edf\u65e5\u5fd7"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#72","text":"","title":"7.2\u3001\u7528\u6237\u4fe1\u606f"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#721uideuidgidegid","text":"","title":"7.2.1\u3001UID\u3001EUID\u3001GID\u548cEGID"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#722","text":"\u4ee3\u78017-2\uff1a\u5207\u6362\u7528\u6237 static bool switch_to_user(uid_t user_id, gid_t gp_id){ //\u5148\u786e\u4fdd\u76ee\u6807\u7528\u6237\u4e0d\u662froot if((user_id == 0) && (gp_id == 0)) { return false; } //\u786e\u4fdd\u5f53\u524d\u7528\u6237\u662f\u5408\u6cd5\u7528\u6237\uff1aroot\u6216\u8005\u76ee\u6807\u7528\u6237 gid_t gid = getgid(); uid_t uid = getuid(); if(((gid != 0) || (uid != 0)) && ((gid != gp_id) || (uid != user_id))){ return false; } //\u5982\u679c\u4e0d\u662froot\uff0c\u5219\u5df2\u7ecf\u662f\u76ee\u6807\u7528\u6237 if(uid != 0){ return true; } //\u5207\u6362\u5230\u76ee\u6807\u7528\u6237 if((setgid(gp_id) < 0) || (setuid(user_id) < 0)){ return false; } }","title":"7.2.2\u3001\u5207\u6362\u7528\u6237"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#73","text":"","title":"7.3\u3001\u8fdb\u7a0b\u95f4\u5173\u7cfb"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#731","text":"","title":"7.3.1\u3001\u8fdb\u7a0b\u7ec4"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#732","text":"","title":"7.3.2\u3001\u4f1a\u8bdd"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#733ps","text":"ps -o pid,ppid,pgid,sid,comm | less + bash\uff08fork\u51fa\u67652\u4e2a\uff0cps\u548cless \u547d\u4ee4\uff09 7.4\u3001\u7cfb\u7edf\u8d44\u6e90\u9650\u5236 #include<sys/resource.h> int getrlimit(int resource, struct rlimit *rlim); int setrlimit(int resource, const struct rlimit *rlim); struct rlimit{ rlim_t rlim_cur; //\u6307\u5b9a\u8d44\u6e90\u7684\u8f6f\u9650\u5236 rlim_t rlim_max; //\u6307\u5b9a\u8d44\u6e90\u7684\u786c\u9650\u5236 } 7.5\u3001\u6539\u53d8\u5de5\u4f5c\u76ee\u5f55\u548c\u6839\u76ee\u5f55 chdir() #include <unistd.h> char* getcwd(char *buf, size_t size); int chdir(const char* path);","title":"7.3.3\u3001\u7528ps\u547d\u4ee4\u67e5\u770b\u8fdb\u7a0b\u5173\u7cfb"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#76","text":"daemon \u4ee3\u7801\u6e05\u53557-3\uff1a\u5c06\u670d\u52a1\u5668\u7a0b\u5e8f\u4ee5\u5b88\u62a4\u8fdb\u7a0b\u7684\u65b9\u5f0f\u8fd0\u884c bool daemonize() { //\u521b\u5efa\u5b50\u8fdb\u7a0b\uff0c\u5173\u95ed\u7236\u8fdb\u7a0b\uff0c\u8fd9\u6837\u53ef\u4ee5\u4f7f\u7a0b\u5e8f\u5728\u540e\u53f0\u8fd0\u884c pid_t pid = fork(); if(pid < 0) { return false;} else if(pid > 0) {exit(0);} //\u8bbe\u7f6e\u6587\u4ef6\u6743\u9650\u63a9\u7801\u3002\u5f53\u8fdb\u7a0b\u521b\u5efa\u6587\u4ef6\uff08\u4f7f\u7528open()\uff09\u65f6\uff0c\u6587\u4ef6\u7684\u6743\u9650\u5c06\u662fmode&07777 umask(0); //\u521b\u5efa\u65b0\u7684\u4f1a\u8bdd\uff0c\u8bbe\u7f6e\u672c\u8fdb\u7a0b\u4e3a\u8fdb\u7a0b\u7ec4\u7684\u9996\u9886 pid_t sid = setsid(); if(sid < 0) {return false;} //\u5207\u6362\u5de5\u4f5c\u76ee\u5f55 if((chdir(\"/\")) < 0) {return false;} //\u5173\u95ed\u6807\u51c6\u8f93\u5165\u8bbe\u5907\u3001\u8f93\u51fa\u8bbe\u5907\u3001\u9519\u8bef\u8f93\u51fa\u8bbe\u5907 close(STDIN_FILENO);close(STDOUT_FILENO);close(STDERR_FILENO); //\u5173\u95ed\u5176\u5b83\u5df2\u7ecf\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u4ee3\u7801\u7701\u7565 //\u5c06\u6807\u51c6\u8f93\u5165\u3001\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u90fd\u5b9a\u5411\u5230 /dev/null\u6587\u4ef6 open(\"/dev/null\", O_RDONLY); open(\"/dev/null\", O_RDWR); open(\"/dev/null\", O_RDWR); return true; }","title":"7.6\u3001\u670d\u52a1\u5668\u7a0b\u5e8f\u540e\u53f0\u5316"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#chap8","text":"\u5c06\u670d\u52a1\u5668\u89e3\u6784\u4e3a\u4e09\u4e2a\u4e3b\u8981\u6a21\u5757\uff1a I/O\u5904\u7406\u5355\u5143\uff1a4\u79cdI/O\u6a21\u578b+2\u79cd\u9ad8\u6548\u4e8b\u4ef6\u5904\u7406\u6a21\u5f0f \u903b\u8f91\u5355\u5143\uff1a2\u79cd\u9ad8\u6548\u5e76\u53d1\u6a21\u5f0f\uff0c \u6709\u9650\u72b6\u6001\u673a \u5b58\u50a8\u5355\u5143\uff1a","title":"chap8\u3001\u9ad8\u6027\u80fd\u670d\u52a1\u5668\u7a0b\u5e8f\u6846\u67b6"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#81","text":"C/S\u6a21\u578b TCP/IP\u534f\u8bae\u5728\u8bbe\u8ba1\u548c\u5b9e\u73b0\u4e0a\u5e76\u6ca1\u6709\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7684\u6982\u5ff5\uff0c\u5728\u901a\u4fe1\u8fc7\u7a0b\u4e2d\u6240\u6709\u673a\u5668\u90fd\u662f\u5bf9\u7b49\u7684 \u3002 \u7531\u4e8e\u5ba2\u6237\u8fde\u63a5\u8bf7\u6c42\u662f \u968f\u673a\u5230\u8fbe\u7684\u5f02\u6b65\u4e8b\u4ef6 \uff0c\u670d\u52a1\u5668\u9700\u8981\u4f7f\u7528\u67d0\u79cdI/O\u6a21\u578b\u6765\u76d1\u542c\u8fd9\u4e00\u4e8b\u4ef6\uff08 select \u7cfb\u7edf\u8c03\u7528 \uff09 \u56fe8-2 \uff08142/363\uff09 P2P\u6a21\u578b \u7f3a\u70b9\uff1a 1\u3001\u5f53\u7528\u6237\u4e4b\u95f4\u4f20\u8f93\u7684\u8bf7\u6c42\u8fc7\u591a\u65f6\uff0c\u7f51\u7edc\u7684\u8d1f\u8f7d\u5c06\u52a0\u91cd 2\u3001 \u4e3b\u673a\u4e4b\u95f4\u5f88\u96be\u4e92\u76f8\u53d1\u73b0 \uff0c\u9700\u8981\u5e26\u6709\u4e00\u4e2a \u4e13\u95e8\u7684\u53d1\u73b0\u670d\u52a1\u5668","title":"8.1\u3001\u670d\u52a1\u5668\u6a21\u578b"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#82","text":"I/O\u5904\u7406\u5355\u5143\u662f \u670d\u52a1\u5668\u7ba1\u7406\u5ba2\u6237\u8fde\u63a5\u7684\u6a21\u5757 \u3002 \u4e00\u4e2a\u903b\u8f91\u5355\u5143\u662f \u4e00\u4e2a\u8fdb\u7a0b\u6216\u7ebf\u7a0b \u7f51\u7edc\u5b58\u50a8\u5355\u5143 \u8bf7\u6c42\u961f\u5217\u662f \u5404\u5355\u5143\u4e4b\u95f4\u7684\u901a\u4fe1\u65b9\u5f0f\u7684\u62bd\u8c61","title":"8.2\u3001\u670d\u52a1\u5668\u7f16\u7a0b\u6846\u67b6"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#83io","text":"\u963b\u585e\u4e0e\u975e\u963b\u585e \u963b\u585eI/O\uff1a \u975e\u963b\u585eI/O\u901a\u5e38\u8981\u548c\u5176\u4ed6I/O\u901a\u77e5\u673a\u5236\u4e00\u8d77\u4f7f\u7528\uff0c\u6bd4\u5982I/O\u590d\u7528\u548cSIGIO\u4fe1\u53f7 \u3002 I/O\u590d\u7528\uff1a \u901a\u8fc7I/O\u590d\u7528\u51fd\u6570\u5411\u5185\u6838\u6ce8\u518c\u4e00\u7ec4\u4e8b\u4ef6\uff0c\u5185\u6838\u901a\u8fc7I/O\u590d\u7528\u51fd\u6570\u628a\u5176\u4e2d\u5c31\u7eea\u7684\u4e8b\u4ef6\u901a\u77e5\u7ed9\u5e94\u7528\u7a0b\u5e8f select()\u3001poll()\u3001epoll_wait() \u4fe1\u53f7\u9a71\u52a8I/O\uff1a \u9760 SIGIO \u4fe1\u53f7 \u4ece\u7406\u8bba\u4e0a\u6765\u8bf4\uff0c\u963b\u585eI/O\u3001I/O\u590d\u7528\u548c\u4fe1\u53f7\u9a71\u52a8I/O\u90fd\u662f\u540c\u6b65I/O\u6a21\u578b \u3002 \u5f02\u6b65\u6a21\u578b \uff1a aio.h","title":"8.3\u3001I/O\u6a21\u578b"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#84","text":"\u670d\u52a1\u5668\u7a0b\u5e8f\u901a\u5e38\u9700\u8981\u5904\u7406\u4e09\u7c7b\u4e8b\u4ef6\uff1a I/O\u4e8b\u4ef6\u3001\u4fe1\u53f7\u53ca\u5b9a\u65f6\u4e8b\u4ef6 \u3002","title":"8.4\u3001\u4e24\u79cd\u9ad8\u6548\u7684\u4e8b\u4ef6\u5904\u7406\u6a21\u5f0f"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#841reactorio","text":"Reactor\u6a21\u5f0f \uff1a\u5b83\u8981\u6c42\u4e3b\u7ebf\u7a0b\uff08I/O\u5904\u7406\u5355\u5143\uff09\u53ea\u8d1f\u8d23\u76d1\u542c\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0a\u662f\u5426\u6709\u4e8b\u4ef6\u53d1\u751f\uff0c\u6709\u7684\u8bdd\u5c31\u7acb\u5373\u5c06\u8be5\u4e8b\u4ef6\u901a\u77e5\u5de5\u4f5c\u7ebf\u7a0b\uff08\u903b\u8f91\u5355\u5143\uff09\u3002\u9664\u6b64\u4e4b\u5916\uff0c \u4e3b\u7ebf\u7a0b\u4e0d\u505a\u4efb\u4f55\u5176\u4ed6\u5b9e\u8d28\u6027\u5de5\u4f5c \u3002 \u56fe8-5\uff08147/363\uff09 \u4f7f\u7528\u540c\u6b65I/O\u6a21\u578b\uff08epoll_wait\u4e3a\u4f8b\uff09\u5b9e\u73b0\u7684Reactor\u6a21\u5f0f\u7684\u5de5\u4f5c\u6d41\u7a0b\u662f\uff1a 1\uff09\u4e3b\u7ebf\u7a0b\u5f80epoll\u5185\u6838\u4e8b\u4ef6\u8868\u4e2d\u6ce8\u518csocket\u4e0a\u7684\u8bfb\u5c31\u7eea\u4e8b\u4ef6 2\uff09\u4e3b\u7ebf\u7a0b\u8c03\u7528epoll_wait\u7b49\u5f85socket\u4e0a\u6709\u6570\u636e\u53ef\u8bfb 3\uff09\u5f53socket\u4e0a\u6709\u6570\u636e\u53ef\u8bfb\u65f6\uff0cepoll_wait\u901a\u77e5\u4e3b\u7ebf\u7a0b\u3002\u4e3b\u7ebf\u7a0b\u5219\u5c06socket\u53ef\u8bfb\u4e8b\u4ef6\u653e\u5165\u8bf7\u6c42\u961f\u5217 4\uff09\u7761\u7720\u5728\u8bf7\u6c42\u961f\u5217\u4e0a\u7684\u67d0\u4e2a\u5de5\u4f5c\u7ebf\u7a0b\u88ab\u5524\u9192\uff0c\u5b83\u4ecesocket\u8bfb\u53d6\u6570\u636e\uff0c\u5e76\u5904\u7406\u5ba2\u6237\u8bf7\u6c42\uff0c\u7136\u540e\u5f80epoll\u5185\u6838\u4e8b\u4ef6\u8868\u4e2d\u6ce8\u518c\u8be5socket\u4e0a\u7684\u5199\u5c31\u7eea\u4e8b\u4ef6 5\uff09\u4e3b\u7ebf\u7a0b\u8c03\u7528epoll_wait\u7b49\u5f85socket\u53ef\u5199 6\uff09\u5f53socket\u53ef\u5199\u65f6\uff0cepoll_wait\u901a\u77e5\u4e3b\u7ebf\u7a0b\u3002\u4e3b\u7ebf\u7a0b\u5c06socket\u53ef\u5199\u4e8b\u4ef6\u653e\u5165\u8bf7\u6c42\u961f\u5217\u3002 7\uff09\u7761\u7720\u5728\u8bf7\u6c42\u961f\u5217\u4e0a\u7684\u67d0\u4e2a\u5de5\u4f5c\u7ebf\u7a0b\u88ab\u5524\u9192\uff0c\u5b83\u5f80socket\u4e0a\u5199\u5165\u670d\u52a1\u5668\u5904\u7406\u5ba2\u6237\u8bf7\u6c42\u7684\u7ed3\u679c","title":"8.4.1\u3001Reactor\u6a21\u5f0f\uff08\u540c\u6b65I/O\u6a21\u578b\uff09"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#842proactor","text":"Proactor\u6a21\u5f0f \uff1a\u5c06\u6240\u6709I/O\u64cd\u4f5c\u90fd\u4ea4\u7ed9\u4e3b\u7ebf\u7a0b\u548c\u5185\u6838\u6765\u5904\u7406\uff0c\u5de5\u4f5c\u7ebf\u7a0b\u4ec5\u4ec5\u8d1f\u8d23\u4e1a\u52a1\u903b\u8f91\u3002 \u56fe8-6\uff08147/363\uff09 \u4f7f\u7528\u5f02\u6b65I/O\u6a21\u578b\uff08\u4ee5aio_read\u548caio_write\u4e3a\u4f8b\uff09\u5b9e\u73b0\u7684Proactor\u6a21\u5f0f\u7684\u5de5\u4f5c\u6d41\u7a0b\uff1a 1\uff09\u4e3b\u7ebf\u7a0b\u8c03\u7528aio_read\u51fd\u6570\u5411\u5185\u6838\u6ce8\u518csocket\u4e0a\u7684\u8bfb\u5b8c\u6210\u4e8b\u4ef6\uff0c\u5e76\u544a\u8bc9\u5185\u6838\u7528\u6237\u8bfb\u7f13\u51b2\u533a\u7684\u4f4d\u7f6e\uff0c\u4ee5\u53ca\u8bfb\u64cd\u4f5c\u5b8c\u6210\u65f6\u5982\u4f55\u901a\u77e5\u5e94\u7528\u7a0b\u5e8f\uff08\u8fd9\u91cc\u4ee5\u4fe1\u53f7\u4e3a\u4f8b\uff0c\u8be6\u60c5\u53c2\u8003sigevent\u7684man\u624b\u518c\uff09 2\uff09\u4e3b\u7ebf\u7a0b\u7ee7\u7eed\u5904\u7406\u5176\u4ed6\u903b\u8f91 3\uff09\u5f53socket\u4e0a\u7684\u6570\u636e\u88ab\u8bfb\u5165\u7528\u6237\u7f13\u51b2\u533a\u540e\uff0c\u5185\u6838\u5c06\u5411\u5e94\u7528\u7a0b\u5e8f\u53d1\u9001\u4e00\u4e2a\u4fe1\u53f7\uff0c\u4ee5\u901a\u77e5\u5e94\u7528\u7a0b\u5e8f\u6570\u636e\u5df2\u7ecf\u53ef\u7528 4\uff09\u5e94\u7528\u7a0b\u5e8f\u9884\u5148\u5b9a\u4e49\u597d\u7684\u4fe1\u53f7\u5904\u7406\u51fd\u6570\u9009\u62e9\u4e00\u4e2a\u5de5\u4f5c\u7ebf\u7a0b\u6765\u5904\u7406\u5ba2\u6237\u8bf7\u6c42\u3002\u5de5\u4f5c\u7ebf\u7a0b\u5904\u7406\u5b8c\u5ba2\u6237\u8bf7\u6c42\u4e4b\u540e\uff0c\u8c03\u7528aio_write\u51fd\u6570\u5411\u5185\u6838\u6ce8\u518csocket\u4e0a\u7684\u5199\u5b8c\u6210\u4e8b\u4ef6\uff0c\u5e76\u544a\u8bc9\u5185\u6838\u7528\u6237\u5199\u7f13\u51b2\u533a\u7684\u4f4d\u7f6e\uff0c\u4ee5\u53ca\u5199\u64cd\u4f5c\u5b8c\u6210\u65f6\u5982\u4f55\u901a\u77e5\u5e94\u7528\u7a0b\u5e8f\uff08\u4ecd\u7136\u4ee5\u4fe1\u53f7\u4e3a\u4f8b\uff09 5\uff09\u4e3b\u7ebf\u8def\u7ee7\u7eed\u5904\u7406\u5176\u4ed6\u903b\u8f91 6\uff09\u5f53\u7528\u6237\u7f13\u51b2\u533a\u7684\u6570\u636e\u88ab\u5199\u5165socket\u4e4b\u540e\uff0c\u5185\u6838\u5c06\u5411\u5e94\u7528\u7a0b\u5e8f\u53d1\u9001\u4e00\u4e2a\u4fe1\u53f7\uff0c\u4ee5\u901a\u77e5\u5e94\u7528\u7a0b\u5e8f\u6570\u636e\u5df2\u7ecf\u53d1\u9001\u5b8c\u6bd5 7\uff09\u5e94\u7528\u7a0b\u5e8f\u9884\u5148\u5b9a\u4e49\u597d\u7684\u4fe1\u53f7\u5904\u7406\u51fd\u6570\u9009\u62e9\u4e00\u4e2a\u5de5\u4f5c\u7ebf\u7a0b\u6765\u505a\u5584\u540e\u5904\u7406\uff0c\u6bd4\u5982\u51b3\u5b9a\u662f\u5426\u5173\u95edsocket","title":"8.4.2\u3001Proactor\u6a21\u5f0f"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#843proactor","text":"","title":"8.4.3\u3001\u540c\u6b65\u7684\u65b9\u5f0f\u6a21\u62df\u51faProactor\u6a21\u5f0f"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#85","text":"","title":"8.5\u3001\u4e24\u79cd\u9ad8\u6548\u7684\u5e76\u53d1\u6a21\u5f0f"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#851","text":"","title":"8.5.1\u3001\u534a\u540c\u6b65/\u534a\u5f02\u6b65\u6a21\u5f0f"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#852","text":"","title":"8.5.2\u3001\u9886\u5bfc\u8005/\u8ffd\u968f\u8005\u6a21\u5f0f"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#86","text":"","title":"8.6\u3001\u6709\u9650\u72b6\u6001\u673a"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#87","text":"","title":"8.7\u3001\u63d0\u9ad8\u670d\u52a1\u5668\u6027\u80fd\u7684\u5176\u5b83\u5efa\u8bae"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#871","text":"\u6c60 \uff1a\u662f\u4e00\u7ec4\u8d44\u6e90\u7684\u96c6\u5408\uff0c\u8fd9\u7ec4\u8d44\u6e90\u5728\u670d\u52a1\u5668\u542f\u52a8\u4e4b\u521d\u5c31\u88ab\u5b8c\u5168\u521b\u5efa\u597d\u5e76\u521d\u59cb\u5316\uff0c\u8fd9\u79f0\u4e3a \u9759\u6001\u8d44\u6e90\u5206\u914d \u3002 \u5185\u5b58\u6c60 \u8fdb\u7a0b\u6c60 \u7ebf\u7a0b\u6c60 \u8fde\u63a5\u6c60","title":"8.7.1\u3001\u6c60"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#872","text":"\u5f53\u4e24\u4e2a\u5de5\u4f5c\u8fdb\u7a0b\u4e4b\u95f4\u8981\u4f20\u9012\u5927\u91cf\u7684\u6570\u636e\u65f6\uff0c\u6211\u4eec\u5c31\u5e94\u8be5\u8003\u8651\u4f7f\u7528\u5171\u4eab\u5185\u5b58\u6765\u5728\u5b83\u4eec\u4e4b\u95f4\u76f4\u63a5\u5171\u4eab\u8fd9\u4e9b\u6570\u636e\uff0c\u800c\u4e0d\u662f\u4f7f\u7528\u7ba1\u9053\u6216\u8005\u6d88\u606f\u961f\u5217\u6765\u4f20\u9012\u3002","title":"8.7.2\u3001\u6570\u636e\u590d\u5236"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#873","text":"","title":"8.7.3\u3001\u4e0a\u4e0b\u6587\u5207\u6362\u548c\u9501"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#chap9io","text":"","title":"chap9\u3001I/O\u590d\u7528"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#91select","text":"select\u7cfb\u7edf\u8c03\u7528\u7684\u7528\u9014\u662f\uff1a \u5728\u4e00\u6bb5\u65f6\u95f4\u5185\uff0c\u76d1\u542c\u7528\u6237\u611f\u5174\u8da3\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0a\u7684\u53ef\u8bfb\u3001\u53ef\u5199\u548c\u5f02\u5e38\u7b49\u4e8b\u4ef6 \u3002","title":"9.1\u3001select\u7cfb\u7edf\u8c03\u7528"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#911select-api","text":"#include <sys/select.h> int select(int nfds, fd_set *readfs, fd_set *writefds, fd_set* exceptfds, struct timeval* timeout);","title":"9.1.1\u3001select api"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#912","text":"\u4e0b\u5217socket\u53ef\u8bfb \u4e0b\u5217socket\u53ef\u5199 \u7f51\u7edc\u7a0b\u5e8f\u4e2d\uff0cselect\u80fd\u5904\u7406\u7684\u5f02\u5e38\u60c5\u51b5\u53ea\u6709\u4e00\u79cd\uff1asocket\u4e0a\u63a5\u6536\u5230\u5e26\u5916\u6570\u636e \u3002","title":"9.1.2\u3001\u6587\u4ef6\u63cf\u8ff0\u7b26\u5c31\u7eea\u6587\u4ef6"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#913out-of-band-oob","text":"","title":"9.1.3\u3001\u5904\u7406\u5e26\u5916\u6570\u636e\uff08out-of band OOB)"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#92poll","text":"#include <poll.h> int poll(struct pollfd* fds, nfds_t nfds, int timeout);","title":"9.2\u3001poll\u7cfb\u7edf\u8c03\u7528"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#93epoll","text":"","title":"9.3\u3001epoll\u7cfb\u5217\u7cfb\u7edf\u8c03\u7528"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#931","text":"epoll\u662fLinux\u7279\u6709\u7684I/O\u590d\u7528\u51fd\u6570\u3002\u5b83\u5728\u5b9e\u73b0\u548c\u4f7f\u7528\u4e0a\u4e0eselect\u548cpoll\u6709\u5f88\u5927\u5dee\u5f02\u3002 epoll\u4f7f\u7528\u4e00\u7ec4\u51fd\u6570\u6765\u5b8c\u6210\u4efb\u52a1\uff0c\u800c\u4e0d\u662f\u5355\u4e2a\u51fd\u6570\u3002 epoll\u628a\u7528\u6237\u5173\u5fc3\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0a\u7684\u4e8b\u4ef6\u653e\u5728\u5185\u6838\u91cc\u7684\u4e00\u4e2a\u4e8b\u4ef6\u8868\u4e2d\uff0c\u4ece\u800c\u65e0\u987b\u50cfselect\u548cpoll\u90a3\u6837\u6bcf\u6b21\u8c03\u7528\u90fd\u8981\u91cd\u590d\u4f20\u5165\u6587\u4ef6\u63cf\u8ff0\u7b26\u96c6\u6216\u4e8b\u4ef6\u96c6\u3002 epoll\u9700\u8981\u4f7f\u7528\u4e00\u4e2a\u989d\u5916\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u6765\u552f\u4e00\u6807\u8bc6\u5185\u6838\u4e2d\u7684\u8fd9\u4e2a\u4e8b\u4ef6\u8868 \u3002 \u8fd9\u4e2a\u989d\u5916\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u7528 epoll_create() \u521b\u5efa #include<sys/epoll.h> int epoll_create(int size); \u64cd\u4f5cepoll\u7684\u5185\u6838\u8868\u7684\u51fd\u6570\u662f epoll_ctl() #include<sys/epoll.h> int epoll_ctl(int epfd, int op, int fd, struct epoll_event *event);","title":"9.3.1\u3001\u5185\u6838\u4e8b\u4ef6\u8868"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#932epoll_wait","text":"\u4f5c\u7528\u662f\uff1a \u5728\u4e00\u6bb5\u8d85\u65f6\u65f6\u95f4\u5185\u7b49\u5f85\u4e00\u7ec4\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0a\u7684\u4e8b\u4ef6 \u3002 #include <sys/epoll.h> int epoll_wait(int epfd, struct epoll_event *events, int maxevents, int timeout)","title":"9.3.2\u3001epoll_wait\u51fd\u6570"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#933ltet","text":"epoll\u5bf9\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u64cd\u4f5c\u6709\u4e24\u79cd\u6a21\u5f0f\uff1a LT\uff08Level Trigger \u7535\u5e73\u89e6\u53d1\uff09\uff1a\u9ed8\u8ba4\u7684\u5de5\u4f5c\u65b9\u5f0f\uff0c\u8fd9\u79cd\u6a21\u5f0f\u4e0b\u76f8\u5f53\u4e8e\u4e00\u4e2a\u6548\u7387\u8f83\u9ad8\u7684poll\u3002 ET\uff08Edge Trigger \u8fb9\u6cbf\u89e6\u53d1\uff09\uff1a\u5f53epoll_wait\u68c0\u6d4b\u5230\u5176\u4e0a\u6709\u4e8b\u4ef6\u53d1\u751f\u5e76\u5c06\u6b64\u4e8b\u4ef6\u901a\u77e5\u5e94\u7528\u7a0b\u5e8f\u540e\uff0c\u5e94\u7528\u7a0b\u5e8f\u5fc5\u987b\u7acb\u5373\u5904\u7406\u8be5\u4e8b\u4ef6\uff0c\u56e0\u4e3a\u540e\u7eed\u7684epoll_wait\u8c03\u7528\u5c06\u4e0d\u518d\u5411\u5e94\u7528\u7a0b\u5e8f\u901a\u77e5\u8fd9\u4e00\u4e8b\u4ef6\u3002","title":"9.3.3\u3001lt\u548cet\u6a21\u5f0f"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#934epolloneshot","text":"","title":"9.3.4\u3001epolloneshot\u4e8b\u4ef6"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#94io","text":"","title":"9.4\u3001\u4e09\u7ec4I/O\u590d\u7528\u51fd\u6570\u7684\u6bd4\u8f83"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#95ioconnect","text":"","title":"9.5\u3001I/O\u590d\u7528\u7684\u9ad8\u7ea7\u5e94\u7528\u4e00\uff1a\u975e\u963b\u585econnect"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#96io","text":"","title":"9.6\u3001I/O\u590d\u7528\u7684\u9ad8\u7ea7\u5e94\u7528\u4e8c\uff1a\u804a\u5929\u5ba4\u7a0b\u5e8f"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#961","text":"","title":"9.6.1\u3001\u5ba2\u6237\u7aef"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#962","text":"","title":"9.6.2\u3001\u670d\u52a1\u7aef"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#97iotcpudp","text":"","title":"9.7\u3001I/O\u590d\u7528\u7684\u9ad8\u7ea7\u5e94\u7528\u4e09\uff1a\u540c\u65f6\u5904\u7406tcp\u548cudp\u670d\u52a1"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#98xinetd","text":"","title":"9.8\u3001\u8d85\u7ea7\u670d\u52a1xinetd"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#981xinetd","text":"\u91c7\u7528 /etc/xinetd.conf \u4e3b\u914d\u7f6e\u6587\u4ef6\u548c /etc/xinetd.d \u76ee\u5f55\u4e0b\u7684\u5b50\u914d\u7f6e\u6587\u4ef6","title":"9.8.1\u3001xinetd\u914d\u7f6e\u6587\u4ef6"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#982xinetd","text":"\u6709\u65f6\u95f4\u65e5\u671f\u670d\u52a1daytime cat /var/run/xinetd.pid \u56fe9-1\uff08195/363\uff09 chap10\u3001\u4fe1\u53f7 chap11\u3001\u5b9a\u65f6\u5668 chap12\u3001\u9ad8\u6027\u80fdI/O\u6846\u67b6\u5e93Libevent","title":"9.8.2\u3001xinetd\u5de5\u4f5c\u6d41\u7a0b"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#chap13","text":"","title":"chap13\u3001\u591a\u8fdb\u7a0b\u7f16\u7a0b"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#0_5","text":"\u590d\u5236\u8fdb\u7a0b\u6620\u50cf\u7684fork\u7cfb\u7edf\u8c03\u7528\u548c\u66ff\u6362\u8fdb\u7a0b\u6620\u50cf\u7684exec\u7cfb\u5217\u7cfb\u7edf\u8c03\u7528 \u50f5\u5c38\u8fdb\u7a0b\u4ee5\u53ca\u5982\u4f55\u907f\u514d\u50f5\u5c38\u8fdb\u7a0b","title":"0"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#131fork","text":"\u5b50\u8fdb\u7a0b\u7684\u4ee3\u7801\u4e0e\u7236\u8fdb\u7a0b\u5b8c\u5168\u76f8\u540c\uff0c\u540c\u65f6\u5b83\u8fd8\u4f1a\u590d\u5236\u7236\u8fdb\u7a0b\u7684\u6570\u636e\uff08\u5806\u6570\u636e\u3001\u6808\u6570\u636e\u548c\u9759\u6001\u6570\u636e\uff09\u3002 \u6570\u636e\u7684\u590d\u5236\u91c7\u7528\u7684\u662f\u6240\u8c13\u7684\u5199\u65f6\u590d\u5236\uff08copy on write\uff09\uff0c\u5373\u53ea\u6709\u5728\u4efb\u4e00\u8fdb\u7a0b\uff08\u7236\u8fdb\u7a0b\u6216\u5b50\u8fdb\u7a0b\uff09\u5bf9\u6570\u636e\u6267\u884c\u4e86\u5199\u64cd\u4f5c\u65f6\uff0c\u590d\u5236\u624d\u4f1a\u53d1\u751f\uff08\u5148\u662f\u7f3a\u9875\u4e2d\u65ad\uff0c\u7136\u540e\u64cd\u4f5c\u7cfb\u7edf\u7ed9\u5b50\u8fdb\u7a0b\u5206\u914d\u5185\u5b58\u534a\u590d\u5236\u7236\u8fdb\u7a0b\u7684\u6570\u636e\uff09","title":"13.1\u3001fork\u7cfb\u7edf\u8c03\u7528"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#132exec","text":"","title":"13.2\u3001exec\u7cfb\u5217\u7cfb\u7edf\u8c03\u7528"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#133","text":"","title":"13.3\u3001\u5904\u7406\u50f5\u5c38\u8fdb\u7a0b"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#134","text":"\u7ba1\u9053\u80fd\u5728\u7236\u3001\u5b50\u8fdb\u7a0b\u95f4\u4f20\u9012\u6570\u636e\uff0c\u5229\u7528\u7684\u662ffork\u8c03\u7528\u4e4b\u540e\u4e24\u4e2a\u7ba1\u9053\u6587\u4ef6\u63cf\u8ff0\u7b26\uff08fd[0]\u548cfd[1]\uff09\u90fd\u4fdd\u6301\u6253\u5f00\u3002","title":"13.4\u3001\u7ba1\u9053"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#135","text":"13.5.1\u3001\u4fe1\u53f7\u91cf\u539f\u8bed P\uff08passeren\uff0c\u4f20\u9012\uff0c\u8fdb\u5165\u4e34\u754c\u533a\uff09\u548cV\uff08vrijgeven\uff0c\u91ca\u653e\uff0c\u9000\u51fa\u4e34\u754c\u533a\uff09 sys/sem.h 13.5.2\u3001semget\u7cfb\u7edf\u8c03\u7528 \u521b\u5efa\u4fe1\u53f7\u91cf\u96c6 13.5.3\u3001semop\u7cfb\u7edf\u8c03\u7528 13.5.4\u3001semctl\u7cfb\u7edf\u8c03\u7528 \u5141\u8bb8\u8c03\u7528\u8005\u5bf9\u4fe1\u53f7\u91cf\u8fdb\u884c\u76f4\u63a5\u63a7\u5236 13.5.5\u3001\u7279\u6b8a\u952e\u503cipc_private","title":"13.5\u3001\u4fe1\u53f7\u91cf"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#136","text":"","title":"13.6\u3001\u5171\u4eab\u5185\u5b58"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#0_6","text":"sys/shm.h 13.6.1\u3001shmget\u7cfb\u7edf\u8c03\u7528 13.6.2\u3001shmat\u548cshmdt\u7cfb\u7edf\u8c03\u7528 13.6.3\u3001shmctl\u7cfb\u7edf\u8c03\u7528 13.6.4\u3001\u5171\u4eab\u5185\u5b58\u7684posix\u65b9\u6cd5 13.6.5\u3001\u5171\u4eab\u5185\u5b58\u5b9e\u4f8b","title":"0\u3001"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#137","text":"13.7.1\u3001msgget\u7cfb\u7edf\u8c03\u7528 13.7.2\u3001msgsnd\u7cfb\u7edf\u8c03\u7528 13.7.3\u3001msgrcv\u7cfb\u7edf\u8c03\u7528 13.7.4\u3001msgctl\u7cfb\u7edf\u8c03\u7528","title":"13.7\u3001\u6d88\u606f\u961f\u5217"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#138ipc","text":"ipcs ipcrm \u547d\u4ee4\u6765\u5220\u9664\u9057\u7559\u5728\u7cfb\u7edf\u4e2d\u7684\u5171\u4eab\u8d44\u6e90","title":"13.8\u3001ipc\u547d\u4ee4"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#139","text":"\u4f20\u9012\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u5e76\u4e0d\u662f\u4f20\u9012\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u503c\uff0c\u800c\u662f\u8981\u5728\u63a5\u6536\u8fdb\u7a0b\u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u5e76\u4e14\u8be5\u6587\u4ef6\u63cf\u8ff0\u7b26\u548c\u53d1\u9001\u8fdb\u7a0b\u4e2d\u88ab\u4f20\u9012\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u6307\u5411\u5185\u6838\u4e2d\u76f8\u540c\u7684\u6587\u4ef6\u8868\u9879 \u3002 \u4ee3\u780113-5\uff1a\u5728\u8fdb\u7a0b\u95f4\u4f20\u9012\u6587\u4ef6\u63cf\u8ff0\u7b26 int main() { int pipefd[2]; int fd_to_pass = 0; //\u521b\u5efa\u7236\u3001\u5b50\u8fdb\u7a0b\u95f4\u7684\u7ba1\u9053\uff0c\u6587\u4ef6\u63cf\u8ff0\u7b26pipefd[0]\u548cpipefd[1]\u90fd\u662fUNIX\u57dfsocket int ret = socketpair(PF_UNIX, SOCK_DGRAM, 0, pipefd); assert(ret != -1); pid_t pid = fork(); assert(pid >= 0); if(pid == 0){ close(pipefd[0]); fd_to_pass = open(\"test.txt\",O_RDWR,0666); //\u5b50\u8fdb\u7a0b\u901a\u8fc7\u7ba1\u9053\u5c06\u6587\u4ef6\u63cf\u8ff0\u7b26\u53d1\u9001\u5230\u7236\u8fdb\u7a0b\u3002\u5982\u679c\u6587\u4ef6test.txt\u6253\u5f00\u5931\u8d25\uff0c\u5219\u5b50\u8fdb\u7a0b\u5c06\u6807\u51c6\u8f93\u5165\u6587\u4ef6\u63cf\u8ff0\u7b26\u53d1\u9001\u5230\u7236\u8fdb\u7a0b send_fd(pipefd[1], (fd_to_pass > 0)?fd_to_pass:0); close(fd_to_pass); exit(0); } close(pipefd[1]); fd_to_pass = recv_fd(pipefd[0]); //\u7236\u8fdb\u7a0b\u4ece\u7ba1\u9053\u63a5\u6536\u76ee\u6807\u6587\u4ef6\u63cf\u8ff0\u7b26 char buf[1024]; memset(buf,'\\0',1024); read(fd_to_pass, buf, 1024); //\u8bfb\u76ee\u6807\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u4ee5\u9a8c\u8bc1\u5176\u6709\u6548\u6027 printf(\"I got fd %d and data %s\\n\", fd_to_pass, buf); close(fd_to_pass); }","title":"13.9\u3001\u5728\u8fdb\u7a0b\u95f4\u4f20\u9012\u6587\u4ef6\u63cf\u8ff0\u7b26"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#chap14","text":"POSIX\u7ebf\u7a0b\u540c\u6b65\u65b9\u5f0f\uff1a POSIX\u4fe1\u53f7\u91cf\u3001\u4e92\u65a5\u9501\u548c\u6761\u4ef6\u53d8\u91cf","title":"chap14\u3001\u591a\u7ebf\u7a0b\u7f16\u7a0b"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#141linux","text":"","title":"14.1\u3001linux\u7ebf\u7a0b\u6982\u8ff0"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#1411","text":"\u4e00\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u62e5\u6709M\u4e2a\u5185\u6838\u7ebf\u7a0b\u548cN\u4e2a\u7528\u6237\u7ebf\u7a0b\uff0c\u5176\u4e2dM<=N\u3002 \u5e76\u4e14\u5728\u4e00\u4e2a\u7cfb\u7edf\u7684\u6240\u6709\u8fdb\u7a0b\u4e2d\uff0cM\u548cN\u7684\u6bd4\u503c\u90fd\u662f\u56fa\u5b9a\u7684\u3002 \u6309\u7167M:N\u7684\u53d6\u503c\uff0c\u7ebf\u7a0b\u7684\u5b9e\u73b0\u65b9\u5f0f\u53ef\u5206\u4e3a\u4e09\u79cd\u6a21\u5f0f\uff1a \u5b8c\u5168\u5728\u7528\u6237\u7a7a\u95f4\u5b9e\u73b0 \u5b8c\u5168\u7531\u5185\u6838\u8c03\u5ea6 \u53cc\u5c42\u8c03\u5ea6\uff08two level scheduler\uff09","title":"14.1.1\u3001\u7ebf\u7a0b\u6a21\u578b"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#1412linux","text":"","title":"14.1.2\u3001linux\u7ebf\u7a0b\u5e93"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#142","text":"pthread_create pthread_exit pthread_join pthread_cancel #include <pthread.h> int pthread_cancel(pthread_t thread);","title":"14.2\u3001\u521b\u5efa\u7ebf\u7a0b\u548c\u7ed3\u675f\u7ebf\u7a0b"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#143","text":"","title":"14.3\u3001\u7ebf\u7a0b\u5c5e\u6027"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#144posix","text":"pthread_join \u53ef\u4ee5\u770b\u4f5c\u4e00\u79cd\u7b80\u5355\u7684\u7ebf\u7a0b\u540c\u6b65\u65b9\u5f0f \uff0c\u5b83\u65e0\u6cd5\u9ad8\u6548\u5730\u5b9e\u73b0\u590d\u6742\u7684\u540c\u6b65\u9700\u6c42\uff0c\u6bd4\u5982\u63a7\u5236\u5bf9\u5171\u4eab\u8d44\u6e90\u7684\u72ec\u5360\u5f0f\u8bbf\u95ee\uff0c\u53c8\u6291\u6216\u662f\u5728\u67d0\u4e2a\u6761\u4ef6\u6ee1\u8db3\u4e4b\u540e\u5524\u9192\u4e00\u4e2a\u7ebf\u7a0b\u3002 POSIX\u4fe1\u53f7\u91cf\u51fd\u6570\u7684\u540d\u5b57\u662f\u4ee5 sem_ \u5f00\u5934\uff0c\u5e38\u7528\u7684\u662f\u4e0b\u97625\u4e2a #include <semaphore.h> int sem_init(sem_t *sem, int pshard, unsigned int value); int sem_wait(sem_t *sem);","title":"14.4\u3001posix\u4fe1\u53f7\u91cf"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#145","text":"","title":"14.5\u3001\u4e92\u65a5\u9501"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#1451api","text":"","title":"14.5.1\u3001\u4e92\u65a5\u9501\u57fa\u7840api"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#1452","text":"","title":"14.5.2\u3001\u4e92\u65a5\u9501\u5c5e\u6027"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#1453","text":"","title":"14.5.3\u3001\u6b7b\u9501\u4e3e\u4f8b"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#146","text":"\u5982\u679c\u8bf4\u4e92\u65a5\u9501\u662f\u7528\u4e8e\u540c\u6b65\u7ebf\u7a0b\u5bf9\u5171\u4eab\u6570\u636e\u7684\u8bbf\u95ee\u7684\u8bdd\uff0c\u90a3\u4e48\u6761\u4ef6\u53d8\u91cf\u5219\u662f \u7528\u4e8e\u5728\u7ebf\u7a0b\u4e4b\u95f4\u540c\u6b65\u5171\u4eab\u6570\u636e\u7684\u503c \u3002 \u6761\u4ef6\u53d8\u91cf\u63d0\u4f9b\u4e86\u4e00\u79cd \u7ebf\u7a0b\u95f4\u7684\u901a\u77e5\u673a\u5236 \uff1a\u5f53\u67d0\u4e2a\u5171\u4eab\u6570\u636e\u8fbe\u5230\u67d0\u4e2a\u503c\u7684\u65f6\u5019\uff0c\u5524\u9192\u7b49\u5f85\u8fd9\u4e2a\u5171\u4eab\u6570\u636e\u7684\u7ebf\u7a0b\u3002 5\u4e2a\u51fd\u6570","title":"14.6\u3001\u6761\u4ef6\u53d8\u91cf"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#147","text":"","title":"14.7\u3001\u7ebf\u7a0b\u540c\u6b65\u673a\u5236\u5305\u88c5\u7c7b"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#148","text":"","title":"14.8\u3001\u591a\u7ebf\u7a0b\u73af\u5883"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#1481","text":"\u5982\u679c\u4e00\u4e2a\u51fd\u6570\u80fd\u88ab\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u8c03\u7528\u4e14\u4e0d\u53d1\u751f\u7ade\u6001\u6761\u4ef6\uff0c\u5219\u6211\u4eec\u79f0\u5b83\u662f \u7ebf\u7a0b\u5b89\u5168\u7684\uff08thread safe\uff09 \uff0c\u6216\u8005\u8bf4\u5b83\u662f \u53ef\u91cd\u5165\u51fd\u6570 \u3002","title":"14.8.1\u3001\u53ef\u91cd\u5165\u51fd\u6570"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#1482","text":"\u5b50\u8fdb\u7a0b\u53ea\u62e5\u6709\u4e00\u4e2a\u6267\u884c\u7ebf\u7a0b","title":"14.8.2\u3001\u7ebf\u7a0b\u548c\u8fdb\u7a0b"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#1483","text":"\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u53ef\u4ee5\u72ec\u7acb\u5730\u8bbe\u7f6e\u4fe1\u53f7\u63a9\u7801 \u3002 sigprocmask() chap15\u3001\u8fdb\u7a0b\u6c60\u548c\u7ebf\u7a0b\u6c60","title":"14.8.3\u3001\u7ebf\u7a0b\u548c\u4fe1\u53f7"},{"location":"10network/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/#part0316-17","text":"","title":"Part03\u3001\u9ad8\u6027\u80fd\u670d\u52a1\u5668\u4f18\u5316\u4e0e\u76d1\u6d4b\uff0816-17\uff09"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/","text":"\u300aTCP/IP\u7f51\u7edc\u7f16\u7a0b\u300b \u00b6 Part01\u3001 Part01\u3001\u5f00\u59cb\u7f51\u7edc\u7f16\u7a0b\uff081-14\uff09 chap1\u3001\u7406\u89e3\u7f51\u7edc\u7f16\u7a0b\u548c\u5957\u63a5\u5b57 \u00b6 1.1\u3001\u7406\u89e3\u7f51\u7edc\u7f16\u7a0b\u548c\u5957\u63a5\u5b57 \u00b6 \u63a5\u53d7\u8fde\u63a5\u8bf7\u6c42 \u3010\u5373\u670d\u52a1\u7aef\u3011\u7684TCP\u5957\u63a5\u5b57\u521b\u5efa\u8fc7\u7a0b 1\u3001\u8c03\u7528 socket() \u521b\u5efa\u5957\u63a5\u5b57 2\u3001\u8c03\u7528 bind() \u5206\u914dIP\u5730\u5740\u548c\u7aef\u53e3\u53f7 3\u3001\u8c03\u7528 listen() \u8f6c\u4e3a\u53ef\u63a5\u6536\u8bf7\u6c42\u72b6\u6001 4\u3001\u8c03\u7528 accept() \u53d7\u7406\u8fde\u63a5\u8bf7\u6c42 \u8bf7\u6c42\u8fde\u63a5 \u3010\u5373\u5ba2\u6237\u7aef\u3011\uff0cTCP 1\u3001\u8c03\u7528 socket() 2\u3001\u8c03\u7528 connect() 1.2\u3001\u57fa\u4e8eLinux\u7684\u6587\u4ef6\u64cd\u4f5c \u00b6 socket\u4f1a\u88ab\u8ba4\u4e3a\u662f\u6587\u4ef6\u7684\u4e00\u79cd \uff0c\u76f4\u63a5\u7528I/O\u64cd\u4f5c\u5373\u53ef\uff0c open()\u3001close()\u3001write() \u4e66\u4e0a\u63d0\u5230\u4e86 _t \u540e\u7f00\u7684\u6570\u636e\u7c7b\u578b \uff08\u4e00\u822c\u90fd\u662ftypedef\u58f0\u660e\u5f15\u8d77\u7684\uff09 fd\u662f\u5565\uff0c \u64cd\u4f5c\u7cfb\u7edf\u8fd4\u56de\u7684\u6574\u6570 \uff08\u4e5f\u5c31\u662f\u4e3a\u4e86\u65b9\u4fbf\u79f0\u547cOS\u521b\u5efa\u7684\u6587\u4ef6\u6216\u5957\u63a5\u5b57\u800c\u8d4b\u4e88\u7684\u6570\u800c\u5df2\uff09\uff0c \u53ef\u4ee5\u8fd9\u4e48\u8bb0\uff0c\u4f46\u662f\u903b\u8f91\u4e0d\u662f\u8fd9\u6837\uff0c\u56e0\u4e3a\u662f\u901a\u8fc7fd\u6574\u6570\u7684\u4e0b\u6807\uff0c\u53bb\u6570\u7ec4\u91cc\u627e\u5230\u4e86\u76f8\u5e94\u7684\u503c \u573a\u666f\u662f\uff0c\u6211\u60f3\u6253\u5370\u300aTCP/IP\u7f51\u7edc\u7f16\u7a0b\u300b\u768418-20\u9875\uff0c\u8bf4\u591a\u4e86\u53ef\u4ee5\u7b80\u5199\u4e3a\u6211\u60f3\u6253\u5370\u7f16\u53f710\u768418-20\u9875\u3002 chap2\u3001\u5957\u63a5\u5b57\u7c7b\u578b\u4e0e\u534f\u8bae\u8bbe\u7f6e \u00b6 2.1\u3001\u5957\u63a5\u5b57\u534f\u8bae\u53ca\u5176\u6570\u636e\u4f20\u8f93\u7279\u6027 \u00b6 \u5173\u4e8e\u534f\u8bae \u5bf9\u8bdd\u4e2d\u4f7f\u7528\u7684\u901a\u4fe1\u89c4\u5219 \u534f\u8bae\u65cf\uff08Protocol Family\uff09 socket\u7684\u7b2c1\u4e2a\u53c2\u6570 sys/socket.h PF_INET \uff0cipv4 PF_PACKET \uff0c\u5e95\u5c42\u5957\u63a5\u5b57 \u5957\u63a5\u5b57\u7c7b\u578b\uff08type\uff09 \u5957\u63a5\u5b57\u7684\u6570\u636e\u4f20\u8f93\u65b9\u5f0f \uff0csocket\u7684\u7b2c2\u4e2a\u53c2\u6570 1\u3001\u9762\u5411\u8fde\u63a5\u7684\u5957\u63a5\u5b57\uff08SOCK_STREAM\uff09 \u4f20\u8f93\u8fc7\u7a0b\u4e2d\u6570\u636e\u4e0d\u4f1a\u6d88\u5931 \u6309\u5e8f\u4f20\u8f93\u6570\u636e \u4f20\u8f93\u7684\u6570\u636e\u4e0d\u5b58\u5728\u6570\u636e\u8fb9\u754c- lionel\uff0c\u8fd9\u4e2a\u5176\u5b9e\u6ca1\u592a\u7406\u89e3 2\u3001\u9762\u5411\u6d88\u606f\u7684\u5957\u63a5\u5b57\uff08SOCK_DGRAM\uff09 \u5f3a\u8c03\u5feb\u901f\u4f20\u8f93\u800c\u975e\u4f20\u8f93\u987a\u5e8f 39/421 \u534f\u8bae\u7684\u6700\u7ec8\u9009\u62e9 socket\u7684\u7b2c3\u4e2a\u53c2\u6570 \u4e00\u822c\u4e3a0\uff0c \u4f46 \u6570\u636e\u4f20\u8f93\u65b9\u5f0f\u76f8\u540c\uff0c\u534f\u8bae\u4e0d\u540c\uff0c\u9700\u8981\u7b2c3\u4e2a\u53c2\u6570\u6307\u5b9a \u3002\u3010\u540c\u4e00\u534f\u8bae\u65cf\u4e2d\u5b58\u5728\u591a\u4e2a\u6570\u636e\u4f20\u8f93\u65b9\u5f0f\u76f8\u540c\u7684\u534f\u8bae\u3011 lionel\u6ce8\uff1a \u00b6 socket() \u76843\u4e2a\u53c2\u6570\u8bb2\u89e3\uff0c\u77e5\u8bc6\u81ea\u5df1\u76f2\u533a\uff0c\u5230\u65f6\u8bd5\u4e0b man socket \u770b\u770b chap3\u3001\u5730\u5740\u65cf\u4e0e\u6570\u636e\u5e8f\u5217 \u00b6 3.1\u3001 \u00b6 IP\u53ea\u5230\u4e3b\u673a\uff0cPort\u5230\u5e94\u7528\u7a0b\u5e8f 3.2\u3001\u5730\u5740\u4fe1\u606f\u7684\u8868\u793a \u00b6 3.3\u3001\u7f51\u7edc\u5b57\u8282\u5e8f\u4e0e\u5730\u5740\u53d8\u6362 \u00b6 \u3010\u8fd9\u90e8\u5206\u8981\u81ea\u5df1\u641c\u4e00\u4e0b\uff0c\u5927\u7aef\u5e8f\uff0c\u5c0f\u7aef\u5e8f\u3011 3.4\u3001\u7f51\u7edc\u5730\u5740\u7684\u521d\u59cb\u5316\u4e0e\u5206\u914d \u00b6 \u77e5\u8bc6\u5185\u5bb9\uff0c\u8fd8\u6ca1\u597d\u597d\u770b\uff0clionel\uff0c\u77e5\u8bc6\u76f2\u533a 56/421 struct sockaddr_in addr; memset(&addr, 0, sizeof(addr)); addr.sin_addr.s_addr = htonl(INADDR_ANY)); //**\u81ea\u52a8\u83b7\u53d6\u8fd0\u884c\u670d\u52a1\u5668\u7aef\u7684\u8ba1\u7b97\u673aIP\u5730\u5740** chap4-5\u3001\u57fa\u4e8eTCP\u7684\u670d\u52a1\u7aef/\u5ba2\u6237\u7aef \u00b6 4.1\u3001\u7406\u89e3TCP\u548cUDP \u00b6 IP\u5c42\u89e3\u51b3\u6570\u636e\u4f20\u8f93\u4e2d\u7684\u8def\u5f84\u9009\u62e9\u95ee\u9898\uff0cTCP\u5c42\u548cUDP\u5c42\u4ee5IP\u5c42\u63d0\u4f9b\u7684\u8def\u5f84\u4fe1\u606f\u4e3a\u57fa\u7840\u5b8c\u6210\u5b9e\u9645\u7684\u6570\u636e\u4f20\u8f93 \u3002 4.2\u3001\u5b9e\u73b0\u57fa\u4e8eTCP\u7684\u670d\u52a1\u5668\u7aef/\u5ba2\u6237\u7aef \u00b6 \u5c31\u662f \u672c\u7ae01.1+1.2 \uff0c\u5373\u8fde\u4e0a\u540e\u8fdb\u884c \u8bfb\u5199+\u5173\u95ed \u6df1\u5165\u4e86\u89e3\u4e00\u4e0baccept()\u7684\u7ec6\u8282\u95ee\u9898\uff0c \u4e3a\u5565\u8fd4\u56de\u7684fd\u80fd\u591f\u76f4\u63a5\u901a\u4fe1\uff0clionel \u4f1a\u5b58\u5728\u6240\u8c13\u7684\u201c\u60ca\u7fa4\u201d\u73b0\u8c61\uff0c\u9762\u8bd5\u4f1a\u4e0d\u4f1a\u8003\u5230\uff1f 4.3\u3001\u5b9e\u73b0\u8fed\u4ee3\u670d\u52a1\u5668\u7aef/\u5ba2\u6237\u7aef \u00b6 \u8fd9\u4e2a\u8981\u60f3\u4e00\u4e0b\u539f\u7406\uff0clionel \u8fed\u4ee3\u670d\u52a1\u5668\u7684\u4ee3\u7801 \u5b58\u5728\u7684\u95ee\u9898\uff0clionel \u3010TCP\u4e0d\u5b58\u5728\u6570\u636e\u8fb9\u754c\uff0cwrite()\u6bcf\u6b21\u4f20\u90121\u4e2a\u5b57\u7b26\u4e32\uff0c\u591a\u6b21\u8c03\u7528\u540e\uff0c\u5ba2\u6237\u7aef\u53ef\u80fd\u4f1a\u6536\u5230\u591a\u4e2a\u5b57\u7b26\u4e32\uff0c\u8fd9\u4e2a\u600e\u4e48\u9a8c\u8bc1\u4e0b\uff1f\u3011 87/421 \u56de\u58f0\uff08\u670d\u52a1\u5668\u7aef\u5c06\u5ba2\u6237\u7aef\u4f20\u8f93\u7684\u5b57\u7b26\u4e32\u6570\u636e\u539f\u5c01\u4e0d\u52a8\u5730\u4f20\u56de\u5ba2\u6237\u7aef\uff09 5.1\u3001\u56de\u58f0\u5ba2\u6237\u7aef\u7684\u5b8c\u7f8e\u8868\u73b0 \u00b6 \u4e0d\u662f\u592a\u61c2\uff0clionel 92/421 5.2\u3001TCP\u539f\u7406 \u00b6 \u4e09\u6b21\u63e1\u624b\uff08103/421\uff09 \u56db\u6b21\u6325\u624b\uff08106/421\uff09\uff0c \u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u90fd\u8981\u53d1\u9001 FIN lionel\u6ce8\uff1a \u00b6 \u8981\u8ba9\u6211 \u5b9e\u73b0\u8fed\u4ee3\u670d\u52a1\u5668\u7aef/\u5ba2\u6237\u7aef \uff0c\u6211\u4e5f\u4e0d\u4f1a chap6\u3001\u57fa\u4e8eUDP\u7684\u670d\u52a1\u7aef/\u5ba2\u6237\u7aef \u00b6 \u8981\u8865\u5145\u5b8c\u5584\u4e00\u70b9 \uff0c\u76ee\u524d\u7b14\u8bb0\u4e0a\u90fd\u662f\u7a7a\uff0clionel chap7\u3001\u4f18\u96c5\u7684\u65ad\u5f00\u5957\u63a5\u5b57\u8fde\u63a5 \u00b6 7.1\u3001\u57fa\u4e8eTCP\u7684\u534a\u5173\u95ed \u00b6 \u5355\u65b9\u9762\u65ad\u5f00\u8fde\u63a5\u5e26\u6765\u7684\u95ee\u9898 close() \u662f\u5b8c\u5168\u5173\u95ed\uff0c \u4e0d\u4ec5\u65e0\u6cd5\u4f20\u8f93\u6570\u636e\uff0c\u800c\u4e14\u4e5f\u4e0d\u80fd\u63a5\u6536\u6570\u636e \u3002 \u5957\u63a5\u5b57\u548c\u6d41\uff08stream\uff09 \u9488\u5bf9\u4f18\u96c5\u65ad\u5f00\u7684shutdown\u51fd\u6570 \u7b2c2\u4e2a\u53c2\u6570\u51b3\u5b9a\u65ad\u5f00\u8fde\u63a5\u7684\u65b9\u5f0f SHUT_RD\uff1a\u65ad\u5f00\u8f93\u5165\u6d41 SHUT_WR\uff1a\u65ad\u5f00\u8f93\u51fa\u6d41 SHUT_RDWR\uff1a\u540c\u65f6\u65ad\u5f00I/O\u6d41 #include<sys/socket.h> int shutdown(int sock, int howto); \u4e3a\u4f55\u9700\u8981\u534a\u5173\u95ed \u57fa\u4e8e\u534a\u5173\u95ed\u7684\u6587\u4ef6\u4f20\u8f93\u7a0b\u5e8f file_server.c file_client.c chap8\u3001\u57df\u540d\u53ca\u7f51\u7edc\u5730\u5740 \u00b6 8.1\u3001\u57df\u540d\u7cfb\u7edf \u00b6 \u4ec0\u4e48\u662f\u57df\u540d DNS\u670d\u52a1\u5668 8.2\u3001IP\u5730\u5740\u548c\u57df\u540d\u4e4b\u95f4\u7684\u8f6c\u6362 \u00b6 \u7a0b\u5e8f\u4e2d\u6709\u5fc5\u8981\u4f7f\u7528\u57df\u540d\u5417\uff1f \u6240\u6709\u5b66\u4e60\u90fd\u8981\u5728\u5f00\u59cb\u524d\u8ba4\u8bc6\u5230\u5176\u5fc5\u8981\u6027 \u3002 \u5229\u7528\u57df\u540d\u83b7\u53d6IP\u5730\u5740 gethostbyname.c #include <netdb.h> struct hostent* gethostbyname(const char* hostname); struct hostent{ char* h_name; //\u5b98\u65b9\u57df\u540d char** h_aliases; //\u5176\u5b83\u57df\u540d int h_addrtype;//ipv4\u8fd8\u662fipv6 int h_length;//IP\u5730\u5740\u957f\u5ea6 char** h_addr_list;//\u4ee5\u6574\u6570\u5f62\u5f0f\u4fdd\u5b58\u57df\u540d\u5bf9\u5e94\u7684IP\u5730\u5740 } \u5229\u7528IP\u5730\u5740\u83b7\u53d6\u57df\u540d gethostbyaddr.c #include <netdb.h> struct hostent* gethostbyaddr(const char *addr, socklen_t len, int family); chap9\u3001\u5957\u63a5\u5b57\u7684\u591a\u79cd\u53ef\u9009\u9879 \u00b6 \uff08150/421\uff09\uff0c\u8fd9\u4e2a\u7b97\u6bd4\u8f83\u91cd\u70b9\u7684\u5730\u65b9\uff1flionel 9.1\u3001\u5957\u63a5\u5b57\u53ef\u9009\u9879\u548cI/O\u7f13\u51b2\u5927\u5c0f \u00b6 \u5957\u63a5\u5b57\u591a\u79cd\u53ef\u9009\u9879 \u534f\u8bae\u5c42 SOL_SOCKET IPPROTO_IP IPPROTO_TCP getsockopt&setsockopt sock_type.c #include<sys/socket.h> int getsockopt(int sock, int optname, void *optval, socklen_t *optlen); int setsockopt(int sock, int level, int optname, const void *optval, socklen_t *optlen); SO_SNDBUF&SO_RCVBUF SO_RCVBUF\uff1a\u8f93\u5165\u7f13\u51b2\u5927\u5c0f\u76f8\u5173\u53ef\u9009\u9879 SO_SNDBUF\uff1a\u8f93\u51fa\u7f13\u51b2\u5927\u5c0f\u76f8\u5173\u53ef\u9009\u9879 \u8fd92\u4e2a\u9009\u9879\u65e2\u53ef\u4ee5\u8bfb\u53d6\u5f53\u524dI/O\u7f13\u51b2\u5927\u5c0f\uff0c\u4e5f\u53ef\u4ee5\u8fdb\u884c\u66f4\u6539 \u3002 get_buf.c set_buf.c 9.2\u3001SO_REUSEADDR \u00b6 0 \u5b66\u4e60SO_REUSEADDR\u53ef\u9009\u9879\u4e4b\u524d\uff0c\u5e94\u7406\u89e3\u597dTime-wait\u72b6\u6001 \u3002 \u53d1\u751f\u5730\u5740\u5206\u914d\u9519\u8bef\uff08Binding Error\uff09 reuseaddr_eserver.c Time-wait\u72b6\u6001 \u5148\u65ad\u5f00\u8fde\u63a5\u7684\uff08\u5148\u53d1\u9001FIN\u6d88\u606f\u7684\uff09\u5957\u63a5\u5b57\u5fc5\u7136\u4f1a\u7ecf\u8fc7Time-wait\u72b6\u6001 \u5982\u679c\u6ca1\u6709time-wait\u72b6\u6001\uff0c\uff08A\u53d1\u4e86FIN\u6ca1\u6709\u6536\u5230 B\u7684ACK\u540e\uff0c\u4f1a\u91cd\u53d1FIN\uff0c\u4f46B\u5df2\u7ecf\u4e0b\u7ebf\u4e86\uff09 158/421\uff0c\u8fd9\u90e8\u5206\u89e3\u91ca\u5f97\u6bd4\u8f83OK \u5730\u5740\u518d\u5206\u914d 9.3\u3001TCP_NODELAY \u00b6 Nagle\u7b97\u6cd5 \u7981\u7528Nagle\u7b97\u6cd5 \u5c06\u5957\u63a5\u5b57\u53ef\u9009\u9879TCP_NODELAY\u6539\u4e3a1\uff08\u771f\uff09 \u4e66\u4e0a\u8fd8\u6ca1\u770b\uff0c\u4e4b\u524d\u770b\u8fc7\u7f51\u7edc\u7b14\u8bb0\u4e0a\u7684 chap10\u3001\u591a\u8fdb\u7a0b\u670d\u52a1\u5668\u7aef \u00b6 lionel\uff0cIO\u5206\u6d41\uff0c\u6211\u786e\u5b9e\u6ca1\u61c2 \u3010routine\u3011 10.1\u3001\u8fdb\u7a0b\u6982\u5ff5\u53ca\u5e94\u7528 \u00b6 \u5e76\u53d1\u670d\u52a1\u5668\u7aef\u7684\u5b9e\u73b0\u65b9\u6cd5 \u591a\u8fdb\u7a0b\u670d\u52a1\u5668\uff1a\u901a\u8fc7\u521b\u5efa\u591a\u4e2a\u8fdb\u7a0b\u63d0\u4f9b\u670d\u52a1 \u591a\u8def\u590d\u8def\u670d\u52a1\u5668\uff1a\u901a\u8fc7\u6346\u7ed1\u5e76\u7edf\u4e00\u7ba1\u7406I/O\u5bf9\u8c61\u63d0\u4f9b\u670d\u52a1 \u591a\u7ebf\u7a0b\u670d\u52a1\u5668\uff1a\u901a\u8fc7\u751f\u6210\u4e0e\u5ba2\u6237\u7aef\u7b49\u91cf\u7684\u7ebf\u7a0b\u63d0\u4f9b\u670d\u52a1 \u7406\u89e3\u8fdb\u7a0b \u5360\u7528\u5185\u5b58\u7a7a\u95f4\u7684\u6b63\u5728\u8fd0\u884c\u7684\u7a0b\u5e8f \u901a\u8fc7\u8c03\u7528fork\u51fd\u6570\u521b\u5efa\u8fdb\u7a0b 10.2\u3001\u8fdb\u7a0b\u548c\u50f5\u5c38\u8fdb\u7a0b \u00b6 \u50f5\u5c38\uff08Zombie\uff09\u8fdb\u7a0b \u5b8c\u6210\u5de5\u4f5c\u6ca1\u6709\u88ab\u9500\u6bc1\uff0c\u7ee7\u7eed\u5360\u7528\u7cfb\u7edf\u4e2d\u7684\u91cd\u8981\u8d44\u6e90 \u4ea7\u751f\u50f5\u5c38\u8fdb\u7a0b\u7684\u539f\u56e0 \u7236\u8fdb\u7a0b\u6ca1\u6709\u7ba1\u5b50\u8fdb\u7a0b \u9500\u6bc1\u50f5\u5c38\u8fdb\u7a0b1\uff1a\u5229\u7528wait\u51fd\u6570 \u9500\u6bc1\u50f5\u5c38\u8fdb\u7a0b2\uff1a\u5229\u7528waitpid\u51fd\u6570 10.3\u3001\u4fe1\u53f7\u5904\u7406 \u00b6 \u5411\u64cd\u4f5c\u7cfb\u7edf\u6c42\u52a9 \u5173\u4e8eJAVA\u7684\u9898\u5916\u8bdd\uff1a\u4fdd\u6301\u5f00\u653e\u601d\u7ef4 \u4fe1\u53f7\u4e0esignal\u51fd\u6570 \u5229\u7528sigaction\u51fd\u6570\u8fdb\u884c\u4fe1\u53f7\u5904\u7406 10.4\u3001\u57fa\u4e8e\u591a\u4efb\u52a1\u7684\u5e76\u53d1\u670d\u52a1\u5668 \u00b6 \u57fa\u4e8e\u8fdb\u7a0b\u7684\u5e76\u53d1\u670d\u52a1\u5668\u6a21\u578b \u56fe10-2\uff1a\u5e76\u53d1\u670d\u52a1\u5668\u6a21\u578b \uff08183/421\uff09 \u5b9e\u73b0\u5e76\u53d1\u670d\u52a1\u5668 \u901a\u8fc7fork\u51fd\u6570\u590d\u5236\u6587\u4ef6\u63cf\u8ff0\u7b26 lionel\uff0c\u4ee3\u7801\u770b\u4e00\u4e0b\u5148 10.5\u3001\u5206\u5272TCP\u7684I/O\u7a0b\u5e8f \u00b6 \u5206\u5272I/O\u7a0b\u5e8f\u7684\u4f18\u70b9 \u56de\u58f0\u5ba2\u6237\u7aef\u7684I/O\u7a0b\u5e8f\u5206\u5272 chap11\u3001\u8fdb\u7a0b\u95f4\u901a\u4fe1 \u00b6 11.1\u3001\u8fdb\u7a0b\u95f4\u901a\u4fe1\u7684\u57fa\u672c\u6982\u5ff5 \u00b6 \u5bf9\u8fdb\u7a0b\u95f4\u901a\u4fe1\u7684\u57fa\u672c\u6982\u5ff5 \u901a\u8fc7\u7ba1\u9053\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1 11.2\u3001\u8fd0\u7528\u8fdb\u7a0b\u95f4\u901a\u4fe1 \u00b6 \u4fdd\u5b58\u6d88\u606f\u7684\u56de\u58f0\u670d\u52a1\u5668\u7aef \u5982\u679c\u60f3\u6784\u5efa\u66f4\u5927\u578b\u7684\u7a0b\u5e8f chap12\u3001I/O\u590d\u7528 \u00b6 12.1\u3001\u57fa\u4e8eI/O\u590d\u7528\u7684\u670d\u52a1\u5668\u7aef \u00b6 \u591a\u8fdb\u7a0b\u670d\u52a1\u5668\u7aef\u7684\u7f3a\u70b9\u548c\u89e3\u51b3\u65b9\u6cd5 \u7406\u89e3\u590d\u7528 \u5b9a\u4e49\uff1a 1\u3001\u57281\u4e2a\u901a\u4fe1\u9891\u9053\u4e2d\u4f20\u9012\u591a\u4e2a\u6570\u636e\uff08\u4fe1\u53f7\uff09\u7684\u6280\u672f 2\u3001\u4e3a\u4e86\u63d0\u9ad8\u7269\u7406\u8bbe\u5907\u7684\u6548\u7387\uff0c\u7528\u6700\u5c11\u7684\u7269\u7406\u8981\u7d20\u4f20\u9012\u6700\u591a\u6570\u636e\u65f6\u4f7f\u7528\u7684\u6280\u672f \u590d\u7528\u6280\u672f\u7684\u4f18\u70b9\uff1a \u51cf\u5c11\u8fde\u7ebf\u957f\u5ea6 \u51cf\u5c11\u7eb8\u676f\u4e2a\u6570 \u590d\u7528\u6280\u672f\u5728\u670d\u52a1\u5668\u7aef\u7684\u5e94\u7528 12.2\u3001\u7406\u89e3select\u51fd\u6570\u5e76\u5b9e\u73b0\u670d\u52a1\u5668\u7aef \u00b6 select\u51fd\u6570\u7684\u529f\u80fd\u548c\u8c03\u7528\u987a\u5e8f \u8bbe\u7f6e\u6587\u4ef6\u63cf\u8ff0\u7b26 \u8bbe\u7f6e\u68c0\u67e5\uff08\u76d1\u89c6\uff09\u8303\u56f4\u53ca\u8d85\u65f6 \u8c03\u7528select\u51fd\u6570\u540e\u67e5\u770b\u7ed3\u679c \u4f7f\u7528select\u51fd\u6570\u65f6\u53ef\u4ee5\u5c06\u591a\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u96c6\u4e2d\u5230\u4e00\u8d77\u7edf\u4e00\u76d1\u89c6 \uff08\u5206\u62103\u79cd\u60c5\u51b5\uff1a\u63a5\u6536\u3001\u4f20\u8f93\u3001\u5f02\u5e38\uff09 FD_SET() chap13\u3001\u591a\u79cdI/O\u51fd\u6570 \u00b6 13.1\u3001send&recv\u51fd\u6570 \u00b6 Linux\u4e2d\u7684send&recv #include<sys/socket.h> ssize_t send(int sockfd, const void* buf, size_t nbytes, int flags); ssize_t recv(int sockfd, void *buf, size_t nbytes, int flags); MSG_OOB\uff1a\u53d1\u9001\u7d27\u6025\u6d88\u606f oob_send.c oob_recv.c \u7d27\u6025\u6a21\u5f0f\u5de5\u4f5c\u539f\u7406 \u68c0\u67e5\u8f93\u5165\u7f13\u51b2 peek_send.c peek_recv.c 13.2\u3001readv&writev\u51fd\u6570 \u00b6 \u4f7f\u7528readv&writev\u51fd\u6570 writev.c readv.c #include<sys/uio.h> ssize_t writev(int filedes, const struct iovec* iov, int iovcnt); struct iovec{ void* iov_base; //\u7f13\u51b2\u5730\u5740 size_t iov_len; //\u7f13\u51b2\u5927\u5c0f } ssize_t readv(int filedes, const struct iovec *iov, int iovcnt); \u5408\u7406\u4f7f\u7528readv&writev\u51fd\u6570 chap14\u3001\u591a\u64ad\u4e0e\u5e7f\u64ad \u00b6 TCP\u662f\u4e00\u5bf9\u4e00\u7684\uff0c\u6240\u4ee5\u4e0d\u5b58\u5728\u5e7f\u64ad\u548c\u591a\u64ad\u3002 14.1\u3001\u591a\u64ad \u00b6 \u591a\u64ad\u7684\u6570\u636e\u4f20\u8f93\u65b9\u5f0f\u53ca\u6d41\u91cf\u65b9\u9762\u7684\u4f18\u70b9 \u8def\u7531\uff08Routing\uff09\u548cTTL\uff08Time to Live\uff1a\u751f\u5b58\u65f6\u95f4\uff09\uff0c\u4ee5\u53ca\u52a0\u5165\u7ec4\u7684\u65b9\u6cd5 \u5b9e\u73b0\u591a\u64adSender\u548cReceiver news_sender.c news_receiver.c 242/421\u4e2d\u7684\u4ee3\u7801\u8fc7\u7a0b\uff0c\u662fttl\u548c\u52a0\u5165\u7ec4\u7684\u65b9\u6cd5 14.2\u3001\u5e7f\u64ad \u00b6 \u5e7f\u64ad\u7684\u7406\u89e3\u53ca\u5b9e\u73b0\u65b9\u6cd5 \u5e7f\u64ad\u4e0e\u591a\u64ad\u76f8\u540c\uff0c\u4e5f\u662f\u57fa\u4e8eUDP\u5b8c\u6210\u7684 \u5b9e\u73b0\u5e7f\u64ad\u6570\u636e\u7684Sender\u548cReceiver news_sender_brd.c news_receiver_brd.c Part2\u3001\u57fa\u4e8eLinux\u7684\u7f16\u7a0b\uff0815-18\uff09 chap15\u3001\u5957\u63a5\u5b57\u548c\u6807\u51c6I/O \u00b6 15.1\u3001\u6807\u51c6I/O\u51fd\u6570\u7684\u4f18\u70b9 \u00b6 \u6807\u51c6I/O\u51fd\u6570\u7684\u4e24\u4e2a\u4f18\u70b9\uff1a \u5177\u6709\u826f\u597d\u7684\u79fb\u690d\u6027\uff08Portability\uff09 \u53ef\u4ee5\u5229\u7528\u7f13\u51b2\u63d0\u9ad8\u6027\u80fd \u6807\u51c6I/O\u51fd\u6570\u548c\u7cfb\u7edf\u51fd\u6570\u4e4b\u95f4\u7684\u6027\u80fd\u5bf9\u6bd4 syscpy.c stdcpy.c \u6807\u51c6I/O\u51fd\u6570\u7684\u51e0\u4e2a\u7f3a\u70b9\uff1a \u4e0d\u5bb9\u6613\u8fdb\u884c\u53cc\u5411\u901a\u4fe1 \u6709\u65f6\u53ef\u80fd\u9891\u7e41\u8c03\u7528fflush\u51fd\u6570 \u9700\u8981\u4ee5FILE\u7ed3\u6784\u4f53\u6307\u9488\u7684\u5f62\u5f0f\u8fd4\u56de\u6587\u4ef6\u63cf\u8ff0\u7b26 15.2\u3001\u4f7f\u7528\u6807\u51c6I/O\u51fd\u6570 \u00b6 \u5229\u7528fdopen\u51fd\u6570\u8f6c\u6362\u4e3aFILE\u7ed3\u6784\u4f53\u6307\u9488 desto.c #include <stdio.h> FILE* fdopen(int fildes, const char *mode); \u5229\u7528fileno\u51fd\u6570\u8f6c\u6362\u4e3a\u6587\u4ef6\u63cf\u8ff0\u7b26 todes.c #include<stdio.h> int fileno(FILE* stream); 15.3\u3001\u57fa\u4e8e\u5957\u63a5\u5b57\u7684\u6807\u51c6I/O\u51fd\u6570\u4f7f\u7528 \u00b6 \u4e0echap4\u7684\u8fdb\u884c\u6bd4\u5bf9 echo_stdserv.c echo_client.c chap16\u3001\u5173\u4e8eI/O\u6d41\u5206\u79bb\u7684\u5176\u4ed6\u5185\u5bb9 \u00b6 16.1\u3001\u5206\u79bbI/O\u6d41 \u00b6 2\u6b21I/O\u6d41\u5206\u79bb chap10\u7684\u201cTCP I/O\u8fc7\u7a0b\uff08Routine\uff09\u5206\u79bb\u201d \u901a\u8fc7fork\u51fd\u6570\u590d\u5236\u51fa1\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u4ee5\u533a\u5206\u8f93\u5165\u548c\u8f93\u51fa\u4e2d\u4f7f\u7528\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26 chap15 \u901a\u8fc72\u6b21fdopen\u51fd\u6570\u7684\u8c03\u7528\uff0c\u521b\u5efa\u8bfb\u6a21\u5f0fFILE\u6307\u9488\u548c\u5199\u6a21\u5f0fFILE\u6307\u9488 \u5206\u79bb\u201c\u6d41\u201d\u7684\u597d\u5904 chap10\u5206\u79bb\u201c\u6d41\u201d\u7684\u76ee\u7684 \u901a\u8fc7\u5206\u5f00\u8f93\u5165\u8fc7\u7a0b\uff08\u4ee3\u7801\uff09\u548c\u8f93\u51fa\u8fc7\u7a0b\u964d\u4f4e\u5b9e\u73b0\u96be\u5ea6 \u4e0e\u8f93\u5165\u65e0\u5173\u7684\u8f93\u51fa\u64cd\u4f5c\u53ef\u4ee5\u63d0\u9ad8\u901f\u5ea6 chap15\u5206\u79bb\u201c\u6d41\u201d\u7684\u76ee\u7684 \u4e3a\u4e86\u5c06FILE\u6307\u9488\u6309\u8bfb\u6a21\u5f0f\u548c\u5199\u6a21\u5f0f\u52a0\u4ee5\u533a\u5206 \u53ef\u4ee5\u901a\u8fc7\u533a\u5206\u8bfb\u5199\u6a21\u5f0f\u964d\u4f4e\u5b9e\u73b0\u96be\u5ea6 \u901a\u8fc7\u533a\u5206I/O\u7f13\u51b2\u63d0\u9ad8\u7f13\u51b2\u6027\u80fd \u201c\u6d41\u201d\u5206\u79bb\u5e26\u6765\u7684EOF\u95ee\u9898 sep_serv.c sep_clnt.c 16.2\u3001\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u590d\u5236\u548c\u534a\u5173\u95ed \u00b6 \u7ec8\u6b62\u201c\u6d41\u201d\u65f6\u65e0\u6cd5\u534a\u5173\u95ed\u7684\u539f\u56e0 \u590d\u5236\u6587\u4ef6\u63cf\u8ff0\u7b26 dup&dup2 dup.c #include <unistd.h> int dup(int fides); int dup2(int fildes, int fildes2); \u590d\u5236\u6587\u4ef6\u63cf\u8ff0\u7b26\u540e\u201c\u6d41\u201d\u7684\u5206\u79bb sep_serv2.c chap17\u3001\u4f18\u4e8eselect\u7684epoll \u00b6 17.1\u3001epoll\u7406\u89e3\u53ca\u5e94\u7528 \u00b6 17.2\u3001\u6761\u4ef6\u89e6\u53d1\u548c\u8fb9\u7f18\u89e6\u53d1 \u00b6 \u6761\u4ef6\u89e6\u53d1\uff08Level Trigger\uff09\uff1a \u53ea\u8981\u8f93\u5165\u7f13\u51b2\u6709\u6570\u636e\uff0c\u5c31\u4f1a\u4e00\u76f4\u901a\u77e5\u8be5\u4e8b\u4ef6 \u3010\u54ea\u6015\u662f\u5269\u4f59\u6570\u636e\u3011 \u8fb9\u7f18\u89e6\u53d1\uff08Edge Trigger\uff09\uff1a \u8f93\u5165\u7f13\u51b2\u533a\u6536\u5230\u6570\u636e\u65f6\u4ec5\u6ce8\u518c1\u6b21\u8be5\u4e8b\u4ef6 \u3010\u54ea\u6015\u7f13\u51b2\u533a\uff0c\u8fd8\u7559\u6709\u6570\u636e\uff0c\u4e5f\u4e0d\u4f1a\u518d\u6ce8\u518c\u3011 chap18\u3001\u591a\u7ebf\u7a0b\u670d\u52a1\u5668\u7aef\u7684\u5b9e\u73b0 \u00b6 \u770b\u770b\u8fd8\u6709\u5565\u7ec6\u8282\uff0clionel 18.1\u3001\u7406\u89e3\u7ebf\u7a0b\u7684\u6982\u5ff5 \u00b6 18.2\u3001\u7ebf\u7a0b\u521b\u5efa\u53ca\u8fd0\u884c \u00b6 18.3\u3001\u7ebf\u7a0b\u5b58\u5728\u7684\u95ee\u9898\u548c\u4e34\u754c\u533a \u00b6 18.4\u3001\u7ebf\u7a0b\u540c\u6b65 \u00b6 18.5\u3001\u7ebf\u7a0b\u7684\u9500\u6bc1\u548c\u591a\u7ebf\u7a0b\u5e76\u53d1\u670d\u52a1\u5668\u7aef\u7684\u5b9e\u73b0 \u00b6 Part4\u3001\u7ed3\u675f\u7f51\u7edc\u7f16\u7a0b\uff0824-25\uff09 chap24\u3001\u5236\u4f5cHTTP\u670d\u52a1\u5668\u7aef \u00b6 24.1\u3001HTTP\u6458\u8981 \u00b6 \u7406\u89e3Web\u670d\u52a1\u5668\u7aef HTTP \u65e0\u72b6\u6001\u7684Stateless\u534f\u8bae \u8bf7\u6c42\u6d88\u606f\uff08Request Message\uff09\u7684\u7ed3\u6784 \u54cd\u5e94\u6d88\u606f\uff08Response Message\uff09\u7684\u7ed3\u6784 24.2\u3001\u5b9e\u73b0\u7b80\u5355\u7684Web\u670d\u52a1\u5668\u7aef \u00b6 \u5b9e\u73b0\u57fa\u4e8eLinux\u7684\u591a\u7ebf\u7a0bWeb\u670d\u52a1\u5668\u7aef 24.3\u3001\u4e60\u9898 \u00b6 chap25\u3001\u8fdb\u9636\u5185\u5bb9 \u00b6 25.1\u3001\u7f51\u7edc\u7f16\u7a0b\u5b66\u4e60\u7684\u5176\u4ed6\u5185\u5bb9 \u00b6 \u6210\u4e3a\u7f51\u7edc\u7a0b\u5e8f\u5458\u7684\u524d\u63d0\u662f\u6210\u4e3a\u7a0b\u5e8f\u5458 \u5bf9\u67d0\u4e00\u9886\u57df\u611f\u5174\u8da3 \u7f16\u5199\u8fd9\u4e9b\u7a0b\u5e8f\u65f6\u7684\u53c2\u8003\u4e66 \u5728\u7406\u8bba\u57fa\u7840\u4e0a\uff0c\u52a0\u5f3a\u7f16\u7a0b\u8bad\u7ec3 \u540e\u7eed\u5b66\u4e60\u5185\u5bb9 \u7cfb\u7edf\u7f16\u7a0b \u7684\u5b66\u4e60 25.2\u3001\u7f51\u7edc\u7f16\u7a0b\u76f8\u5173\u4e66\u7c4d\u4ecb\u7ecd \u00b6 \u7cfb\u7edf\u7f16\u7a0b\u76f8\u5173\u4e66\u7c4d \u300aAPUE\u300b\u5b66\u4e60\u65b9\u6cd5 1\u3001\u5feb\u901f\u9605\u8bfb\u4e3b\u8981\u5185\u5bb9\uff0c\u638c\u63e1\u5404\u79cd\u7cfb\u7edf\u7ea7\u522b\u7684\u51fd\u6570\uff0c\u6d4f\u89c8\u540e\u53ef\u4ee5\u53c2\u8003\u9700\u8981\u7684\u5730\u65b9 2\u3001 \u4ece\u5f00\u59cb\u5c31\u628a\u8fd9\u672c\u4e66\u5f53\u53c2\u8003\u4e66 \uff0c\u4f46\u524d\u63d0\u662f\u81ea\u5df1\u6709\u4e86\u4e00\u4e9b\u7cfb\u7edf\u7f16\u7a0b\u7ecf\u9a8c \u534f\u8bae\u76f8\u5173\u4e66\u7c4d \u300aTCP/IP\u534f\u8bae\u65cf\u300b","title":"\u300aTCP/IP\u7f51\u7edc\u7f16\u7a0b\u300b"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#tcpip","text":"Part01\u3001 Part01\u3001\u5f00\u59cb\u7f51\u7edc\u7f16\u7a0b\uff081-14\uff09","title":"\u300aTCP/IP\u7f51\u7edc\u7f16\u7a0b\u300b"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#chap1","text":"","title":"chap1\u3001\u7406\u89e3\u7f51\u7edc\u7f16\u7a0b\u548c\u5957\u63a5\u5b57"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#11","text":"\u63a5\u53d7\u8fde\u63a5\u8bf7\u6c42 \u3010\u5373\u670d\u52a1\u7aef\u3011\u7684TCP\u5957\u63a5\u5b57\u521b\u5efa\u8fc7\u7a0b 1\u3001\u8c03\u7528 socket() \u521b\u5efa\u5957\u63a5\u5b57 2\u3001\u8c03\u7528 bind() \u5206\u914dIP\u5730\u5740\u548c\u7aef\u53e3\u53f7 3\u3001\u8c03\u7528 listen() \u8f6c\u4e3a\u53ef\u63a5\u6536\u8bf7\u6c42\u72b6\u6001 4\u3001\u8c03\u7528 accept() \u53d7\u7406\u8fde\u63a5\u8bf7\u6c42 \u8bf7\u6c42\u8fde\u63a5 \u3010\u5373\u5ba2\u6237\u7aef\u3011\uff0cTCP 1\u3001\u8c03\u7528 socket() 2\u3001\u8c03\u7528 connect()","title":"1.1\u3001\u7406\u89e3\u7f51\u7edc\u7f16\u7a0b\u548c\u5957\u63a5\u5b57"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#12linux","text":"socket\u4f1a\u88ab\u8ba4\u4e3a\u662f\u6587\u4ef6\u7684\u4e00\u79cd \uff0c\u76f4\u63a5\u7528I/O\u64cd\u4f5c\u5373\u53ef\uff0c open()\u3001close()\u3001write() \u4e66\u4e0a\u63d0\u5230\u4e86 _t \u540e\u7f00\u7684\u6570\u636e\u7c7b\u578b \uff08\u4e00\u822c\u90fd\u662ftypedef\u58f0\u660e\u5f15\u8d77\u7684\uff09 fd\u662f\u5565\uff0c \u64cd\u4f5c\u7cfb\u7edf\u8fd4\u56de\u7684\u6574\u6570 \uff08\u4e5f\u5c31\u662f\u4e3a\u4e86\u65b9\u4fbf\u79f0\u547cOS\u521b\u5efa\u7684\u6587\u4ef6\u6216\u5957\u63a5\u5b57\u800c\u8d4b\u4e88\u7684\u6570\u800c\u5df2\uff09\uff0c \u53ef\u4ee5\u8fd9\u4e48\u8bb0\uff0c\u4f46\u662f\u903b\u8f91\u4e0d\u662f\u8fd9\u6837\uff0c\u56e0\u4e3a\u662f\u901a\u8fc7fd\u6574\u6570\u7684\u4e0b\u6807\uff0c\u53bb\u6570\u7ec4\u91cc\u627e\u5230\u4e86\u76f8\u5e94\u7684\u503c \u573a\u666f\u662f\uff0c\u6211\u60f3\u6253\u5370\u300aTCP/IP\u7f51\u7edc\u7f16\u7a0b\u300b\u768418-20\u9875\uff0c\u8bf4\u591a\u4e86\u53ef\u4ee5\u7b80\u5199\u4e3a\u6211\u60f3\u6253\u5370\u7f16\u53f710\u768418-20\u9875\u3002","title":"1.2\u3001\u57fa\u4e8eLinux\u7684\u6587\u4ef6\u64cd\u4f5c"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#chap2","text":"","title":"chap2\u3001\u5957\u63a5\u5b57\u7c7b\u578b\u4e0e\u534f\u8bae\u8bbe\u7f6e"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#21","text":"\u5173\u4e8e\u534f\u8bae \u5bf9\u8bdd\u4e2d\u4f7f\u7528\u7684\u901a\u4fe1\u89c4\u5219 \u534f\u8bae\u65cf\uff08Protocol Family\uff09 socket\u7684\u7b2c1\u4e2a\u53c2\u6570 sys/socket.h PF_INET \uff0cipv4 PF_PACKET \uff0c\u5e95\u5c42\u5957\u63a5\u5b57 \u5957\u63a5\u5b57\u7c7b\u578b\uff08type\uff09 \u5957\u63a5\u5b57\u7684\u6570\u636e\u4f20\u8f93\u65b9\u5f0f \uff0csocket\u7684\u7b2c2\u4e2a\u53c2\u6570 1\u3001\u9762\u5411\u8fde\u63a5\u7684\u5957\u63a5\u5b57\uff08SOCK_STREAM\uff09 \u4f20\u8f93\u8fc7\u7a0b\u4e2d\u6570\u636e\u4e0d\u4f1a\u6d88\u5931 \u6309\u5e8f\u4f20\u8f93\u6570\u636e \u4f20\u8f93\u7684\u6570\u636e\u4e0d\u5b58\u5728\u6570\u636e\u8fb9\u754c- lionel\uff0c\u8fd9\u4e2a\u5176\u5b9e\u6ca1\u592a\u7406\u89e3 2\u3001\u9762\u5411\u6d88\u606f\u7684\u5957\u63a5\u5b57\uff08SOCK_DGRAM\uff09 \u5f3a\u8c03\u5feb\u901f\u4f20\u8f93\u800c\u975e\u4f20\u8f93\u987a\u5e8f 39/421 \u534f\u8bae\u7684\u6700\u7ec8\u9009\u62e9 socket\u7684\u7b2c3\u4e2a\u53c2\u6570 \u4e00\u822c\u4e3a0\uff0c \u4f46 \u6570\u636e\u4f20\u8f93\u65b9\u5f0f\u76f8\u540c\uff0c\u534f\u8bae\u4e0d\u540c\uff0c\u9700\u8981\u7b2c3\u4e2a\u53c2\u6570\u6307\u5b9a \u3002\u3010\u540c\u4e00\u534f\u8bae\u65cf\u4e2d\u5b58\u5728\u591a\u4e2a\u6570\u636e\u4f20\u8f93\u65b9\u5f0f\u76f8\u540c\u7684\u534f\u8bae\u3011","title":"2.1\u3001\u5957\u63a5\u5b57\u534f\u8bae\u53ca\u5176\u6570\u636e\u4f20\u8f93\u7279\u6027"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#lionel","text":"socket() \u76843\u4e2a\u53c2\u6570\u8bb2\u89e3\uff0c\u77e5\u8bc6\u81ea\u5df1\u76f2\u533a\uff0c\u5230\u65f6\u8bd5\u4e0b man socket \u770b\u770b","title":"lionel\u6ce8\uff1a"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#chap3","text":"","title":"chap3\u3001\u5730\u5740\u65cf\u4e0e\u6570\u636e\u5e8f\u5217"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#31","text":"IP\u53ea\u5230\u4e3b\u673a\uff0cPort\u5230\u5e94\u7528\u7a0b\u5e8f","title":"3.1\u3001"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#32","text":"","title":"3.2\u3001\u5730\u5740\u4fe1\u606f\u7684\u8868\u793a"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#33","text":"\u3010\u8fd9\u90e8\u5206\u8981\u81ea\u5df1\u641c\u4e00\u4e0b\uff0c\u5927\u7aef\u5e8f\uff0c\u5c0f\u7aef\u5e8f\u3011","title":"3.3\u3001\u7f51\u7edc\u5b57\u8282\u5e8f\u4e0e\u5730\u5740\u53d8\u6362"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#34","text":"\u77e5\u8bc6\u5185\u5bb9\uff0c\u8fd8\u6ca1\u597d\u597d\u770b\uff0clionel\uff0c\u77e5\u8bc6\u76f2\u533a 56/421 struct sockaddr_in addr; memset(&addr, 0, sizeof(addr)); addr.sin_addr.s_addr = htonl(INADDR_ANY)); //**\u81ea\u52a8\u83b7\u53d6\u8fd0\u884c\u670d\u52a1\u5668\u7aef\u7684\u8ba1\u7b97\u673aIP\u5730\u5740**","title":"3.4\u3001\u7f51\u7edc\u5730\u5740\u7684\u521d\u59cb\u5316\u4e0e\u5206\u914d"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#chap4-5tcp","text":"","title":"chap4-5\u3001\u57fa\u4e8eTCP\u7684\u670d\u52a1\u7aef/\u5ba2\u6237\u7aef"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#41tcpudp","text":"IP\u5c42\u89e3\u51b3\u6570\u636e\u4f20\u8f93\u4e2d\u7684\u8def\u5f84\u9009\u62e9\u95ee\u9898\uff0cTCP\u5c42\u548cUDP\u5c42\u4ee5IP\u5c42\u63d0\u4f9b\u7684\u8def\u5f84\u4fe1\u606f\u4e3a\u57fa\u7840\u5b8c\u6210\u5b9e\u9645\u7684\u6570\u636e\u4f20\u8f93 \u3002","title":"4.1\u3001\u7406\u89e3TCP\u548cUDP"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#42tcp","text":"\u5c31\u662f \u672c\u7ae01.1+1.2 \uff0c\u5373\u8fde\u4e0a\u540e\u8fdb\u884c \u8bfb\u5199+\u5173\u95ed \u6df1\u5165\u4e86\u89e3\u4e00\u4e0baccept()\u7684\u7ec6\u8282\u95ee\u9898\uff0c \u4e3a\u5565\u8fd4\u56de\u7684fd\u80fd\u591f\u76f4\u63a5\u901a\u4fe1\uff0clionel \u4f1a\u5b58\u5728\u6240\u8c13\u7684\u201c\u60ca\u7fa4\u201d\u73b0\u8c61\uff0c\u9762\u8bd5\u4f1a\u4e0d\u4f1a\u8003\u5230\uff1f","title":"4.2\u3001\u5b9e\u73b0\u57fa\u4e8eTCP\u7684\u670d\u52a1\u5668\u7aef/\u5ba2\u6237\u7aef"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#43","text":"\u8fd9\u4e2a\u8981\u60f3\u4e00\u4e0b\u539f\u7406\uff0clionel \u8fed\u4ee3\u670d\u52a1\u5668\u7684\u4ee3\u7801 \u5b58\u5728\u7684\u95ee\u9898\uff0clionel \u3010TCP\u4e0d\u5b58\u5728\u6570\u636e\u8fb9\u754c\uff0cwrite()\u6bcf\u6b21\u4f20\u90121\u4e2a\u5b57\u7b26\u4e32\uff0c\u591a\u6b21\u8c03\u7528\u540e\uff0c\u5ba2\u6237\u7aef\u53ef\u80fd\u4f1a\u6536\u5230\u591a\u4e2a\u5b57\u7b26\u4e32\uff0c\u8fd9\u4e2a\u600e\u4e48\u9a8c\u8bc1\u4e0b\uff1f\u3011 87/421 \u56de\u58f0\uff08\u670d\u52a1\u5668\u7aef\u5c06\u5ba2\u6237\u7aef\u4f20\u8f93\u7684\u5b57\u7b26\u4e32\u6570\u636e\u539f\u5c01\u4e0d\u52a8\u5730\u4f20\u56de\u5ba2\u6237\u7aef\uff09","title":"4.3\u3001\u5b9e\u73b0\u8fed\u4ee3\u670d\u52a1\u5668\u7aef/\u5ba2\u6237\u7aef"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#51","text":"\u4e0d\u662f\u592a\u61c2\uff0clionel 92/421","title":"5.1\u3001\u56de\u58f0\u5ba2\u6237\u7aef\u7684\u5b8c\u7f8e\u8868\u73b0"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#52tcp","text":"\u4e09\u6b21\u63e1\u624b\uff08103/421\uff09 \u56db\u6b21\u6325\u624b\uff08106/421\uff09\uff0c \u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u90fd\u8981\u53d1\u9001 FIN","title":"5.2\u3001TCP\u539f\u7406"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#lionel_1","text":"\u8981\u8ba9\u6211 \u5b9e\u73b0\u8fed\u4ee3\u670d\u52a1\u5668\u7aef/\u5ba2\u6237\u7aef \uff0c\u6211\u4e5f\u4e0d\u4f1a","title":"lionel\u6ce8\uff1a"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#chap6udp","text":"\u8981\u8865\u5145\u5b8c\u5584\u4e00\u70b9 \uff0c\u76ee\u524d\u7b14\u8bb0\u4e0a\u90fd\u662f\u7a7a\uff0clionel","title":"chap6\u3001\u57fa\u4e8eUDP\u7684\u670d\u52a1\u7aef/\u5ba2\u6237\u7aef"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#chap7","text":"","title":"chap7\u3001\u4f18\u96c5\u7684\u65ad\u5f00\u5957\u63a5\u5b57\u8fde\u63a5"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#71tcp","text":"\u5355\u65b9\u9762\u65ad\u5f00\u8fde\u63a5\u5e26\u6765\u7684\u95ee\u9898 close() \u662f\u5b8c\u5168\u5173\u95ed\uff0c \u4e0d\u4ec5\u65e0\u6cd5\u4f20\u8f93\u6570\u636e\uff0c\u800c\u4e14\u4e5f\u4e0d\u80fd\u63a5\u6536\u6570\u636e \u3002 \u5957\u63a5\u5b57\u548c\u6d41\uff08stream\uff09 \u9488\u5bf9\u4f18\u96c5\u65ad\u5f00\u7684shutdown\u51fd\u6570 \u7b2c2\u4e2a\u53c2\u6570\u51b3\u5b9a\u65ad\u5f00\u8fde\u63a5\u7684\u65b9\u5f0f SHUT_RD\uff1a\u65ad\u5f00\u8f93\u5165\u6d41 SHUT_WR\uff1a\u65ad\u5f00\u8f93\u51fa\u6d41 SHUT_RDWR\uff1a\u540c\u65f6\u65ad\u5f00I/O\u6d41 #include<sys/socket.h> int shutdown(int sock, int howto); \u4e3a\u4f55\u9700\u8981\u534a\u5173\u95ed \u57fa\u4e8e\u534a\u5173\u95ed\u7684\u6587\u4ef6\u4f20\u8f93\u7a0b\u5e8f file_server.c file_client.c","title":"7.1\u3001\u57fa\u4e8eTCP\u7684\u534a\u5173\u95ed"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#chap8","text":"","title":"chap8\u3001\u57df\u540d\u53ca\u7f51\u7edc\u5730\u5740"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#81","text":"\u4ec0\u4e48\u662f\u57df\u540d DNS\u670d\u52a1\u5668","title":"8.1\u3001\u57df\u540d\u7cfb\u7edf"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#82ip","text":"\u7a0b\u5e8f\u4e2d\u6709\u5fc5\u8981\u4f7f\u7528\u57df\u540d\u5417\uff1f \u6240\u6709\u5b66\u4e60\u90fd\u8981\u5728\u5f00\u59cb\u524d\u8ba4\u8bc6\u5230\u5176\u5fc5\u8981\u6027 \u3002 \u5229\u7528\u57df\u540d\u83b7\u53d6IP\u5730\u5740 gethostbyname.c #include <netdb.h> struct hostent* gethostbyname(const char* hostname); struct hostent{ char* h_name; //\u5b98\u65b9\u57df\u540d char** h_aliases; //\u5176\u5b83\u57df\u540d int h_addrtype;//ipv4\u8fd8\u662fipv6 int h_length;//IP\u5730\u5740\u957f\u5ea6 char** h_addr_list;//\u4ee5\u6574\u6570\u5f62\u5f0f\u4fdd\u5b58\u57df\u540d\u5bf9\u5e94\u7684IP\u5730\u5740 } \u5229\u7528IP\u5730\u5740\u83b7\u53d6\u57df\u540d gethostbyaddr.c #include <netdb.h> struct hostent* gethostbyaddr(const char *addr, socklen_t len, int family);","title":"8.2\u3001IP\u5730\u5740\u548c\u57df\u540d\u4e4b\u95f4\u7684\u8f6c\u6362"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#chap9","text":"\uff08150/421\uff09\uff0c\u8fd9\u4e2a\u7b97\u6bd4\u8f83\u91cd\u70b9\u7684\u5730\u65b9\uff1flionel","title":"chap9\u3001\u5957\u63a5\u5b57\u7684\u591a\u79cd\u53ef\u9009\u9879"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#91io","text":"\u5957\u63a5\u5b57\u591a\u79cd\u53ef\u9009\u9879 \u534f\u8bae\u5c42 SOL_SOCKET IPPROTO_IP IPPROTO_TCP getsockopt&setsockopt sock_type.c #include<sys/socket.h> int getsockopt(int sock, int optname, void *optval, socklen_t *optlen); int setsockopt(int sock, int level, int optname, const void *optval, socklen_t *optlen); SO_SNDBUF&SO_RCVBUF SO_RCVBUF\uff1a\u8f93\u5165\u7f13\u51b2\u5927\u5c0f\u76f8\u5173\u53ef\u9009\u9879 SO_SNDBUF\uff1a\u8f93\u51fa\u7f13\u51b2\u5927\u5c0f\u76f8\u5173\u53ef\u9009\u9879 \u8fd92\u4e2a\u9009\u9879\u65e2\u53ef\u4ee5\u8bfb\u53d6\u5f53\u524dI/O\u7f13\u51b2\u5927\u5c0f\uff0c\u4e5f\u53ef\u4ee5\u8fdb\u884c\u66f4\u6539 \u3002 get_buf.c set_buf.c","title":"9.1\u3001\u5957\u63a5\u5b57\u53ef\u9009\u9879\u548cI/O\u7f13\u51b2\u5927\u5c0f"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#92so_reuseaddr","text":"0 \u5b66\u4e60SO_REUSEADDR\u53ef\u9009\u9879\u4e4b\u524d\uff0c\u5e94\u7406\u89e3\u597dTime-wait\u72b6\u6001 \u3002 \u53d1\u751f\u5730\u5740\u5206\u914d\u9519\u8bef\uff08Binding Error\uff09 reuseaddr_eserver.c Time-wait\u72b6\u6001 \u5148\u65ad\u5f00\u8fde\u63a5\u7684\uff08\u5148\u53d1\u9001FIN\u6d88\u606f\u7684\uff09\u5957\u63a5\u5b57\u5fc5\u7136\u4f1a\u7ecf\u8fc7Time-wait\u72b6\u6001 \u5982\u679c\u6ca1\u6709time-wait\u72b6\u6001\uff0c\uff08A\u53d1\u4e86FIN\u6ca1\u6709\u6536\u5230 B\u7684ACK\u540e\uff0c\u4f1a\u91cd\u53d1FIN\uff0c\u4f46B\u5df2\u7ecf\u4e0b\u7ebf\u4e86\uff09 158/421\uff0c\u8fd9\u90e8\u5206\u89e3\u91ca\u5f97\u6bd4\u8f83OK \u5730\u5740\u518d\u5206\u914d","title":"9.2\u3001SO_REUSEADDR"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#93tcp_nodelay","text":"Nagle\u7b97\u6cd5 \u7981\u7528Nagle\u7b97\u6cd5 \u5c06\u5957\u63a5\u5b57\u53ef\u9009\u9879TCP_NODELAY\u6539\u4e3a1\uff08\u771f\uff09 \u4e66\u4e0a\u8fd8\u6ca1\u770b\uff0c\u4e4b\u524d\u770b\u8fc7\u7f51\u7edc\u7b14\u8bb0\u4e0a\u7684","title":"9.3\u3001TCP_NODELAY"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#chap10","text":"lionel\uff0cIO\u5206\u6d41\uff0c\u6211\u786e\u5b9e\u6ca1\u61c2 \u3010routine\u3011","title":"chap10\u3001\u591a\u8fdb\u7a0b\u670d\u52a1\u5668\u7aef"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#101","text":"\u5e76\u53d1\u670d\u52a1\u5668\u7aef\u7684\u5b9e\u73b0\u65b9\u6cd5 \u591a\u8fdb\u7a0b\u670d\u52a1\u5668\uff1a\u901a\u8fc7\u521b\u5efa\u591a\u4e2a\u8fdb\u7a0b\u63d0\u4f9b\u670d\u52a1 \u591a\u8def\u590d\u8def\u670d\u52a1\u5668\uff1a\u901a\u8fc7\u6346\u7ed1\u5e76\u7edf\u4e00\u7ba1\u7406I/O\u5bf9\u8c61\u63d0\u4f9b\u670d\u52a1 \u591a\u7ebf\u7a0b\u670d\u52a1\u5668\uff1a\u901a\u8fc7\u751f\u6210\u4e0e\u5ba2\u6237\u7aef\u7b49\u91cf\u7684\u7ebf\u7a0b\u63d0\u4f9b\u670d\u52a1 \u7406\u89e3\u8fdb\u7a0b \u5360\u7528\u5185\u5b58\u7a7a\u95f4\u7684\u6b63\u5728\u8fd0\u884c\u7684\u7a0b\u5e8f \u901a\u8fc7\u8c03\u7528fork\u51fd\u6570\u521b\u5efa\u8fdb\u7a0b","title":"10.1\u3001\u8fdb\u7a0b\u6982\u5ff5\u53ca\u5e94\u7528"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#102","text":"\u50f5\u5c38\uff08Zombie\uff09\u8fdb\u7a0b \u5b8c\u6210\u5de5\u4f5c\u6ca1\u6709\u88ab\u9500\u6bc1\uff0c\u7ee7\u7eed\u5360\u7528\u7cfb\u7edf\u4e2d\u7684\u91cd\u8981\u8d44\u6e90 \u4ea7\u751f\u50f5\u5c38\u8fdb\u7a0b\u7684\u539f\u56e0 \u7236\u8fdb\u7a0b\u6ca1\u6709\u7ba1\u5b50\u8fdb\u7a0b \u9500\u6bc1\u50f5\u5c38\u8fdb\u7a0b1\uff1a\u5229\u7528wait\u51fd\u6570 \u9500\u6bc1\u50f5\u5c38\u8fdb\u7a0b2\uff1a\u5229\u7528waitpid\u51fd\u6570","title":"10.2\u3001\u8fdb\u7a0b\u548c\u50f5\u5c38\u8fdb\u7a0b"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#103","text":"\u5411\u64cd\u4f5c\u7cfb\u7edf\u6c42\u52a9 \u5173\u4e8eJAVA\u7684\u9898\u5916\u8bdd\uff1a\u4fdd\u6301\u5f00\u653e\u601d\u7ef4 \u4fe1\u53f7\u4e0esignal\u51fd\u6570 \u5229\u7528sigaction\u51fd\u6570\u8fdb\u884c\u4fe1\u53f7\u5904\u7406","title":"10.3\u3001\u4fe1\u53f7\u5904\u7406"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#104","text":"\u57fa\u4e8e\u8fdb\u7a0b\u7684\u5e76\u53d1\u670d\u52a1\u5668\u6a21\u578b \u56fe10-2\uff1a\u5e76\u53d1\u670d\u52a1\u5668\u6a21\u578b \uff08183/421\uff09 \u5b9e\u73b0\u5e76\u53d1\u670d\u52a1\u5668 \u901a\u8fc7fork\u51fd\u6570\u590d\u5236\u6587\u4ef6\u63cf\u8ff0\u7b26 lionel\uff0c\u4ee3\u7801\u770b\u4e00\u4e0b\u5148","title":"10.4\u3001\u57fa\u4e8e\u591a\u4efb\u52a1\u7684\u5e76\u53d1\u670d\u52a1\u5668"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#105tcpio","text":"\u5206\u5272I/O\u7a0b\u5e8f\u7684\u4f18\u70b9 \u56de\u58f0\u5ba2\u6237\u7aef\u7684I/O\u7a0b\u5e8f\u5206\u5272","title":"10.5\u3001\u5206\u5272TCP\u7684I/O\u7a0b\u5e8f"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#chap11","text":"","title":"chap11\u3001\u8fdb\u7a0b\u95f4\u901a\u4fe1"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#111","text":"\u5bf9\u8fdb\u7a0b\u95f4\u901a\u4fe1\u7684\u57fa\u672c\u6982\u5ff5 \u901a\u8fc7\u7ba1\u9053\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1","title":"11.1\u3001\u8fdb\u7a0b\u95f4\u901a\u4fe1\u7684\u57fa\u672c\u6982\u5ff5"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#112","text":"\u4fdd\u5b58\u6d88\u606f\u7684\u56de\u58f0\u670d\u52a1\u5668\u7aef \u5982\u679c\u60f3\u6784\u5efa\u66f4\u5927\u578b\u7684\u7a0b\u5e8f","title":"11.2\u3001\u8fd0\u7528\u8fdb\u7a0b\u95f4\u901a\u4fe1"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#chap12io","text":"","title":"chap12\u3001I/O\u590d\u7528"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#121io","text":"\u591a\u8fdb\u7a0b\u670d\u52a1\u5668\u7aef\u7684\u7f3a\u70b9\u548c\u89e3\u51b3\u65b9\u6cd5 \u7406\u89e3\u590d\u7528 \u5b9a\u4e49\uff1a 1\u3001\u57281\u4e2a\u901a\u4fe1\u9891\u9053\u4e2d\u4f20\u9012\u591a\u4e2a\u6570\u636e\uff08\u4fe1\u53f7\uff09\u7684\u6280\u672f 2\u3001\u4e3a\u4e86\u63d0\u9ad8\u7269\u7406\u8bbe\u5907\u7684\u6548\u7387\uff0c\u7528\u6700\u5c11\u7684\u7269\u7406\u8981\u7d20\u4f20\u9012\u6700\u591a\u6570\u636e\u65f6\u4f7f\u7528\u7684\u6280\u672f \u590d\u7528\u6280\u672f\u7684\u4f18\u70b9\uff1a \u51cf\u5c11\u8fde\u7ebf\u957f\u5ea6 \u51cf\u5c11\u7eb8\u676f\u4e2a\u6570 \u590d\u7528\u6280\u672f\u5728\u670d\u52a1\u5668\u7aef\u7684\u5e94\u7528","title":"12.1\u3001\u57fa\u4e8eI/O\u590d\u7528\u7684\u670d\u52a1\u5668\u7aef"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#122select","text":"select\u51fd\u6570\u7684\u529f\u80fd\u548c\u8c03\u7528\u987a\u5e8f \u8bbe\u7f6e\u6587\u4ef6\u63cf\u8ff0\u7b26 \u8bbe\u7f6e\u68c0\u67e5\uff08\u76d1\u89c6\uff09\u8303\u56f4\u53ca\u8d85\u65f6 \u8c03\u7528select\u51fd\u6570\u540e\u67e5\u770b\u7ed3\u679c \u4f7f\u7528select\u51fd\u6570\u65f6\u53ef\u4ee5\u5c06\u591a\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u96c6\u4e2d\u5230\u4e00\u8d77\u7edf\u4e00\u76d1\u89c6 \uff08\u5206\u62103\u79cd\u60c5\u51b5\uff1a\u63a5\u6536\u3001\u4f20\u8f93\u3001\u5f02\u5e38\uff09 FD_SET()","title":"12.2\u3001\u7406\u89e3select\u51fd\u6570\u5e76\u5b9e\u73b0\u670d\u52a1\u5668\u7aef"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#chap13io","text":"","title":"chap13\u3001\u591a\u79cdI/O\u51fd\u6570"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#131sendrecv","text":"Linux\u4e2d\u7684send&recv #include<sys/socket.h> ssize_t send(int sockfd, const void* buf, size_t nbytes, int flags); ssize_t recv(int sockfd, void *buf, size_t nbytes, int flags); MSG_OOB\uff1a\u53d1\u9001\u7d27\u6025\u6d88\u606f oob_send.c oob_recv.c \u7d27\u6025\u6a21\u5f0f\u5de5\u4f5c\u539f\u7406 \u68c0\u67e5\u8f93\u5165\u7f13\u51b2 peek_send.c peek_recv.c","title":"13.1\u3001send&amp;recv\u51fd\u6570"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#132readvwritev","text":"\u4f7f\u7528readv&writev\u51fd\u6570 writev.c readv.c #include<sys/uio.h> ssize_t writev(int filedes, const struct iovec* iov, int iovcnt); struct iovec{ void* iov_base; //\u7f13\u51b2\u5730\u5740 size_t iov_len; //\u7f13\u51b2\u5927\u5c0f } ssize_t readv(int filedes, const struct iovec *iov, int iovcnt); \u5408\u7406\u4f7f\u7528readv&writev\u51fd\u6570","title":"13.2\u3001readv&amp;writev\u51fd\u6570"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#chap14","text":"TCP\u662f\u4e00\u5bf9\u4e00\u7684\uff0c\u6240\u4ee5\u4e0d\u5b58\u5728\u5e7f\u64ad\u548c\u591a\u64ad\u3002","title":"chap14\u3001\u591a\u64ad\u4e0e\u5e7f\u64ad"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#141","text":"\u591a\u64ad\u7684\u6570\u636e\u4f20\u8f93\u65b9\u5f0f\u53ca\u6d41\u91cf\u65b9\u9762\u7684\u4f18\u70b9 \u8def\u7531\uff08Routing\uff09\u548cTTL\uff08Time to Live\uff1a\u751f\u5b58\u65f6\u95f4\uff09\uff0c\u4ee5\u53ca\u52a0\u5165\u7ec4\u7684\u65b9\u6cd5 \u5b9e\u73b0\u591a\u64adSender\u548cReceiver news_sender.c news_receiver.c 242/421\u4e2d\u7684\u4ee3\u7801\u8fc7\u7a0b\uff0c\u662fttl\u548c\u52a0\u5165\u7ec4\u7684\u65b9\u6cd5","title":"14.1\u3001\u591a\u64ad"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#142","text":"\u5e7f\u64ad\u7684\u7406\u89e3\u53ca\u5b9e\u73b0\u65b9\u6cd5 \u5e7f\u64ad\u4e0e\u591a\u64ad\u76f8\u540c\uff0c\u4e5f\u662f\u57fa\u4e8eUDP\u5b8c\u6210\u7684 \u5b9e\u73b0\u5e7f\u64ad\u6570\u636e\u7684Sender\u548cReceiver news_sender_brd.c news_receiver_brd.c Part2\u3001\u57fa\u4e8eLinux\u7684\u7f16\u7a0b\uff0815-18\uff09","title":"14.2\u3001\u5e7f\u64ad"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#chap15io","text":"","title":"chap15\u3001\u5957\u63a5\u5b57\u548c\u6807\u51c6I/O"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#151io","text":"\u6807\u51c6I/O\u51fd\u6570\u7684\u4e24\u4e2a\u4f18\u70b9\uff1a \u5177\u6709\u826f\u597d\u7684\u79fb\u690d\u6027\uff08Portability\uff09 \u53ef\u4ee5\u5229\u7528\u7f13\u51b2\u63d0\u9ad8\u6027\u80fd \u6807\u51c6I/O\u51fd\u6570\u548c\u7cfb\u7edf\u51fd\u6570\u4e4b\u95f4\u7684\u6027\u80fd\u5bf9\u6bd4 syscpy.c stdcpy.c \u6807\u51c6I/O\u51fd\u6570\u7684\u51e0\u4e2a\u7f3a\u70b9\uff1a \u4e0d\u5bb9\u6613\u8fdb\u884c\u53cc\u5411\u901a\u4fe1 \u6709\u65f6\u53ef\u80fd\u9891\u7e41\u8c03\u7528fflush\u51fd\u6570 \u9700\u8981\u4ee5FILE\u7ed3\u6784\u4f53\u6307\u9488\u7684\u5f62\u5f0f\u8fd4\u56de\u6587\u4ef6\u63cf\u8ff0\u7b26","title":"15.1\u3001\u6807\u51c6I/O\u51fd\u6570\u7684\u4f18\u70b9"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#152io","text":"\u5229\u7528fdopen\u51fd\u6570\u8f6c\u6362\u4e3aFILE\u7ed3\u6784\u4f53\u6307\u9488 desto.c #include <stdio.h> FILE* fdopen(int fildes, const char *mode); \u5229\u7528fileno\u51fd\u6570\u8f6c\u6362\u4e3a\u6587\u4ef6\u63cf\u8ff0\u7b26 todes.c #include<stdio.h> int fileno(FILE* stream);","title":"15.2\u3001\u4f7f\u7528\u6807\u51c6I/O\u51fd\u6570"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#153io","text":"\u4e0echap4\u7684\u8fdb\u884c\u6bd4\u5bf9 echo_stdserv.c echo_client.c","title":"15.3\u3001\u57fa\u4e8e\u5957\u63a5\u5b57\u7684\u6807\u51c6I/O\u51fd\u6570\u4f7f\u7528"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#chap16io","text":"","title":"chap16\u3001\u5173\u4e8eI/O\u6d41\u5206\u79bb\u7684\u5176\u4ed6\u5185\u5bb9"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#161io","text":"2\u6b21I/O\u6d41\u5206\u79bb chap10\u7684\u201cTCP I/O\u8fc7\u7a0b\uff08Routine\uff09\u5206\u79bb\u201d \u901a\u8fc7fork\u51fd\u6570\u590d\u5236\u51fa1\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u4ee5\u533a\u5206\u8f93\u5165\u548c\u8f93\u51fa\u4e2d\u4f7f\u7528\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26 chap15 \u901a\u8fc72\u6b21fdopen\u51fd\u6570\u7684\u8c03\u7528\uff0c\u521b\u5efa\u8bfb\u6a21\u5f0fFILE\u6307\u9488\u548c\u5199\u6a21\u5f0fFILE\u6307\u9488 \u5206\u79bb\u201c\u6d41\u201d\u7684\u597d\u5904 chap10\u5206\u79bb\u201c\u6d41\u201d\u7684\u76ee\u7684 \u901a\u8fc7\u5206\u5f00\u8f93\u5165\u8fc7\u7a0b\uff08\u4ee3\u7801\uff09\u548c\u8f93\u51fa\u8fc7\u7a0b\u964d\u4f4e\u5b9e\u73b0\u96be\u5ea6 \u4e0e\u8f93\u5165\u65e0\u5173\u7684\u8f93\u51fa\u64cd\u4f5c\u53ef\u4ee5\u63d0\u9ad8\u901f\u5ea6 chap15\u5206\u79bb\u201c\u6d41\u201d\u7684\u76ee\u7684 \u4e3a\u4e86\u5c06FILE\u6307\u9488\u6309\u8bfb\u6a21\u5f0f\u548c\u5199\u6a21\u5f0f\u52a0\u4ee5\u533a\u5206 \u53ef\u4ee5\u901a\u8fc7\u533a\u5206\u8bfb\u5199\u6a21\u5f0f\u964d\u4f4e\u5b9e\u73b0\u96be\u5ea6 \u901a\u8fc7\u533a\u5206I/O\u7f13\u51b2\u63d0\u9ad8\u7f13\u51b2\u6027\u80fd \u201c\u6d41\u201d\u5206\u79bb\u5e26\u6765\u7684EOF\u95ee\u9898 sep_serv.c sep_clnt.c","title":"16.1\u3001\u5206\u79bbI/O\u6d41"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#162","text":"\u7ec8\u6b62\u201c\u6d41\u201d\u65f6\u65e0\u6cd5\u534a\u5173\u95ed\u7684\u539f\u56e0 \u590d\u5236\u6587\u4ef6\u63cf\u8ff0\u7b26 dup&dup2 dup.c #include <unistd.h> int dup(int fides); int dup2(int fildes, int fildes2); \u590d\u5236\u6587\u4ef6\u63cf\u8ff0\u7b26\u540e\u201c\u6d41\u201d\u7684\u5206\u79bb sep_serv2.c","title":"16.2\u3001\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u590d\u5236\u548c\u534a\u5173\u95ed"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#chap17selectepoll","text":"","title":"chap17\u3001\u4f18\u4e8eselect\u7684epoll"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#171epoll","text":"","title":"17.1\u3001epoll\u7406\u89e3\u53ca\u5e94\u7528"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#172","text":"\u6761\u4ef6\u89e6\u53d1\uff08Level Trigger\uff09\uff1a \u53ea\u8981\u8f93\u5165\u7f13\u51b2\u6709\u6570\u636e\uff0c\u5c31\u4f1a\u4e00\u76f4\u901a\u77e5\u8be5\u4e8b\u4ef6 \u3010\u54ea\u6015\u662f\u5269\u4f59\u6570\u636e\u3011 \u8fb9\u7f18\u89e6\u53d1\uff08Edge Trigger\uff09\uff1a \u8f93\u5165\u7f13\u51b2\u533a\u6536\u5230\u6570\u636e\u65f6\u4ec5\u6ce8\u518c1\u6b21\u8be5\u4e8b\u4ef6 \u3010\u54ea\u6015\u7f13\u51b2\u533a\uff0c\u8fd8\u7559\u6709\u6570\u636e\uff0c\u4e5f\u4e0d\u4f1a\u518d\u6ce8\u518c\u3011","title":"17.2\u3001\u6761\u4ef6\u89e6\u53d1\u548c\u8fb9\u7f18\u89e6\u53d1"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#chap18","text":"\u770b\u770b\u8fd8\u6709\u5565\u7ec6\u8282\uff0clionel","title":"chap18\u3001\u591a\u7ebf\u7a0b\u670d\u52a1\u5668\u7aef\u7684\u5b9e\u73b0"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#181","text":"","title":"18.1\u3001\u7406\u89e3\u7ebf\u7a0b\u7684\u6982\u5ff5"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#182","text":"","title":"18.2\u3001\u7ebf\u7a0b\u521b\u5efa\u53ca\u8fd0\u884c"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#183","text":"","title":"18.3\u3001\u7ebf\u7a0b\u5b58\u5728\u7684\u95ee\u9898\u548c\u4e34\u754c\u533a"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#184","text":"","title":"18.4\u3001\u7ebf\u7a0b\u540c\u6b65"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#185","text":"Part4\u3001\u7ed3\u675f\u7f51\u7edc\u7f16\u7a0b\uff0824-25\uff09","title":"18.5\u3001\u7ebf\u7a0b\u7684\u9500\u6bc1\u548c\u591a\u7ebf\u7a0b\u5e76\u53d1\u670d\u52a1\u5668\u7aef\u7684\u5b9e\u73b0"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#chap24http","text":"","title":"chap24\u3001\u5236\u4f5cHTTP\u670d\u52a1\u5668\u7aef"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#241http","text":"\u7406\u89e3Web\u670d\u52a1\u5668\u7aef HTTP \u65e0\u72b6\u6001\u7684Stateless\u534f\u8bae \u8bf7\u6c42\u6d88\u606f\uff08Request Message\uff09\u7684\u7ed3\u6784 \u54cd\u5e94\u6d88\u606f\uff08Response Message\uff09\u7684\u7ed3\u6784","title":"24.1\u3001HTTP\u6458\u8981"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#242web","text":"\u5b9e\u73b0\u57fa\u4e8eLinux\u7684\u591a\u7ebf\u7a0bWeb\u670d\u52a1\u5668\u7aef","title":"24.2\u3001\u5b9e\u73b0\u7b80\u5355\u7684Web\u670d\u52a1\u5668\u7aef"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#243","text":"","title":"24.3\u3001\u4e60\u9898"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#chap25","text":"","title":"chap25\u3001\u8fdb\u9636\u5185\u5bb9"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#251","text":"\u6210\u4e3a\u7f51\u7edc\u7a0b\u5e8f\u5458\u7684\u524d\u63d0\u662f\u6210\u4e3a\u7a0b\u5e8f\u5458 \u5bf9\u67d0\u4e00\u9886\u57df\u611f\u5174\u8da3 \u7f16\u5199\u8fd9\u4e9b\u7a0b\u5e8f\u65f6\u7684\u53c2\u8003\u4e66 \u5728\u7406\u8bba\u57fa\u7840\u4e0a\uff0c\u52a0\u5f3a\u7f16\u7a0b\u8bad\u7ec3 \u540e\u7eed\u5b66\u4e60\u5185\u5bb9 \u7cfb\u7edf\u7f16\u7a0b \u7684\u5b66\u4e60","title":"25.1\u3001\u7f51\u7edc\u7f16\u7a0b\u5b66\u4e60\u7684\u5176\u4ed6\u5185\u5bb9"},{"location":"10network/TCPIP%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#252","text":"\u7cfb\u7edf\u7f16\u7a0b\u76f8\u5173\u4e66\u7c4d \u300aAPUE\u300b\u5b66\u4e60\u65b9\u6cd5 1\u3001\u5feb\u901f\u9605\u8bfb\u4e3b\u8981\u5185\u5bb9\uff0c\u638c\u63e1\u5404\u79cd\u7cfb\u7edf\u7ea7\u522b\u7684\u51fd\u6570\uff0c\u6d4f\u89c8\u540e\u53ef\u4ee5\u53c2\u8003\u9700\u8981\u7684\u5730\u65b9 2\u3001 \u4ece\u5f00\u59cb\u5c31\u628a\u8fd9\u672c\u4e66\u5f53\u53c2\u8003\u4e66 \uff0c\u4f46\u524d\u63d0\u662f\u81ea\u5df1\u6709\u4e86\u4e00\u4e9b\u7cfb\u7edf\u7f16\u7a0b\u7ecf\u9a8c \u534f\u8bae\u76f8\u5173\u4e66\u7c4d \u300aTCP/IP\u534f\u8bae\u65cf\u300b","title":"25.2\u3001\u7f51\u7edc\u7f16\u7a0b\u76f8\u5173\u4e66\u7c4d\u4ecb\u7ecd"},{"location":"11filesystem/Linux%E5%86%85%E6%A0%B8%E6%8E%A2%E7%A7%98/","text":"chap2\u3001\u6587\u4ef6\u7cfb\u7edf 12\uff0824/232\uff09 \u00b6 2.1\u3001\u6587\u4ef6\u7cfb\u7edf\u7684\u57fa\u672c\u6982\u5ff5 \u00b6 2.1.1\u3001\u4ec0\u4e48\u662fVFS \u00b6 VFS\u672c\u8eab\u53ea\u5b58\u5728\u4e8e\u5185\u5b58\u4e2d \uff0c\u5b83\u9700\u8981\u5c06\u786c\u76d8\u4e0a\u7684\u6587\u4ef6\u7cfb\u7edf\u62bd\u8c61\u5230\u5185\u5b58\u4e2d\uff0c\u901a\u8fc7\u51e0\u4e2a \u91cd\u8981\u7684\u7ed3\u6784 \uff08 dentry\u3001inode\u3001super_block \uff09 2.1.2\u3001\u8d85\u7ea7\u5757super_block \u00b6 \u4ee3\u8868\u4e86 \u6574\u4e2a\u6587\u4ef6\u7cfb\u7edf\u672c\u8eab \uff0c \u7ed9\u51fa\u4e86\u6587\u4ef6\u7cfb\u7edf\u7684\u5168\u5c40\u4fe1\u606f \u5305\u542b\u4e00\u4e9b\u51fd\u6570\u6307\u9488 2.1.3\u3001\u76ee\u5f55\u9879dentry \u00b6 \u76ee\u5f55\u9879\u53cd\u6620\u4e86\u6587\u4ef6\u7cfb\u7edf\u7684\u8fd9\u79cd\u6811\u72b6\u5173\u7cfb 2.1.4\u3001\u7d22\u5f15\u8282\u70b9inode \u00b6 inode\u4ee3\u8868\u4e00\u4e2a\u6587\u4ef6 2.1.5\u3001\u6587\u4ef6 \u00b6 \u6587\u4ef6\u5bf9\u8c61\u7684\u4f5c\u7528\u662f \u63cf\u8ff0\u8fdb\u7a0b\u548c\u6587\u4ef6\u4ea4\u4e92\u7684\u5173\u7cfb \u3002 \u3010 \u6587\u4ef6\u5bf9\u8c61 \u6307\u7684\u662f\u5185\u5b58\u4e2d\u7684\u6587\u4ef6\u3011 \u8fdb\u7a0b\u6253\u5f00\u4e00\u4e2a\u6587\u4ef6\uff0c\u5185\u6838\u5c31\u52a8\u6001\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\u5bf9\u8c61\u3002\u540c\u4e00\u4e2a\u6587\u4ef6\uff0c\u5728\u4e0d\u540c\u7684\u8fdb\u7a0b\u4e2d\u6709\u4e0d\u540c\u7684\u6587\u4ef6\u5bf9\u8c61\u3002 2.2\u3001\u6587\u4ef6\u7cfb\u7edf\u7684\u67b6\u6784 \u00b6 2.2.1\u3001\u8d85\u7ea7\u5757\u4f5c\u7528\u5206\u6790 \u00b6 2.2.2\u3001dentry\u4f5c\u7528\u5206\u6790 \u00b6 2.2.3\u3001inode\u4f5c\u7528\u5206\u6790 \u00b6 \u7cfb\u7edf\u5185\u6838\u63d0\u4f9b\u4e86\u4e00\u4e2ahash\u94fe\u8868\u6570\u7ec4 inode_hashtable inode\u8fd8\u6709\u4e00\u4e2a\u91cd\u8981\u7528\u4f5c\u7528\u662f \u7f13\u5b58\u6587\u4ef6\u7684\u6570\u636e\u5185\u5bb9 \uff0c\u901a\u8fc7\u6210\u5458 i_mapping \u5b9e\u73b0\u7684\u3002 2.2.4\u3001\u6587\u4ef6\u4f5c\u7528\u5206\u6790 \u00b6 2.3\u3001\u4ece\u4ee3\u7801\u5c42\u6b21\u6df1\u5165\u5206\u6790\u6587\u4ef6\u7cfb\u7edf \u00b6 2.3.1\u3001\u4e00\u4e2a\u6700\u7b80\u5355\u7684\u6587\u4ef6\u7cfb\u7edfaufs \u00b6 #include <linux/moudle.h> #include <linux/fs.h> #include <linux/pagemap.h> #include <linux/mount.h> #include <linut/init.h> #include <linux/nami.h> #define AUFS_MAIGC 0x64668735 static struct vfsmount* aufs_mount; static int aufs_mount_count; static struct inode* aufs_get_inode(struct super_block* sb, int mode, dev_t dev) { struct inode* inode = new_inode(sb); if (inode) { inode->i_mode = mode; inode->i_uid = current->fsuid; inode->i_gid = current->fsgid; inode->i_blksize = PAGE_CACHE_SIZE; inode->i_blocks = 0; inode->i_atime = inode->i_mtime = inode->i_ctime = CURRENT_TIME; switch (mode & S_IFMT) { default: int_special_inode(inode, mode, dev); break; case S_IFREG: printk(\"create a file \\n\"); break; case S_IFDIR: inode->i_op = &simple_dir_inode_operations; inode->i_fop = &simple_dir_operations; printk(\"create a dir file \\n\"); inode->i_nlink++; break; } } return inode; } //SMP-safe static int aufs_mknod(struct inode* dir, struct dentry* dentry, int mode, dev_t dev) { struct inode* inode; int error = -EPERM; if (dentry->d_inode) return -EEXIST; inode = aufs_get_inode(dir->i_sb, mode, dev); if (inode) { d_instantiate(dentry, inode); dget(dentry); error = 0; } return error; } static int aufs_mkdir(struct inode* dir, struct dentry* dentry, int mode) { int res; res = aufs_mknode(dir, dentry, mode | S_IFDIR, 0); if (!res) dir->i_nlink++; return res; } static int aufs_create(struct inode* dir, struct dentry* dentry, int mode) { return aufs_mknode(dir, entry, mode | S_IFREG, 0); } static int aufs_fill_super(struct super_block* sb, void* data, int silent) { static struct tree_descr debug_files[] = { {\"\"} }; return simple_fill_super(sb, AUFS_MAIGC, debug_files);//lionel\uff0c\u4e5f\u662f\u7cfb\u7edf\u63d0\u4f9b\u7684\u554a\uff0c\u8fd8\u662ffs\u76ee\u5f55\u4e0blibfs.c\u4e2d\u7684 } static struct super_block* aufs_get_sb(struct file_system_type* fs_type, int flags, const char* dev_name, void* data) { return get_sb_single(fs_type, flags, data, aufs_fill_super); } static struct file_system_type au_fs_type = { .owner = THIS_MODULE, .name = \"aufs\", .get_sb = aufs_get_sb, .kill_sb = kill_litter_super, }; static int aufs_create_by_name(const char* name, mode_t mode, struct dentry* parent, struct dentry** dentry) { int error = 0; /* If the parent is not specified, we create it in the root. * We need the root dentry to do this, which is in the super * block. A pointer to that is in the struct vfsmount that we * have around. */ if (!parent) { if (aufs_mount && aufs_mount->mnt_sb) { parent = aufs_mount->mnt_sb->s_root; } } if (!parent) { printk(\"Ah! can not find a parent!\\n\"); return -EFAULT; } *dentry = NULL; mutex_lock(&parent->d_inode->i_mutex); &dentry = lookup_one_len(name, parent, strlen(name)); if (!IS_ERR(dentry)) { if ((mode & S_IFMT) == S_IFDIR) error = aufs_mkdir(parent->d_inode, *dentry, mode); else error = aufs_create(parent->d_inode, *dentry, mode); } else error = PTR_ERR(dentry); mutex_unlock(&parent->d_inode->i_mutex); return error; } struct dentry* aufs_create_file(const char* name, mode_t mode, struct dentry* parent, void* data, struct file_operations* fops) { struct dentry* dentry = NULL; int error; printk(\"aufs: creating file '%s'\\n\", name); error = aufs_create_by_name(name, mode, parent, &dentry); if (error) { dentry = NULL; goto exit; } if (dentry->d_inode) { if (data) dentry->d_inode->u.generic_ip = data; if (fops) dentry->d_inode->i_fop = fops; } exit: return dentry; } struct dentry* aufs_create_dir(const char* name, struct dentry* parent) { return aufs_create_file(name, S_IFDIR | S_IRWXU | S_IRUGO | S_IXUGO, parent, NULL, NULL); } static int __init aufs_init(void) { int retval; struct dentry* pslot; retval = register_filesystem(&au_fs_type); if (!retval) { aufs_mount = kern_mount(&au_fs_type); //lionel\uff0ckern_mount()\u3010\u8fd9\u4e2a\u5728super.c\u4e2d\u3011\u4e0edo_mount()\u3010\u8fd9\u4e2a\u5728fs\u91cc\u7684namespace.c\u4e2d\u3011\u6709\u5173\u8054\u4e0d\uff1f if (IS_ERROR(aufs_mount)) { printk(KERN_ERR \"aufs: could not mount!\\n\"); unregister_filesystem(&au_fs_type); return retval; } } pslot = aufs_create_dir(\"woman star\", NULL); aufs_create_file(\"lbb\", S_IFREG | S_IRUGO, pslot, NULL, NULL); aufs_create_file(\"fbb\", S_IFREG | S_IRUGO, pslot, NULL, NULL); aufs_create_file(\"ljl\", S_IFREG | S_IRUGO, pslot, NULL, NULL); pslot = aufs_create_dir(\"man star\", NULL); aufs_create_file(\"ldh\", S_IFREG | S_IRUGO, pslot, NULL, NULL); aufs_create_file(\"lcw\", S_IFREG | S_IRUGO, pslot, NULL, NULL); aufs_create_file(\"jw\", S_IFREG | S_IRUGO, pslot, NULL, NULL); return retval; } static void __exit aufs_exit(void) { simple_release_fs(&aufs_mount, &aufs_mount_count); unregister_filesystem(&au_fs_type); } module_init(aufs_init); module_exit(aufs_exit); MODULE_LICENSE(\"GPL\"); MOUDLE_DESCRIPTION(\"This is a simple module\"); MODULE_VERSION(\"Ver 0.1\"); /* * mkdir au * mount -t aufs none /au * ls */ 2.3.2\u3001\u6587\u4ef6\u7cfb\u7edf\u5982\u4f55\u7ba1\u7406\u76ee\u5f55\u548c\u6587\u4ef6 \u00b6 \u4ee3\u7801\u4e09\u90e8\u5206 1\uff09 register_filesystem \u51fd\u6570\uff0c\u628aaufs\u6587\u4ef6\u7cfb\u7edf\u767b\u8bb0\u5230\u7cfb\u7edf 2\uff09\u8c03\u7528 kern_mount \u51fd\u6570\u4e3a\u6587\u4ef6\u7cfb\u7edf\u7533\u8bf7\u5fc5\u5907\u7684\u6570\u636e\u7ed3\u6784 3\uff09\u6700\u540e\u5728aufs\u6587\u4ef6\u7cfb\u7edf\u5185\u521b\u5efa\u4e24\u76ee\u5f55\uff0c\u6bcf\u4e2a\u76ee\u5f55\u4e0b\u9762\u521b\u5efa3\u4e2a\u6587\u4ef6 2.3.3\u3001\u6587\u4ef6\u7cfb\u7edf\u7684\u6302\u8f7d\u8fc7\u7a0b \u00b6 2.3.4\u3001\u6587\u4ef6\u6253\u5f00\u7684\u4ee3\u7801\u5206\u6790 \u00b6 2.4\u3001\u672c\u7ae0\u5c0f\u7ed3 \u00b6","title":"\u300aLinux\u5185\u6838\u63a2\u79d8\u300b"},{"location":"11filesystem/Linux%E5%86%85%E6%A0%B8%E6%8E%A2%E7%A7%98/#chap2-1224232","text":"","title":"chap2\u3001\u6587\u4ef6\u7cfb\u7edf   12\uff0824/232\uff09"},{"location":"11filesystem/Linux%E5%86%85%E6%A0%B8%E6%8E%A2%E7%A7%98/#21","text":"","title":"2.1\u3001\u6587\u4ef6\u7cfb\u7edf\u7684\u57fa\u672c\u6982\u5ff5"},{"location":"11filesystem/Linux%E5%86%85%E6%A0%B8%E6%8E%A2%E7%A7%98/#211vfs","text":"VFS\u672c\u8eab\u53ea\u5b58\u5728\u4e8e\u5185\u5b58\u4e2d \uff0c\u5b83\u9700\u8981\u5c06\u786c\u76d8\u4e0a\u7684\u6587\u4ef6\u7cfb\u7edf\u62bd\u8c61\u5230\u5185\u5b58\u4e2d\uff0c\u901a\u8fc7\u51e0\u4e2a \u91cd\u8981\u7684\u7ed3\u6784 \uff08 dentry\u3001inode\u3001super_block \uff09","title":"2.1.1\u3001\u4ec0\u4e48\u662fVFS"},{"location":"11filesystem/Linux%E5%86%85%E6%A0%B8%E6%8E%A2%E7%A7%98/#212super_block","text":"\u4ee3\u8868\u4e86 \u6574\u4e2a\u6587\u4ef6\u7cfb\u7edf\u672c\u8eab \uff0c \u7ed9\u51fa\u4e86\u6587\u4ef6\u7cfb\u7edf\u7684\u5168\u5c40\u4fe1\u606f \u5305\u542b\u4e00\u4e9b\u51fd\u6570\u6307\u9488","title":"2.1.2\u3001\u8d85\u7ea7\u5757super_block"},{"location":"11filesystem/Linux%E5%86%85%E6%A0%B8%E6%8E%A2%E7%A7%98/#213dentry","text":"\u76ee\u5f55\u9879\u53cd\u6620\u4e86\u6587\u4ef6\u7cfb\u7edf\u7684\u8fd9\u79cd\u6811\u72b6\u5173\u7cfb","title":"2.1.3\u3001\u76ee\u5f55\u9879dentry"},{"location":"11filesystem/Linux%E5%86%85%E6%A0%B8%E6%8E%A2%E7%A7%98/#214inode","text":"inode\u4ee3\u8868\u4e00\u4e2a\u6587\u4ef6","title":"2.1.4\u3001\u7d22\u5f15\u8282\u70b9inode"},{"location":"11filesystem/Linux%E5%86%85%E6%A0%B8%E6%8E%A2%E7%A7%98/#215","text":"\u6587\u4ef6\u5bf9\u8c61\u7684\u4f5c\u7528\u662f \u63cf\u8ff0\u8fdb\u7a0b\u548c\u6587\u4ef6\u4ea4\u4e92\u7684\u5173\u7cfb \u3002 \u3010 \u6587\u4ef6\u5bf9\u8c61 \u6307\u7684\u662f\u5185\u5b58\u4e2d\u7684\u6587\u4ef6\u3011 \u8fdb\u7a0b\u6253\u5f00\u4e00\u4e2a\u6587\u4ef6\uff0c\u5185\u6838\u5c31\u52a8\u6001\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\u5bf9\u8c61\u3002\u540c\u4e00\u4e2a\u6587\u4ef6\uff0c\u5728\u4e0d\u540c\u7684\u8fdb\u7a0b\u4e2d\u6709\u4e0d\u540c\u7684\u6587\u4ef6\u5bf9\u8c61\u3002","title":"2.1.5\u3001\u6587\u4ef6"},{"location":"11filesystem/Linux%E5%86%85%E6%A0%B8%E6%8E%A2%E7%A7%98/#22","text":"","title":"2.2\u3001\u6587\u4ef6\u7cfb\u7edf\u7684\u67b6\u6784"},{"location":"11filesystem/Linux%E5%86%85%E6%A0%B8%E6%8E%A2%E7%A7%98/#221","text":"","title":"2.2.1\u3001\u8d85\u7ea7\u5757\u4f5c\u7528\u5206\u6790"},{"location":"11filesystem/Linux%E5%86%85%E6%A0%B8%E6%8E%A2%E7%A7%98/#222dentry","text":"","title":"2.2.2\u3001dentry\u4f5c\u7528\u5206\u6790"},{"location":"11filesystem/Linux%E5%86%85%E6%A0%B8%E6%8E%A2%E7%A7%98/#223inode","text":"\u7cfb\u7edf\u5185\u6838\u63d0\u4f9b\u4e86\u4e00\u4e2ahash\u94fe\u8868\u6570\u7ec4 inode_hashtable inode\u8fd8\u6709\u4e00\u4e2a\u91cd\u8981\u7528\u4f5c\u7528\u662f \u7f13\u5b58\u6587\u4ef6\u7684\u6570\u636e\u5185\u5bb9 \uff0c\u901a\u8fc7\u6210\u5458 i_mapping \u5b9e\u73b0\u7684\u3002","title":"2.2.3\u3001inode\u4f5c\u7528\u5206\u6790"},{"location":"11filesystem/Linux%E5%86%85%E6%A0%B8%E6%8E%A2%E7%A7%98/#224","text":"","title":"2.2.4\u3001\u6587\u4ef6\u4f5c\u7528\u5206\u6790"},{"location":"11filesystem/Linux%E5%86%85%E6%A0%B8%E6%8E%A2%E7%A7%98/#23","text":"","title":"2.3\u3001\u4ece\u4ee3\u7801\u5c42\u6b21\u6df1\u5165\u5206\u6790\u6587\u4ef6\u7cfb\u7edf"},{"location":"11filesystem/Linux%E5%86%85%E6%A0%B8%E6%8E%A2%E7%A7%98/#231aufs","text":"#include <linux/moudle.h> #include <linux/fs.h> #include <linux/pagemap.h> #include <linux/mount.h> #include <linut/init.h> #include <linux/nami.h> #define AUFS_MAIGC 0x64668735 static struct vfsmount* aufs_mount; static int aufs_mount_count; static struct inode* aufs_get_inode(struct super_block* sb, int mode, dev_t dev) { struct inode* inode = new_inode(sb); if (inode) { inode->i_mode = mode; inode->i_uid = current->fsuid; inode->i_gid = current->fsgid; inode->i_blksize = PAGE_CACHE_SIZE; inode->i_blocks = 0; inode->i_atime = inode->i_mtime = inode->i_ctime = CURRENT_TIME; switch (mode & S_IFMT) { default: int_special_inode(inode, mode, dev); break; case S_IFREG: printk(\"create a file \\n\"); break; case S_IFDIR: inode->i_op = &simple_dir_inode_operations; inode->i_fop = &simple_dir_operations; printk(\"create a dir file \\n\"); inode->i_nlink++; break; } } return inode; } //SMP-safe static int aufs_mknod(struct inode* dir, struct dentry* dentry, int mode, dev_t dev) { struct inode* inode; int error = -EPERM; if (dentry->d_inode) return -EEXIST; inode = aufs_get_inode(dir->i_sb, mode, dev); if (inode) { d_instantiate(dentry, inode); dget(dentry); error = 0; } return error; } static int aufs_mkdir(struct inode* dir, struct dentry* dentry, int mode) { int res; res = aufs_mknode(dir, dentry, mode | S_IFDIR, 0); if (!res) dir->i_nlink++; return res; } static int aufs_create(struct inode* dir, struct dentry* dentry, int mode) { return aufs_mknode(dir, entry, mode | S_IFREG, 0); } static int aufs_fill_super(struct super_block* sb, void* data, int silent) { static struct tree_descr debug_files[] = { {\"\"} }; return simple_fill_super(sb, AUFS_MAIGC, debug_files);//lionel\uff0c\u4e5f\u662f\u7cfb\u7edf\u63d0\u4f9b\u7684\u554a\uff0c\u8fd8\u662ffs\u76ee\u5f55\u4e0blibfs.c\u4e2d\u7684 } static struct super_block* aufs_get_sb(struct file_system_type* fs_type, int flags, const char* dev_name, void* data) { return get_sb_single(fs_type, flags, data, aufs_fill_super); } static struct file_system_type au_fs_type = { .owner = THIS_MODULE, .name = \"aufs\", .get_sb = aufs_get_sb, .kill_sb = kill_litter_super, }; static int aufs_create_by_name(const char* name, mode_t mode, struct dentry* parent, struct dentry** dentry) { int error = 0; /* If the parent is not specified, we create it in the root. * We need the root dentry to do this, which is in the super * block. A pointer to that is in the struct vfsmount that we * have around. */ if (!parent) { if (aufs_mount && aufs_mount->mnt_sb) { parent = aufs_mount->mnt_sb->s_root; } } if (!parent) { printk(\"Ah! can not find a parent!\\n\"); return -EFAULT; } *dentry = NULL; mutex_lock(&parent->d_inode->i_mutex); &dentry = lookup_one_len(name, parent, strlen(name)); if (!IS_ERR(dentry)) { if ((mode & S_IFMT) == S_IFDIR) error = aufs_mkdir(parent->d_inode, *dentry, mode); else error = aufs_create(parent->d_inode, *dentry, mode); } else error = PTR_ERR(dentry); mutex_unlock(&parent->d_inode->i_mutex); return error; } struct dentry* aufs_create_file(const char* name, mode_t mode, struct dentry* parent, void* data, struct file_operations* fops) { struct dentry* dentry = NULL; int error; printk(\"aufs: creating file '%s'\\n\", name); error = aufs_create_by_name(name, mode, parent, &dentry); if (error) { dentry = NULL; goto exit; } if (dentry->d_inode) { if (data) dentry->d_inode->u.generic_ip = data; if (fops) dentry->d_inode->i_fop = fops; } exit: return dentry; } struct dentry* aufs_create_dir(const char* name, struct dentry* parent) { return aufs_create_file(name, S_IFDIR | S_IRWXU | S_IRUGO | S_IXUGO, parent, NULL, NULL); } static int __init aufs_init(void) { int retval; struct dentry* pslot; retval = register_filesystem(&au_fs_type); if (!retval) { aufs_mount = kern_mount(&au_fs_type); //lionel\uff0ckern_mount()\u3010\u8fd9\u4e2a\u5728super.c\u4e2d\u3011\u4e0edo_mount()\u3010\u8fd9\u4e2a\u5728fs\u91cc\u7684namespace.c\u4e2d\u3011\u6709\u5173\u8054\u4e0d\uff1f if (IS_ERROR(aufs_mount)) { printk(KERN_ERR \"aufs: could not mount!\\n\"); unregister_filesystem(&au_fs_type); return retval; } } pslot = aufs_create_dir(\"woman star\", NULL); aufs_create_file(\"lbb\", S_IFREG | S_IRUGO, pslot, NULL, NULL); aufs_create_file(\"fbb\", S_IFREG | S_IRUGO, pslot, NULL, NULL); aufs_create_file(\"ljl\", S_IFREG | S_IRUGO, pslot, NULL, NULL); pslot = aufs_create_dir(\"man star\", NULL); aufs_create_file(\"ldh\", S_IFREG | S_IRUGO, pslot, NULL, NULL); aufs_create_file(\"lcw\", S_IFREG | S_IRUGO, pslot, NULL, NULL); aufs_create_file(\"jw\", S_IFREG | S_IRUGO, pslot, NULL, NULL); return retval; } static void __exit aufs_exit(void) { simple_release_fs(&aufs_mount, &aufs_mount_count); unregister_filesystem(&au_fs_type); } module_init(aufs_init); module_exit(aufs_exit); MODULE_LICENSE(\"GPL\"); MOUDLE_DESCRIPTION(\"This is a simple module\"); MODULE_VERSION(\"Ver 0.1\"); /* * mkdir au * mount -t aufs none /au * ls */","title":"2.3.1\u3001\u4e00\u4e2a\u6700\u7b80\u5355\u7684\u6587\u4ef6\u7cfb\u7edfaufs"},{"location":"11filesystem/Linux%E5%86%85%E6%A0%B8%E6%8E%A2%E7%A7%98/#232","text":"\u4ee3\u7801\u4e09\u90e8\u5206 1\uff09 register_filesystem \u51fd\u6570\uff0c\u628aaufs\u6587\u4ef6\u7cfb\u7edf\u767b\u8bb0\u5230\u7cfb\u7edf 2\uff09\u8c03\u7528 kern_mount \u51fd\u6570\u4e3a\u6587\u4ef6\u7cfb\u7edf\u7533\u8bf7\u5fc5\u5907\u7684\u6570\u636e\u7ed3\u6784 3\uff09\u6700\u540e\u5728aufs\u6587\u4ef6\u7cfb\u7edf\u5185\u521b\u5efa\u4e24\u76ee\u5f55\uff0c\u6bcf\u4e2a\u76ee\u5f55\u4e0b\u9762\u521b\u5efa3\u4e2a\u6587\u4ef6","title":"2.3.2\u3001\u6587\u4ef6\u7cfb\u7edf\u5982\u4f55\u7ba1\u7406\u76ee\u5f55\u548c\u6587\u4ef6"},{"location":"11filesystem/Linux%E5%86%85%E6%A0%B8%E6%8E%A2%E7%A7%98/#233","text":"","title":"2.3.3\u3001\u6587\u4ef6\u7cfb\u7edf\u7684\u6302\u8f7d\u8fc7\u7a0b"},{"location":"11filesystem/Linux%E5%86%85%E6%A0%B8%E6%8E%A2%E7%A7%98/#234","text":"","title":"2.3.4\u3001\u6587\u4ef6\u6253\u5f00\u7684\u4ee3\u7801\u5206\u6790"},{"location":"11filesystem/Linux%E5%86%85%E6%A0%B8%E6%8E%A2%E7%A7%98/#24","text":"","title":"2.4\u3001\u672c\u7ae0\u5c0f\u7ed3"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/","text":"chap8\u3001\u6587\u4ef6\u7cfb\u7edf \u00b6 8.1\u3001\u6982\u8ff0 \u00b6 VFS\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u5efa\u7acb\uff0c\u5728\u7cfb\u7edf\u5173\u95ed\u65f6\u6d88\u4ea1\u3002 Minix\u4e3a\u4f8b \u6587\u4ef6\u7cfb\u7edf\u5f00\u5934\uff0c \u901a\u5e38\u4e3a\u4e00\u4e2a\u6247\u533a \uff0c\u5b58\u5165\u5f15\u5bfc\u7a0b\u5e8f \u8d85\u7ea7\u5757\uff0c\u5b58\u50a8\u78c1\u76d8\u8bbe\u5907\u4e0a\u6587\u4ef6\u7cfb\u7edf\u7ed3\u6784\u7684\u4fe1\u606f\uff0c\u5e76\u8bf4\u660e\u5404\u90e8\u5206\u7684\u5927\u5c0f i\u8282\u70b9\u4f4d\u56fe\uff1a\u63cf\u8ff0\u78c1\u76d8\u4e0a\u6bcf\u4e2ai\u8282\u70b9\u7684\u4f7f\u7528\u60c5\u51b5\u3002\u9664\u4e86\u4f4d0\uff0ci\u8282\u70b9\u4f4d\u56fe\u4e2d\u6bcf\u4e2a\u6bd4\u7279\u4f4d\u4f9d\u6b21\u4ee3\u8868\u76d8\u4e0ai\u8282\u70b9\u533a\u4e2d\u7684\u4e00\u4e2ai\u8282\u70b9\u3002 \u903b\u8f91\u5757\u4f4d\u56fe\uff1a\u78c1\u76d8\u4e0a\u6bcf\u4e2a\u903b\u8f91\u5757\u7684\u4f7f\u7528\u60c5\u51b5\u3002\u9664\u4e86\u4f4d0\uff0c\u5176\u5b83\u4f4d\u4f9d\u6b21\u8868\u793a\u76d8\u4e0a\u903b\u8f91\u5757\u533a\u4e2d\u7684\u4e00\u4e2a\u903b\u8f91\u5757\u3002 i\u8282\u70b9\uff1a\u53cd\u6620\u7684\u662f \u6587\u4ef6\u7684\u5143\u6570\u636e \u903b\u8f91\u5757\u7f16\u53f7\uff1a \u4fdd\u5b58\u6587\u4ef6\u7684\u6570\u636e \u3002\u6bcf\u4e2a\u6587\u4ef6\u6709\u4e14\u4ec5\u6709\u4e00\u4e2ai\u8282\u70b9\uff0c\u4f46\u53ef\u4ee5\u67090\uff0c1\u6216\u591a\u4e2a\u903b\u8f91\u5757 8.2\u3001\u6587\u4ef6\u7cfb\u7edf\u5bf9\u8c61 \u00b6 8.2.1\u3001 \u00b6 fs/filesystem.c\u4e2dregister_filesystem() include/linux/fs.h\u4e2d\u7684 struct file_system_type{}; 8.2.2\u3001 \u00b6 include/linux/fs.h\u4e2d\u7684 struct super_block{}; 8.2.3\u3001 \u00b6 include/linux/fs.h\u4e2d\u7684 struct inode{}; \u4ee5ext2\u4e3a\u4f8b\uff0c struct ext2_inode_info{}; 8.2.4\u3001 \u00b6 inode\u53cd\u6620\u7684\u662f\u6587\u4ef6\u7cfb\u7edf\u5bf9\u8c61\u7684\u5143\u6570\u636e\uff0c\u800cdentry\u5219\u8868\u793a\u6587\u4ef6\u7cfb\u7edf\u5bf9\u8c61\u5728\u6587\u4ef6\u7cfb\u7edf\u6811\u4e2d\u7684\u4f4d\u7f6e \u3002dentry\u548cinode\u662f\u591a\u5bf9\u4e00\u7684\u5173\u7cfb\uff0c\u6bcf\u4e2adentry\u53ea\u6709\u4e00\u4e2ainode\uff0c\u7531d_inode\u6307\u5411\uff1b\u800c\u4e00\u4e2ainode\u53ef\u80fd\u5bf9\u5e94\u591a\u4e2adentry\uff08\u4f8b\u5982\u786c\u94fe\u63a5\uff09\uff0c\u5b83\u5c06\u8fd9\u4e9bdentry\u7ec4\u6210\u4ee5i_dentry\u7684\u94fe\u8868\uff0c\u6bcf\u4e2adentry\u901a\u8fc7d_alias\u52a0\u5165\u6240\u5c5einode\u7684i_dentry\u94fe\u8868\u4e2d\u3002 include/linux/dcache.h\u4e2d struct dentry{}; 8.2.5\u3001 \u00b6 include/linux/mount.h\u4e2d\u7684 struct vfsmount{}; 8.3\u3001\u88c5\u8f7d\u6587\u4ef6\u7cfb\u7edf \u00b6 \u88c5\u8f7d\u76844\u4e2a\u8981\u7d20\uff1a vfsmount\u3001super_block\u3001\u6839dentry\u3001\u6839inode \u3002 8.3.1\u3001 \u00b6 fs/namespace.c\u4e2d\u7684 sys_mount() sys_mount() -> do_mount() -> do_new_mount() 8.3.2\u3001 \u00b6 sys_mount() -> do_mount() -> do_new_mount() -> do_kern_mount() sys_mount() -> do_mount() -> do_new_mount() -> do_kern_mount() -> vfs_kern_mount() \u6784\u5efa\u6587\u4ef6\u7cfb\u7edf\u88c5\u8f7d\u5b9e\u4f8b \uff0c\u5373\u6784\u5efavfsmount\uff0csuper_block\uff0c\u6839dentry\u548c\u6839inode\u4e4b\u95f4\u7684\u5173\u7cfb\u3002 8.3.3\u3001 \u00b6 sys_mount() -> do_mount() -> do_new_mount() -> do_kern_mount() -> vfs_kern_mount() -> minix_get_sb() -> get_sb_bdev() 8.3.4\u3001 \u00b6 sys_mount() -> do_mount() -> do_new_mount() -> do_kern_mount() -> vfs_kern_mount() -> minix_get_sb() -> get_sb_bdev() -> minx_fill_super() 8.3.5\u3001 \u00b6 sys_mount() -> do_mount() -> do_new_mount() -> do_add_mount() \u3010fs/namespace.c\u4e2d\u3011 8.4\u3001\u8def\u5f84\u67e5\u627e \u00b6 \u7528\u6237\u7a7a\u95f4\u8868\u793a\u6587\u4ef6\u4f7f\u7528\u7684\u662f\u8def\u5f84\u540d\u5b57\u7b26\u4e32\uff0c\u5185\u6838\u4e2d\u5bf9\u6587\u4ef6\u7684\u64cd\u4f5c\u9700\u8981\u4f9d\u636e \u8d85\u7ea7\u5757\u3001inode\u3001dentry\u4ee5\u53cavfsmount\u7b49 \u3002 include/linux/path.h \u67d0\u4e2a\u76ee\u5f55\u4e0b\u67e5\u627e\u7ed9\u5b9a\u540d\u5b57\u7684\u6587\u4ef6\uff0c\u6709\u4e09\u4e2a\u52a8\u4f5c\uff1a 1\u3001\u8bfb\u51fa\u76ee\u5f55\u7684\u5185\u5bb9\uff0c\u627e\u5230\u8be5\u6587\u4ef6\u5bf9\u5e94\u7684\u9879\uff0c\u83b7\u5f97\u5176i\u8282\u70b9\u7f16\u53f7 2\u3001\u4ecei\u8282\u70b9\u8868\u4e2d\u627e\u5230\u8be5\u7f16\u53f7\u7684inode\uff0c\u5b83\u76f4\u63a5\u6216\u95f4\u63a5\u6307\u5411\u5305\u542b\u6587\u4ef6\u6570\u636e\u7684\u903b\u8f91\u5757 3\u3001\u8bfb\u53d6\u8fd9\u4e9b\u903b\u8f91\u5757\u5373\u80fd\u83b7\u5f97\u8be5\u6587\u4ef6\u7684\u5185\u5bb9 include/linux/namei.h\u4e2d\u7684 struct nameidata{}; 8.4.1\u3001 \u00b6 fs/namei.c\u4e2d\u7684 path_lookup() 2.6.18\u4ee3\u7801\u8fd8\u662f\u6709\u70b9\u7684 8.4.2\u3001\u9010\u4e2a\u5206\u91cf\u89e3\u6790 \u00b6 link_path_walk() \uff0c \u91cd\u70b9 8.4.3\u3001\u89e3\u6790\u5355\u4e2a\u5206\u91cf \u00b6 do_lookup() 8.4.4\u3001\u4e0a\u6eaf\u901a\u8fc7\u88c5\u8f7d\u70b9 \u00b6 follow_dotdot() 8.4.5\u3001\u4e0b\u6eaf\u901a\u8fc7\u88c5\u8f7d\u70b9 \u00b6 follow_mount() 8.4.6\u3001\u5904\u7406\u7b26\u53f7\u94fe\u63a5 \u00b6 do_follow_link() 8.5\u3001\u6253\u5f00\u6587\u4ef6 \u00b6 \u5c06\u8def\u5f84\u540d\u8f6c\u6362\u4e3a \u5185\u6838\u4e2d\u552f\u4e00\u5b9a\u4f4d\u7684 <vfsmount,dentry> \u4e8c\u5143\u7ec4 \u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c \u6307\u7684\u662ffile\u7ed3\u6784\u7684\u5bf9\u8c61 \u6bcf\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u6253\u5f00\u591a\u4e2a\u6587\u4ef6\uff0c\u5c06\u5b83\u4eec\u7ec4\u7ec7\u6210\u6253\u5f00\u6587\u4ef6\u8868\u7684\u5f62\u5f0f\uff0c\u5b9e\u9645\u4e0a\u662f\u6307\u5411\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u6307\u9488\u6570\u7ec4\uff0c \u6570\u7ec4\u7d22\u5f15\u5373\u4e3a\u6587\u4ef6\u53e5\u67c4 \u3002 \u6253\u5f00\u6587\u4ef6\u8868\u5728\u5185\u6838\u4e2d\u5bf9\u5e94fdtable\u7ed3\u6784\u4e2d\uff0cinclude/linux/fdtable.h\u4e2d\u7684 struct fdtable{}; include/linux/fs.h\u4e2d\u7684 struct file{}; include/linux/fdtable.h\u4e2d\u7684 struct files_struct{}; 8.5.1\u3001open\u7cfb\u7edf\u8c03\u7528\u7684\u5904\u7406\u6d41\u7a0b \u00b6 \u5206\u914d\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u6b63\u786e\u8bbe\u7f6e f_mapping\uff08\u6587\u4ef6\u5730\u5740\u7a7a\u95f4\uff09 \u548c f_op\uff08\u6587\u4ef6\u64cd\u4f5c\u8868\uff09 \uff0c\u5728\u6253\u5f00\u6587\u4ef6\u8868\u4e2d\u627e\u5230\u4e00\u4e2a\u7528\u4e8e\u4fdd\u5b58\u5b83\u7684\u6587\u4ef6\u53e5\u67c4\u3002 sys_open()->do_sys_open()->do_filp_open()->do_last()->namidata_to_filp()-> __dentry_open() \uff0clionel\uff0c\u8fd9\u4e2a\u8981\u82b1\u65f6\u95f4\u53bb\u4e32\u4e00\u4e0b\u4ee3\u7801\u6ce8\u91ca\uff0c2\u670817\u65e5\u665a\u4e0a\u9010\u884c\u8bfb\u4e00\u4e0b 8.6\u3001\u8bfb\u6587\u4ef6\uff08\u91cd\u70b9\uff09 \u00b6 \u5730\u5740\u7a7a\u95f4\uff08Address Space\uff09 \u7684\u5f15\u5165\uff0c\u5c06\u5bf9\u8c61\u5728\u78c1\u76d8\u4e2d\uff08\u53ef\u80fd\u4e0d\u8fde\u7eed\u7684\uff09\u6570\u636e\u4ee5\u53ca\u9875\u9762\u4e3a\u5355\u4f4d\u8fde\u7eed\u5730\u5448\u73b0\u51fa\u6765\u3002 include/linux/fs.h\u4e2d\u7684 struct address_space{}; \u5730\u5740\u7a7a\u95f4\u7684\u5c5e\u4e3b\u5bf9\u8c61\u88ab\u5b9a\u4e49\u4e3a\u5c5e\u4e3b\u5bf9\u8c61\u7684inode\u3002 \u5bf9\u4e8e\u5e38\u89c4\u6587\u4ef6\u6216\u76ee\u5f55\u6587\u4ef6\uff0c\u8fd9\u5c31\u662f\u6587\u4ef6\u5bf9\u5e94\u7684inode\u63cf\u8ff0\u7b26 \u3002 radix\u6811\uff0c \u6811\u7684\u6839\u8282\u70b9\u4e3a\u5730\u5740\u7a7a\u95f4\u7684page_tree\u57df \uff0c\u6587\u4ef6inode\u5730\u5740\u7a7a\u95f4\u4fdd\u5b58\u7684\u662f\u6570\u636e\u5757\u3002 VFS\u901a\u8fc7\u8c03\u7528write_begin\u901a\u77e5\u5177\u4f53\u6587\u4ef6\u7cfb\u7edf\uff0c\u51c6\u5907\u5199\u6587\u4ef6\u7684\u5b57\u8282begin~end\u5230\u7ed9\u5b9a\u7684\u9875\u9762 \u3002 include/linux/mm_types.h\u4e2d\u7684 struct page{}; 8.6.1\u3001 \u00b6 sys_read()->vfs_read()->do_sync_read()->generic_file_aio_read()->do_generic_file_read() \u3010mm/filemap.c\u3011 8.6.2\u3001\u57fa\u4e8e\u7f13\u51b2\u9875\u9762\u6784\u9020I/O\u8bf7\u6c42 \u00b6 \u7f13\u51b2\u9875\u9762 \uff1a\u662f\u6307\u5c06\u9875\u9762\u5212\u5206\u4e3a\u4e00\u4e2a\u4e2a\u7684\u7f13\u51b2\u5757\uff08Buffer Block\uff09\uff0c\u4ee5\u7f13\u51b2\u5757\u4e3a\u5355\u4f4d\u8fdb\u884cI/O\u3002 \u7ba1\u7406\u7f13\u51b2\u5757\u7684\u6570\u636e\u7ed3\u6784\u4e3a buffer_head \uff0c\u88ab\u79f0\u4f5c \u7f13\u51b2\u5934 I/O\u7684\u57fa\u672c\u5355\u4f4d\u5df2\u7ecf\u6362\u6210bio\uff0c\u800cbuffer_head\u4ec5\u88ab\u7528\u6765\u63d0\u53d6\u5757\u6620\u5c04\uff08\u901a\u8fc7get_block_t\u8c03\u7528\uff09\uff0c\u7528\u4e8e\u8ddf\u8e2a\u9875\u9762\u7684\u72b6\u6001\uff08\u901a\u8fc7page_mapping\uff09\uff0c\u4ee5\u53ca\u7528\u4e8e\u5c01\u88c5bio\u63d0\u4ea4\u4ee5\u5411\u540e\u517c\u5bb9\uff08\u4f8b\u5982submit_bh\uff09 706/792\uff0c\u628a\u4e66\u4e2d\u7684\u5185\u5bb9\u63d0\u4e86\u4e00\u4e0b \uff0clionel\uff0c\u628a\u4e4b\u524d\u7684\u7591\u60d1 8.6.3\u3001\u76f4\u63a5\u9488\u5bf9\u9875\u9762\u6784\u9020I/O\u8bf7\u6c42 \u00b6 Linux\u4e3a\u57fa\u4e8e\u78c1\u76d8\u7684\u6587\u4ef6\u7cfb\u7edf\u63d0\u4f9b\u53e6\u4e00\u79cd\u7b56\u7565\uff0c\u6784\u9020\u5c3d\u53ef\u80fd\u5927\u7684bio\u5411\u4e0b\u5c42\u63d0\u4ea4\u3002\u5bf9\u5e94\u7684\u51fd\u6570\u4e3a mpage_readpage() \uff0c\u5b9e\u9645\u4e0aext3\u6587\u4ef6\u7cfb\u7edfreadpage\u65b9\u6cd5\u5b9e\u73b0\u4e3a ext3_readpage() \u3010fs/ext3/inode.c\u3011\u5c31\u662f\u76f4\u63a5\u8c03\u7528mpage_readpage\u51fd\u6570 8.7\u3001\u5199\u6587\u4ef6 8.8\u3001\u51b2\u5237\u6587\u4ef6 8.9\u3001\u5757\u8bbe\u5907\u6587\u4ef6 \u00b6 8.9.1\u3001\u5757\u8bbe\u5907\u7684\u4e3binode\u548c\u6b21inode \u00b6 8.9.2\u3001\u5bf9\u5757\u8bbe\u5907\u6587\u4ef6\u7684\u64cd\u4f5c\u8f6c\u6362\u4e3a\u5bf9\u5757\u8bbe\u5907\u7684\u64cd\u4f5c \u00b6 8.9.3\u3001\u5bf9\u5757\u8bbe\u5907\u6587\u4ef6\u7684\u8bfb/\u5199\u4f5c\u7528\u4e8e\u5757\u8bbe\u5907\u4e4b\u4e0a \u00b6 8.10\u3001\u6587\u4ef6\u7cfb\u7edf\u7f16\u7a0b\u6a21\u5f0f \u00b6 \u5b9e\u65bd\u6b65\u9aa4\u5982\u4e0b\uff1a 1\u3001\u5b9a\u4e49\u8d85\u7ea7\u5757\u7ed3\u6784 2\u3001\u5b9a\u4e49inode\u7ed3\u6784 3\u3001\u5b9e\u73b0\u5404\u79cd\u7c7b\u578b\u6587\u4ef6\u7684inode\u64cd\u4f5c\u8868 4\u3001\u5b9e\u73b0\u5404\u79cd\u7c7b\u578b\u6587\u4ef6\u7684file\u64cd\u4f5c\u8868 5\u3001\u5b9e\u73b0\u5404\u79cd\u7c7b\u578b\u6587\u4ef6\u7684address_space\u64cd\u4f5c\u8868 6\u3001\u5b9e\u73b0\u8d85\u7ea7\u5757\u64cd\u4f5c\u8868 7\u3001\u5b9e\u73b0dentry\u64cd\u4f5c\u8868 8\u3001\u5b9a\u4e49\u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b 9\u3001\u6a21\u5757\u52a0\u8f7d\u548c\u5378\u8f7d\u65b9\u6cd5","title":"\u300a\u5b58\u50a8\u6280\u672f\u539f\u7406\u5206\u6790\u300b"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#chap8","text":"","title":"chap8\u3001\u6587\u4ef6\u7cfb\u7edf"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#81","text":"VFS\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u5efa\u7acb\uff0c\u5728\u7cfb\u7edf\u5173\u95ed\u65f6\u6d88\u4ea1\u3002 Minix\u4e3a\u4f8b \u6587\u4ef6\u7cfb\u7edf\u5f00\u5934\uff0c \u901a\u5e38\u4e3a\u4e00\u4e2a\u6247\u533a \uff0c\u5b58\u5165\u5f15\u5bfc\u7a0b\u5e8f \u8d85\u7ea7\u5757\uff0c\u5b58\u50a8\u78c1\u76d8\u8bbe\u5907\u4e0a\u6587\u4ef6\u7cfb\u7edf\u7ed3\u6784\u7684\u4fe1\u606f\uff0c\u5e76\u8bf4\u660e\u5404\u90e8\u5206\u7684\u5927\u5c0f i\u8282\u70b9\u4f4d\u56fe\uff1a\u63cf\u8ff0\u78c1\u76d8\u4e0a\u6bcf\u4e2ai\u8282\u70b9\u7684\u4f7f\u7528\u60c5\u51b5\u3002\u9664\u4e86\u4f4d0\uff0ci\u8282\u70b9\u4f4d\u56fe\u4e2d\u6bcf\u4e2a\u6bd4\u7279\u4f4d\u4f9d\u6b21\u4ee3\u8868\u76d8\u4e0ai\u8282\u70b9\u533a\u4e2d\u7684\u4e00\u4e2ai\u8282\u70b9\u3002 \u903b\u8f91\u5757\u4f4d\u56fe\uff1a\u78c1\u76d8\u4e0a\u6bcf\u4e2a\u903b\u8f91\u5757\u7684\u4f7f\u7528\u60c5\u51b5\u3002\u9664\u4e86\u4f4d0\uff0c\u5176\u5b83\u4f4d\u4f9d\u6b21\u8868\u793a\u76d8\u4e0a\u903b\u8f91\u5757\u533a\u4e2d\u7684\u4e00\u4e2a\u903b\u8f91\u5757\u3002 i\u8282\u70b9\uff1a\u53cd\u6620\u7684\u662f \u6587\u4ef6\u7684\u5143\u6570\u636e \u903b\u8f91\u5757\u7f16\u53f7\uff1a \u4fdd\u5b58\u6587\u4ef6\u7684\u6570\u636e \u3002\u6bcf\u4e2a\u6587\u4ef6\u6709\u4e14\u4ec5\u6709\u4e00\u4e2ai\u8282\u70b9\uff0c\u4f46\u53ef\u4ee5\u67090\uff0c1\u6216\u591a\u4e2a\u903b\u8f91\u5757","title":"8.1\u3001\u6982\u8ff0"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#82","text":"","title":"8.2\u3001\u6587\u4ef6\u7cfb\u7edf\u5bf9\u8c61"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#821","text":"fs/filesystem.c\u4e2dregister_filesystem() include/linux/fs.h\u4e2d\u7684 struct file_system_type{};","title":"8.2.1\u3001"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#822","text":"include/linux/fs.h\u4e2d\u7684 struct super_block{};","title":"8.2.2\u3001"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#823","text":"include/linux/fs.h\u4e2d\u7684 struct inode{}; \u4ee5ext2\u4e3a\u4f8b\uff0c struct ext2_inode_info{};","title":"8.2.3\u3001"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#824","text":"inode\u53cd\u6620\u7684\u662f\u6587\u4ef6\u7cfb\u7edf\u5bf9\u8c61\u7684\u5143\u6570\u636e\uff0c\u800cdentry\u5219\u8868\u793a\u6587\u4ef6\u7cfb\u7edf\u5bf9\u8c61\u5728\u6587\u4ef6\u7cfb\u7edf\u6811\u4e2d\u7684\u4f4d\u7f6e \u3002dentry\u548cinode\u662f\u591a\u5bf9\u4e00\u7684\u5173\u7cfb\uff0c\u6bcf\u4e2adentry\u53ea\u6709\u4e00\u4e2ainode\uff0c\u7531d_inode\u6307\u5411\uff1b\u800c\u4e00\u4e2ainode\u53ef\u80fd\u5bf9\u5e94\u591a\u4e2adentry\uff08\u4f8b\u5982\u786c\u94fe\u63a5\uff09\uff0c\u5b83\u5c06\u8fd9\u4e9bdentry\u7ec4\u6210\u4ee5i_dentry\u7684\u94fe\u8868\uff0c\u6bcf\u4e2adentry\u901a\u8fc7d_alias\u52a0\u5165\u6240\u5c5einode\u7684i_dentry\u94fe\u8868\u4e2d\u3002 include/linux/dcache.h\u4e2d struct dentry{};","title":"8.2.4\u3001"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#825","text":"include/linux/mount.h\u4e2d\u7684 struct vfsmount{};","title":"8.2.5\u3001"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#83","text":"\u88c5\u8f7d\u76844\u4e2a\u8981\u7d20\uff1a vfsmount\u3001super_block\u3001\u6839dentry\u3001\u6839inode \u3002","title":"8.3\u3001\u88c5\u8f7d\u6587\u4ef6\u7cfb\u7edf"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#831","text":"fs/namespace.c\u4e2d\u7684 sys_mount() sys_mount() -> do_mount() -> do_new_mount()","title":"8.3.1\u3001"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#832","text":"sys_mount() -> do_mount() -> do_new_mount() -> do_kern_mount() sys_mount() -> do_mount() -> do_new_mount() -> do_kern_mount() -> vfs_kern_mount() \u6784\u5efa\u6587\u4ef6\u7cfb\u7edf\u88c5\u8f7d\u5b9e\u4f8b \uff0c\u5373\u6784\u5efavfsmount\uff0csuper_block\uff0c\u6839dentry\u548c\u6839inode\u4e4b\u95f4\u7684\u5173\u7cfb\u3002","title":"8.3.2\u3001"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#833","text":"sys_mount() -> do_mount() -> do_new_mount() -> do_kern_mount() -> vfs_kern_mount() -> minix_get_sb() -> get_sb_bdev()","title":"8.3.3\u3001"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#834","text":"sys_mount() -> do_mount() -> do_new_mount() -> do_kern_mount() -> vfs_kern_mount() -> minix_get_sb() -> get_sb_bdev() -> minx_fill_super()","title":"8.3.4\u3001"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#835","text":"sys_mount() -> do_mount() -> do_new_mount() -> do_add_mount() \u3010fs/namespace.c\u4e2d\u3011","title":"8.3.5\u3001"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#84","text":"\u7528\u6237\u7a7a\u95f4\u8868\u793a\u6587\u4ef6\u4f7f\u7528\u7684\u662f\u8def\u5f84\u540d\u5b57\u7b26\u4e32\uff0c\u5185\u6838\u4e2d\u5bf9\u6587\u4ef6\u7684\u64cd\u4f5c\u9700\u8981\u4f9d\u636e \u8d85\u7ea7\u5757\u3001inode\u3001dentry\u4ee5\u53cavfsmount\u7b49 \u3002 include/linux/path.h \u67d0\u4e2a\u76ee\u5f55\u4e0b\u67e5\u627e\u7ed9\u5b9a\u540d\u5b57\u7684\u6587\u4ef6\uff0c\u6709\u4e09\u4e2a\u52a8\u4f5c\uff1a 1\u3001\u8bfb\u51fa\u76ee\u5f55\u7684\u5185\u5bb9\uff0c\u627e\u5230\u8be5\u6587\u4ef6\u5bf9\u5e94\u7684\u9879\uff0c\u83b7\u5f97\u5176i\u8282\u70b9\u7f16\u53f7 2\u3001\u4ecei\u8282\u70b9\u8868\u4e2d\u627e\u5230\u8be5\u7f16\u53f7\u7684inode\uff0c\u5b83\u76f4\u63a5\u6216\u95f4\u63a5\u6307\u5411\u5305\u542b\u6587\u4ef6\u6570\u636e\u7684\u903b\u8f91\u5757 3\u3001\u8bfb\u53d6\u8fd9\u4e9b\u903b\u8f91\u5757\u5373\u80fd\u83b7\u5f97\u8be5\u6587\u4ef6\u7684\u5185\u5bb9 include/linux/namei.h\u4e2d\u7684 struct nameidata{};","title":"8.4\u3001\u8def\u5f84\u67e5\u627e"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#841","text":"fs/namei.c\u4e2d\u7684 path_lookup() 2.6.18\u4ee3\u7801\u8fd8\u662f\u6709\u70b9\u7684","title":"8.4.1\u3001"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#842","text":"link_path_walk() \uff0c \u91cd\u70b9","title":"8.4.2\u3001\u9010\u4e2a\u5206\u91cf\u89e3\u6790"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#843","text":"do_lookup()","title":"8.4.3\u3001\u89e3\u6790\u5355\u4e2a\u5206\u91cf"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#844","text":"follow_dotdot()","title":"8.4.4\u3001\u4e0a\u6eaf\u901a\u8fc7\u88c5\u8f7d\u70b9"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#845","text":"follow_mount()","title":"8.4.5\u3001\u4e0b\u6eaf\u901a\u8fc7\u88c5\u8f7d\u70b9"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#846","text":"do_follow_link()","title":"8.4.6\u3001\u5904\u7406\u7b26\u53f7\u94fe\u63a5"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#85","text":"\u5c06\u8def\u5f84\u540d\u8f6c\u6362\u4e3a \u5185\u6838\u4e2d\u552f\u4e00\u5b9a\u4f4d\u7684 <vfsmount,dentry> \u4e8c\u5143\u7ec4 \u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c \u6307\u7684\u662ffile\u7ed3\u6784\u7684\u5bf9\u8c61 \u6bcf\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u6253\u5f00\u591a\u4e2a\u6587\u4ef6\uff0c\u5c06\u5b83\u4eec\u7ec4\u7ec7\u6210\u6253\u5f00\u6587\u4ef6\u8868\u7684\u5f62\u5f0f\uff0c\u5b9e\u9645\u4e0a\u662f\u6307\u5411\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u6307\u9488\u6570\u7ec4\uff0c \u6570\u7ec4\u7d22\u5f15\u5373\u4e3a\u6587\u4ef6\u53e5\u67c4 \u3002 \u6253\u5f00\u6587\u4ef6\u8868\u5728\u5185\u6838\u4e2d\u5bf9\u5e94fdtable\u7ed3\u6784\u4e2d\uff0cinclude/linux/fdtable.h\u4e2d\u7684 struct fdtable{}; include/linux/fs.h\u4e2d\u7684 struct file{}; include/linux/fdtable.h\u4e2d\u7684 struct files_struct{};","title":"8.5\u3001\u6253\u5f00\u6587\u4ef6"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#851open","text":"\u5206\u914d\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u6b63\u786e\u8bbe\u7f6e f_mapping\uff08\u6587\u4ef6\u5730\u5740\u7a7a\u95f4\uff09 \u548c f_op\uff08\u6587\u4ef6\u64cd\u4f5c\u8868\uff09 \uff0c\u5728\u6253\u5f00\u6587\u4ef6\u8868\u4e2d\u627e\u5230\u4e00\u4e2a\u7528\u4e8e\u4fdd\u5b58\u5b83\u7684\u6587\u4ef6\u53e5\u67c4\u3002 sys_open()->do_sys_open()->do_filp_open()->do_last()->namidata_to_filp()-> __dentry_open() \uff0clionel\uff0c\u8fd9\u4e2a\u8981\u82b1\u65f6\u95f4\u53bb\u4e32\u4e00\u4e0b\u4ee3\u7801\u6ce8\u91ca\uff0c2\u670817\u65e5\u665a\u4e0a\u9010\u884c\u8bfb\u4e00\u4e0b","title":"8.5.1\u3001open\u7cfb\u7edf\u8c03\u7528\u7684\u5904\u7406\u6d41\u7a0b"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#86","text":"\u5730\u5740\u7a7a\u95f4\uff08Address Space\uff09 \u7684\u5f15\u5165\uff0c\u5c06\u5bf9\u8c61\u5728\u78c1\u76d8\u4e2d\uff08\u53ef\u80fd\u4e0d\u8fde\u7eed\u7684\uff09\u6570\u636e\u4ee5\u53ca\u9875\u9762\u4e3a\u5355\u4f4d\u8fde\u7eed\u5730\u5448\u73b0\u51fa\u6765\u3002 include/linux/fs.h\u4e2d\u7684 struct address_space{}; \u5730\u5740\u7a7a\u95f4\u7684\u5c5e\u4e3b\u5bf9\u8c61\u88ab\u5b9a\u4e49\u4e3a\u5c5e\u4e3b\u5bf9\u8c61\u7684inode\u3002 \u5bf9\u4e8e\u5e38\u89c4\u6587\u4ef6\u6216\u76ee\u5f55\u6587\u4ef6\uff0c\u8fd9\u5c31\u662f\u6587\u4ef6\u5bf9\u5e94\u7684inode\u63cf\u8ff0\u7b26 \u3002 radix\u6811\uff0c \u6811\u7684\u6839\u8282\u70b9\u4e3a\u5730\u5740\u7a7a\u95f4\u7684page_tree\u57df \uff0c\u6587\u4ef6inode\u5730\u5740\u7a7a\u95f4\u4fdd\u5b58\u7684\u662f\u6570\u636e\u5757\u3002 VFS\u901a\u8fc7\u8c03\u7528write_begin\u901a\u77e5\u5177\u4f53\u6587\u4ef6\u7cfb\u7edf\uff0c\u51c6\u5907\u5199\u6587\u4ef6\u7684\u5b57\u8282begin~end\u5230\u7ed9\u5b9a\u7684\u9875\u9762 \u3002 include/linux/mm_types.h\u4e2d\u7684 struct page{};","title":"8.6\u3001\u8bfb\u6587\u4ef6\uff08\u91cd\u70b9\uff09"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#861","text":"sys_read()->vfs_read()->do_sync_read()->generic_file_aio_read()->do_generic_file_read() \u3010mm/filemap.c\u3011","title":"8.6.1\u3001"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#862io","text":"\u7f13\u51b2\u9875\u9762 \uff1a\u662f\u6307\u5c06\u9875\u9762\u5212\u5206\u4e3a\u4e00\u4e2a\u4e2a\u7684\u7f13\u51b2\u5757\uff08Buffer Block\uff09\uff0c\u4ee5\u7f13\u51b2\u5757\u4e3a\u5355\u4f4d\u8fdb\u884cI/O\u3002 \u7ba1\u7406\u7f13\u51b2\u5757\u7684\u6570\u636e\u7ed3\u6784\u4e3a buffer_head \uff0c\u88ab\u79f0\u4f5c \u7f13\u51b2\u5934 I/O\u7684\u57fa\u672c\u5355\u4f4d\u5df2\u7ecf\u6362\u6210bio\uff0c\u800cbuffer_head\u4ec5\u88ab\u7528\u6765\u63d0\u53d6\u5757\u6620\u5c04\uff08\u901a\u8fc7get_block_t\u8c03\u7528\uff09\uff0c\u7528\u4e8e\u8ddf\u8e2a\u9875\u9762\u7684\u72b6\u6001\uff08\u901a\u8fc7page_mapping\uff09\uff0c\u4ee5\u53ca\u7528\u4e8e\u5c01\u88c5bio\u63d0\u4ea4\u4ee5\u5411\u540e\u517c\u5bb9\uff08\u4f8b\u5982submit_bh\uff09 706/792\uff0c\u628a\u4e66\u4e2d\u7684\u5185\u5bb9\u63d0\u4e86\u4e00\u4e0b \uff0clionel\uff0c\u628a\u4e4b\u524d\u7684\u7591\u60d1","title":"8.6.2\u3001\u57fa\u4e8e\u7f13\u51b2\u9875\u9762\u6784\u9020I/O\u8bf7\u6c42"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#863io","text":"Linux\u4e3a\u57fa\u4e8e\u78c1\u76d8\u7684\u6587\u4ef6\u7cfb\u7edf\u63d0\u4f9b\u53e6\u4e00\u79cd\u7b56\u7565\uff0c\u6784\u9020\u5c3d\u53ef\u80fd\u5927\u7684bio\u5411\u4e0b\u5c42\u63d0\u4ea4\u3002\u5bf9\u5e94\u7684\u51fd\u6570\u4e3a mpage_readpage() \uff0c\u5b9e\u9645\u4e0aext3\u6587\u4ef6\u7cfb\u7edfreadpage\u65b9\u6cd5\u5b9e\u73b0\u4e3a ext3_readpage() \u3010fs/ext3/inode.c\u3011\u5c31\u662f\u76f4\u63a5\u8c03\u7528mpage_readpage\u51fd\u6570 8.7\u3001\u5199\u6587\u4ef6 8.8\u3001\u51b2\u5237\u6587\u4ef6","title":"8.6.3\u3001\u76f4\u63a5\u9488\u5bf9\u9875\u9762\u6784\u9020I/O\u8bf7\u6c42"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#89","text":"","title":"8.9\u3001\u5757\u8bbe\u5907\u6587\u4ef6"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#891inodeinode","text":"","title":"8.9.1\u3001\u5757\u8bbe\u5907\u7684\u4e3binode\u548c\u6b21inode"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#892","text":"","title":"8.9.2\u3001\u5bf9\u5757\u8bbe\u5907\u6587\u4ef6\u7684\u64cd\u4f5c\u8f6c\u6362\u4e3a\u5bf9\u5757\u8bbe\u5907\u7684\u64cd\u4f5c"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#893","text":"","title":"8.9.3\u3001\u5bf9\u5757\u8bbe\u5907\u6587\u4ef6\u7684\u8bfb/\u5199\u4f5c\u7528\u4e8e\u5757\u8bbe\u5907\u4e4b\u4e0a"},{"location":"11filesystem/%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#810","text":"\u5b9e\u65bd\u6b65\u9aa4\u5982\u4e0b\uff1a 1\u3001\u5b9a\u4e49\u8d85\u7ea7\u5757\u7ed3\u6784 2\u3001\u5b9a\u4e49inode\u7ed3\u6784 3\u3001\u5b9e\u73b0\u5404\u79cd\u7c7b\u578b\u6587\u4ef6\u7684inode\u64cd\u4f5c\u8868 4\u3001\u5b9e\u73b0\u5404\u79cd\u7c7b\u578b\u6587\u4ef6\u7684file\u64cd\u4f5c\u8868 5\u3001\u5b9e\u73b0\u5404\u79cd\u7c7b\u578b\u6587\u4ef6\u7684address_space\u64cd\u4f5c\u8868 6\u3001\u5b9e\u73b0\u8d85\u7ea7\u5757\u64cd\u4f5c\u8868 7\u3001\u5b9e\u73b0dentry\u64cd\u4f5c\u8868 8\u3001\u5b9a\u4e49\u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b 9\u3001\u6a21\u5757\u52a0\u8f7d\u548c\u5378\u8f7d\u65b9\u6cd5","title":"8.10\u3001\u6587\u4ef6\u7cfb\u7edf\u7f16\u7a0b\u6a21\u5f0f"},{"location":"11filesystem/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%8A%80%E6%9C%AF%E5%86%85%E5%B9%95/","text":"chap2\u3001\u5982\u4f55\u4f7f\u7528\u6587\u4ef6\u7cfb\u7edf \u00b6 2.8\u3001\u6587\u4ef6\u7684\u96f6\u62f7\u8d1d \u00b6","title":"\u300a\u6587\u4ef6\u7cfb\u7edf\u6280\u672f\u5185\u5e55\u300b"},{"location":"11filesystem/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%8A%80%E6%9C%AF%E5%86%85%E5%B9%95/#chap2","text":"","title":"chap2\u3001\u5982\u4f55\u4f7f\u7528\u6587\u4ef6\u7cfb\u7edf"},{"location":"11filesystem/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%8A%80%E6%9C%AF%E5%86%85%E5%B9%95/#28","text":"","title":"2.8\u3001\u6587\u4ef6\u7684\u96f6\u62f7\u8d1d"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/","text":"chap1\u3001\u57fa\u4e8e\u53ef\u6269\u5c55\u54c8\u5e0c\u7684\u53d7\u63a7\u526f\u672c\u5206\u5e03\u7b56\u7565CRUSH \u00b6 0\u3001 \u00b6 CRUSH\uff08Controlled Replication Under Scalable Hashing\uff09\uff0c \u57fa\u4e8e\u54c8\u5e0c\u7684\u6570\u636e\u5206\u5e03\u7b97\u6cd5 1.1\u3001straw\u53castraw2\u7b97\u6cd5\u7b80\u4ecb \u00b6 straw\u7b97\u6cd5\u6267\u884c\u7ed3\u679c\u53d6\u51b3\u4e8e\u4e09\u4e2a\u56e0\u7d20\uff1a \u56fa\u5b9a\u8f93\u5165\u3001\u5143\u7d20\u7f16\u53f7\u548c\u5143\u7d20\u6743\u91cd \u3002 1.2\u3001CRUSH\u7b97\u6cd5\u8be6\u89e3 \u00b6 1.2.1\u3001\u96c6\u7fa4\u7684\u5c42\u6b21\u5316\u63cf\u8ff0-Cluster Map \u00b6 1.2.2\u3001\u6570\u636e\u5206\u5e03\u7b56\u7565--Placement Rule \u00b6 + \u6bcf\u6761placment rule\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u64cd\u4f5c\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u5171\u67093\u79cd\u7c7b\u578b + \uff081\uff09take + \uff082\uff09select + \uff083\uff09emit 1.3\u3001\u8c03\u5236CRUSH \u00b6 0\u3001 \u63d0\u5347CRUSH\u7684\u8ba1\u7b97\u6548\u7387 1.3.1\u3001\u7f16\u8f91CRUSH Map \u00b6 \uff081\uff09\u83b7\u53d6CRUSH map \uff082\uff09\u53cd\u7f16\u8bd1CRUSH map \uff083\uff09\u7f16\u8f91CRUSH map \uff084\uff09\u7f16\u8bd1CRUSH map \uff085\uff09\u6a21\u62df\u6d4b\u8bd5 \uff086\uff09\u6ce8\u5165\u96c6\u7fa4 1.3.2\u3001\u5b9a\u5236CRUSH\u89c4\u5219 \u00b6 1.3.3\u3001\u6570\u636e\u91cd\u5e73\u8861 \u00b6 1.4\u3001\u603b\u7ed3\u4e0e\u5c55\u671b \u00b6 list\u548ctree\u7b97\u6cd5\u88ab\u5148\u540e\u5e9f\u5f03\uff0c\u539f\u521b\u7684straw\u7b97\u6cd5\u88ab\u5b8c\u5168\u91cd\u5199 chap2\u3001\u65b0\u578b\u5bf9\u8c61\u5b58\u50a8\u5f15\u64ceBlueStore \u00b6 https://github.com/ceph/ceph/tree/main/src/os/bluestore 0\u3001 2.1\u3001\u8bbe\u8ba1\u7406\u5ff5\u4e0e\u6307\u5bfc\u539f\u5219 \u00b6 \u5199\u4e2d\u95f4\u8bbe\u5907\u7684\u8fc7\u6e21\u8fc7\u7a0b\u79f0\u4e3a \u5199\u65e5\u5fd7 \uff0c\u4e2d\u95f4\u8bbe\u5907\u4e5f\u53eb \u65e5\u5fd7\u8bbe\u5907 \uff0c\u4e00\u822c\u53ef\u7531NVRAM\u6216\u8005SSD\u7b49\u9ad8\u901f\u5b58\u50a8\u8bbe\u5907\u5145\u5f53\u3002 \u51e0\u4e2a\u672f\u8bed block-size\uff08\u5757\u5927\u5c0f\uff09 RMW\uff08Read Modify Write\uff09 COW\uff08Copy-On-Write\uff09 BlueStore\u9488\u5bf9\u5199\u64cd\u4f5c\u7efc\u5408\u8fd0\u7528\u4e86RMW\u548cCOW\u7b56\u7565-\u4efb\u4f55\u4e00\u4e2a\u5199\u8bf7\u6c42\uff0c\u6839\u636e\u78c1\u76d8\u5757\u5927\u5c0f\uff0c\u5c06\u5176\u5207\u5206\u4e3a\u4e09\u4e2a\u90e8\u5206\uff1a \u9996\u5c3e\u975e\u5757\u5927\u5c0f\u5bf9\u9f50\u90e8\u5206\u548c\u4e2d\u95f4\u5757\u5927\u5c0f\u5bf9\u9f50\u90e8\u5206 \u7136\u540e\u9488\u5bf9\u4e2d\u95f4\u5757\u5bf9\u9f50\u90e8\u5206\u91c7\u7528COW\u7b56\u7565 \u9996\u5c3e\u975e\u5757\u5bf9\u9f50\u90e8\u5206\u91c7\u7528RMW\u7b56\u7565 2.2\u3001\u78c1\u76d8\u6570\u636e\u7ed3\u6784 \u00b6 0\u3001 **BuleStore\u4e2d\u4e60\u60ef\u4e0a\u78c1\u76d8\u683c\u5f0f\u4ee5\" _t \"\u7ed3\u5c3e\u5e76\u4e14\u5168\u90e8\u5c0f\u5199\uff0c\u800c\u5185\u5b58\u683c\u5f0f\u4e0d\u4ee5\" \\t \"\u7ed3\u5c3e\u5e76\u4e14\u53ea\u6709\u9996\u5b57\u6bcd\u5927\u5199\u3002 2.2.1\u3001PG \u00b6 Ceph\u5e76\u4e0d\u662f\u5c06\u4efb\u4f55\u4e0a\u5c42\u6570\u636e\u4e00\u6b65\u5230\u4f4d\u6620\u5c04\u5230\u78c1\u76d8\uff08OSD\uff09\uff0c\u800c\u662f\u5f15\u5165\u4e86\u4e00\u4e2a\u4e2d\u95f4\u7ed3\u6784\uff0c\u79f0\u4e3a PG\uff0c\u5b9e\u73b0\u4e24\u7ea7\u6620\u5c04 \u7b2c\u4e00\u7ea7\u6620\u5c04\u662f\u9759\u6001\u7684 \u7b2c\u4e8c\u7ea7\u6620\u5c04\u5b9e\u73b0PG\u5230OSD\u7684\u6620\u5c04\uff0c \u4ecd\u7136\u91c7\u7528\u4f2a\u968f\u673a\u54c8\u5e0c\u51fd\u6570 PG\u5bf9\u5e94\u7684\u78c1\u76d8\u7ed3\u6784\u79f0\u4e3a bluestore_cnode_t 2.2.2\u3001\u5bf9\u8c61 \u00b6 extent\u662f\u5bf9\u8c61\u5185\u7684\u57fa\u672c\u6570\u636e\u7ba1\u7406\u5355\u5143\uff0c\u4e0b\u9762\u5206\u522b\u4e88\u4ee5\u9610\u8ff0\uff1a \u6570\u636e\u6821\u9a8c \u6570\u636e\u538b\u7f29 \u6570\u636e\u5171\u4eab 2.3\u3001\u7f13\u5b58\u7ba1\u7406 \u00b6 2.3.1\u3001\u5e38\u89c1\u7684\u7f13\u5b58\u6dd8\u6c70\u7b97\u6cd5 \u00b6 2.3.2\u3001BlueStore\u4e2d\u7684\u7f13\u5b58\u7ba1\u7406 \u00b6 2\u7c7b\u578b\u7684\u7f13\u5b58\u7b97\u6cd5 LRU 2Q\uff1a \u7c7b\u4f3c\u4e8e\u7b80\u5316\u7248\u672cARC \uff0c\u533a\u522b\u5728\u4e8e\u53ea\u4f7f\u7528\u4e00\u4e2a\u5f71\u5b50\u961f\u5217 2.4\u3001\u78c1\u76d8\u7a7a\u95f4\u7ba1\u7406 \u00b6 2.4.1\u3001\u5e38\u89c1\u78c1\u76d8\u7a7a\u95f4\u7ba1\u7406\u6a21\u5f0f \u00b6 2.4.2\u3001BitmapFreelistManager \u00b6 2.4.3\u3001BitmapAllocator \u00b6 2.5\u3001BlueFs \u00b6 2.5.1\u3001RocksDB\u4e0eBuleFs \u00b6 2.5.2\u3001\u78c1\u76d8\u6570\u636e\u7ed3\u6784 \u00b6 2.5.3\u3001\u5757\u8bbe\u5907 \u00b6 2.6\u3001\u5b9e\u73b0\u539f\u7406 \u00b6 2.6.1\u3001mkfs \u00b6 mkfs\u4e3b\u8981\u56fa\u5316\u4e00\u4e9b\u7528\u6237\u6307\u5b9a\u7684\u914d\u7f6e\u9879\u5230\u78c1\u76d8\uff0c\u8fd9\u6837\u540e\u7eedBlueStore\u4e0a\u7535\u65f6\uff0c\u8fd9\u4e9b\u914d\u7f6e\u9879\u5c06\u76f4\u63a5\u4ece\u78c1\u76d8\u8bfb\u53d6 \u3002 2.6.2\u3001mount \u00b6 OSD\u8fdb\u7a0b\u4e0a\u7535\u65f6\uff0cBlueStore\u901a\u8fc7mount\u64cd\u4f5c\u5b8c\u6210\u6b63\u5e38\u4e0a\u7535\u524d\u7684\u68c0\u67e5\u548c\u51c6\u5907\u5de5\u4f5c\u3002 mount\u64cd\u4f5c\u5305\u542b\u4ee5\u4e0b\u51e0\u4e2a\u6b65\u9aa4 \uff1a 1\u3001\u6821\u9a8cObjectStore\u7c7b\u578b 2\u3001fsck\u6216\u8005deep-fsck 3\u3001\u52a0\u8f7d\u5e76\u9501\u5b9afsid 4\u3001\u52a0\u8f7d\u4e3b\u5757\u8bbe\u5907 5\u3001\u52a0\u8f7d\u6570\u636e\u5e93\uff0c\u8bfb\u53d6\u5143\u6570\u636e 6\u3001\u52a0\u8f7dCollection 2.6.3\u3001read \u00b6 2.6.4\u3001write \u00b6 2.7\u3001\u4f7f\u7528\u6307\u5357 \u00b6 2.7.1\u3001\u90e8\u7f72BlueStore \u00b6 2.7.2\u3001\u914d\u7f6e\u53c2\u6570 \u00b6 2.8\u3001\u603b\u7ed3\u4e0e\u5c55\u671b \u00b6 chap3\u3001\u7ea0\u5220\u7801\u539f\u7406\u4e0eoverwrites\u652f\u6301 \u00b6 0\u3001 \u00b6 \u7ea0\u5220\u7801\uff08Erasure Coding\uff09 \u7ea0\u5220\u7801\u6700\u7b80\u5355\u7684\u5b9e\u73b0\u65b9\u5f0f\u662f\u5b8c\u5168\u590d\u5236\uff0c\u4e5f\u79f0\u4e3a\u955c\u50cf\uff0c \u5c06\u6570\u636e\u4e0d\u505a\u4efb\u4f55\u5904\u7406\u540c\u65f6\u5199\u5165\u591a\u4e2a\u4e0d\u540c\u7684\u5b58\u50a8\u4ecb\u8d28 \u3002 overwrites\u6280\u672f\uff08\u8986\u76d6\u5199\uff09 3.1\u3001RAID\u6280\u672f\u6982\u8ff0 \u00b6 \u6570\u636e\u5b58\u50a8\u5728\u5355\u4e2a\u78c1\u76d8\u4e0a\uff0c\u5b58\u5728\u4e00\u4e9b\u56fa\u6709\u7f3a\u9677 \u8bbf\u95ee\u901f\u5ea6\u6162 \u5bb9\u91cf\u5c0f \u5b89\u5168\u6027\u5dee \u4e3b\u6d41\u7684RAID\u6280\u672f RAID0 RAID1 RAID5 RAID6 3.2\u3001RS-RAID\u548cJerasure \u00b6 0\u3001 3.2.1\u3001\u8ba1\u7b97\u6821\u9a8c\u548c \u00b6 3.2.2\u3001\u6570\u636e\u6062\u590d \u00b6 3.2.3\u3001\u7b97\u672f\u8fd0\u7b97 \u00b6 3.2.4\u3001\u7f3a\u9677\u4e0e\u6539\u8fdb \u00b6 3.2.5\u3001Jerasure \u00b6 3.3\u3001\u7ea0\u5220\u7801\u5728Ceph\u4e2d\u7684\u5e94\u7528 \u00b6 3.3.1\u3001\u672f\u8bed \u00b6 3.3.2\u3001\u6982\u8ff0 \u00b6 3.3.3\u3001\u65b0\u5199 \u00b6 3.3.4\u3001\u8bfb \u00b6 3.3.5\u3001\u8986\u76d6\u5199 \u00b6 3.3.6\u3001\u65e5\u5fd7 \u00b6 3.3.7\u3001Scrub \u00b6 3.4\u3001\u603b\u7ed3\u4e0e\u5c55\u671b \u00b6 chap5\u3001\u5b58\u50a8\u670d\u52a1\u8d28\u91cfQoS \u00b6 0\u3001 \u00b6 dmClock\u7528\u4e8e\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684I/O\u8c03\u5ea6\u7b97\u6cd5\uff0c\uff08Handling Throughput Variablity for Hypervisor IO Scheduling\uff09 5.1\u3001\u7814\u7a76\u73b0\u72b6 \u00b6 BTRFS Q-EBOFS\uff1a \u6ca1\u6709\u88abCeph\u91c7\u7528 \u5728BTRFS\u539f\u6709\u78c1\u76d8\u8c03\u5ea6\u961f\u5217\u4e2d\uff0c\u5f15\u5165\u4e86\u4e00\u5c42\u5ba2\u6237\u7aef\u7ea7\u522b\u7684\u65b0\u961f\u5217\uff0c\u91c7\u7528\u57fa\u4e8e\u6743\u91cd\u7684\u8f6e\u8be2\u673a\u5236\uff0c\u5c06\u4e0d\u540c\u5ba2\u6237\u7aef\u961f\u5217\u4e2d\u7684\u8bf7\u6c42\u5206\u53d1\u81f3\u78c1\u76d8\u8c03\u5ea6\u961f\u5217\uff0c\u4ece\u800c\u5728\u5355\u4e2aOSD\u5c42\u9762\u5b9e\u73b0\u5bf9\u4e0d\u540c\u5ba2\u6237\u7aef\u6309\u5176\u6743\u91cd\u5206\u914dI/O\u8d44\u6e90\u7684\u76ee\u6807\u3002 5.2\u3001dmClock\u7b97\u6cd5\u539f\u7406 \u00b6 5.2.1\u3001mClock \u00b6 \u57fa\u4e8e\u65f6\u95f4\u6807\u7b7e\u7684I/O\u8c03\u5ea6\u7b97\u6cd5\u3002 mClock\u57fa\u672c\u539f\u7406\u4e3b\u8981\u5305\u542b\u4e09\u4e2a\u65b9\u9762\uff1a \u4e3a\u6bcf\u4e2a\u5ba2\u6237\u7aef\u8bbe\u7f6e\u4e00\u5957QoS\u6a21\u677f\u53c2\u6570\uff0c\u5305\u62ec\u9884\u7559\uff08r\uff09\u3001\u6743\u91cd\uff08w\uff09\u548c\u4e0a\u9650\uff08l\uff09 \u670d\u52a1\u7aef\u5206\u4e24\u4e2a\u9636\u6bb5\u6765\u5904\u7406I/O\u8bf7\u6c42\uff1a \u4e00\u662f\u57fa\u4e8e\u5f3a\u5236\u7684Constraint-based\u9636\u6bb5 \u4e8c\u662f\u57fa\u4e8e\u6743\u91cd\u7684Weight-based\u9636\u6bb5 \u670d\u52a1\u7aef\u4f18\u5148\u5de5\u4f5c\u4e8eConstraint-based\u9636\u6bb5 5.2.2\u3001dmClock \u00b6 \u662fmClock\u7b97\u6cd5\u7684\u5206\u5e03\u5f0f\u7248\u672c\uff0c \u4e24\u8005\u7684\u57fa\u672c\u539f\u7406\u76f8\u540c dmClock\u548cmClock\u7684\u5dee\u522b\uff1a \u5206\u5e03\u5f0f\u7cfb\u7edf\u5177\u6709\u591a\u4e2a\u670d\u52a1\u5668 \u5ba2\u6237\u7aef\u8bb0\u5f55\u6bcf\u4e2a\u670d\u52a1\u5668\u5b8c\u6210\u7684\u8bf7\u6c42\u4e2a\u6570 \u670d\u52a1\u7aef\u8ba1\u7b97\u8bf7\u6c42\u7684\u65f6\u95f4\u6807\u7b7e\u65f6\uff0c 5.3\u3001QoS\u7684\u8bbe\u8ba1\u4e0e\u5b9e\u73b0 \u00b6 0\u3001 \u00b6 \u901a\u5e38\u5c06QoS\u7684\u5b9e\u73b0\u7f6e\u4e8e\u6bcf\u4e2aOSD\u4e2d \uff0c\u6bcf\u4e2aOSD\u901a\u8fc7\u4e00\u4e2a\u79f0\u4e3a ShardedOpWQ\u7684\u5de5\u4f5c\u961f\u5217 5.3.1\u3001\u4f18\u5148\u7ea7\u961f\u5217\uff08prio\uff09 \u00b6 \u5165\u961f \u51fa\u961f 5.3.2\u3001\u6743\u91cd\u7684\u4f18\u5148\u7ea7\u961f\u5217\uff08wpq\uff09 \u00b6 \u57fa\u4e8e\u6743\u91cd\u7684\u4f18\u5148\u7ea7\u961f\u5217\u4e0ePrioritizedQueue\u7684\u961f\u5217\u7ed3\u6784\u7c7b\u4f3c\uff0c\u540c\u6837\u5206\u4e3a\u4f18\u5148\u7ea7prio\u3001\u5ba2\u6237\u7aefclient\u4ee5\u53ca\u771f\u5b9e\u7684\u8bf7\u6c42list\u4e09\u4e2a\u7ea7\u522b\u3002 \u8bf7\u6c42\u7684\u51fa\u961f\u673a\u5236\uff1a \u91c7\u7528\u6743\u91cd\u6982\u7387\u7684\u65b9\u5f0f\u786e\u5b9aprio\u7ea7\u522b \u88ab\u9009\u4e2d\u7684prio\u961f\u5217\u5e76\u4e0d\u5b9a\u80fd\u51fa\u961f\u8bf7\u6c42 client\u7ea7\u522b\u548c\u771f\u5b9e\u8bf7\u6c42\u7684\u9009\u62e9\u91c7\u7528\u4e0ePrioritizedQueue\u76f8\u540c\u7684\u65b9\u5f0f\uff0c\u5206\u522b\u4e3a \u8f6e\u8be2\u548cFIFO\u7b56\u7565 5.3.3\u3001dmClock\u961f\u5217 \u00b6 dmClock\u662f\u4e00\u4e2a\u4e24\u7ea7\u6620\u5c04\u961f\u5217\uff0c\u7b2c\u4e00\u7ea7\u4e3a\u5ba2\u6237\u7aef\u7684client\u961f\u5217\uff0c\u7b2c\u4e8c\u7ea7\u4e3a\u771f\u5b9e\u7684\u8bf7\u6c42\u961f\u5217\uff0c\u6bcf\u4e2a\u8bf7\u6c42\u5305\u542b\u4e09\u4e2a\u65f6\u95f4\u6807\u7b7e <RWL> dmClock\u91c7\u7528\u5b8c\u5168\u4e8c\u53c9\u6811\u6765\u7ec4\u7ec7\u7ba1\u7406 5.3.4\u3001Client\u7684\u8bbe\u8ba1 \u00b6 5.4\u3001\u603b\u7ed3\u4e0e\u5c55\u671b \u00b6 \u53ef\u80fd\u7684\u6539\u8fdb\u65b9\u5411\u5305\u62ec\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\uff1a 1\u3001\u5408\u7406\u6a21\u677f\u53c2\u6570\u7684\u8bbe\u7f6e 2\u3001I/O\u5e26\u5bbd\u7684\u9650\u5236 3\u3001\u7a81\u53d1I/O\u7684\u5904\u7406 chap6\u3001\u5206\u5e03\u5f0f\u5757\u5b58\u50a8RBD \u00b6 0\u3001 \u00b6 RBD\uff08RADOS Block Device\uff09 6.1\u3001RBD\u67b6\u6784 \u00b6 \u4e0a\u5c42\u5e94\u7528\u8bbf\u95eeRBD\u5757\u8bbe\u5907\u6709\u4e24\u79cd\u9014\u5f84\uff1a librbd\uff1a\u57fa\u4e8elibrados\u7684\u7528\u6237\u6001\u63a5\u53e3\u5e93 krbd\uff1a\u96c6\u6210\u5728GNU/Linux\u5185\u6838\u7684\u4e00\u4e2a\u5185\u6838\u6a21\u5757\uff0c\u901a\u8fc7\u7528\u6237\u6001\u7684rbd\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u53ef\u4ee5\u5c06RBD\u5757\u8bbe\u5907\u6620\u5c04\u4e3a\u672c\u5730\u7684\u4e00\u4e2a\u5757\u8bbe\u5907\u6587\u4ef6 6.2\u3001\u5b58\u50a8\u7ec4\u7ec7 \u00b6 0\u3001 \u00b6 RBD\u5757\u8bbe\u5907\u5728Ceph\u4e2d\u88ab\u79f0\u4e3aimage\u3002 image\u7531\u5143\u6570\u6570\u636e\u548c\u6570\u636e\u4e24\u90e8\u5206\u7ec4\u6210 v1\u683c\u5f0f\u7684image\uff0cv2\u683c\u5f0f\u7684image 6.2.1\u3001\u5143\u6570\u636e \u00b6 6.2.2\u3001\u6570\u636e \u00b6 6.3\u3001\u529f\u80fd\u7279\u6027 \u00b6 6.3.1\u3001\u5feb\u7167 \u00b6 6.3.2\u3001\u514b\u9686 \u00b6 6.4\u3001\u603b\u7ed3 \u00b6 chap7\u3001\u5bf9\u8c61\u5b58\u50a8\u7f51\u5173RGW \u00b6 7.1\u3001\u603b\u4f53\u67b6\u6784 \u00b6 7.2\u3001\u6570\u636e\u7ec4\u7ec7\u548c\u5b58\u50a8 \u00b6 7.2.1\u3001\u7528\u6237 \u00b6 7.2.2\u3001\u5b58\u50a8\u6876 \u00b6 7.2.3\u3001\u5bf9\u8c61 \u00b6 7.2.4\u3001\u6570\u636e\u5b58\u50a8\u4f4d\u7f6e \u00b6 7.3\u3001\u529f\u80fd\u5b9e\u73b0 \u00b6 7.3.1\u3001\u529f\u80fd\u7279\u6027 \u00b6 \u5bf9\u8c61\u5b58\u50a8\u6700\u57fa\u672c\u7684\u529f\u80fd\u5305\u62ec \u7528\u6237\u3001\u5b58\u50a8\u6876\u3001\u5bf9\u8c61\u7684\u589e\u5220\u6539\u67e5 RGW\u652f\u6301\u7684S3 API RGW\u652f\u6301\u7684Swift API RGW\u5e38\u7528\u7684Admin API Get Usage 7.3.2\u3001I/O\u8def\u5f84 \u00b6 0\u3001 op thread 1\u3001\u7528\u6237\u8ba4\u8bc1 2\u3001\u7528\u6237/\u5b58\u50a8\u6876/\u5bf9\u8c61\u8bbf\u95ee\u6743\u9650\u63a7\u5236 3\u3001bucket/\u7528\u6237\u914d\u989d 7.3.3\u3001\u5b58\u50a8\u6876\u521b\u5efa \u00b6 7.3.4\u3001\u5bf9\u8c61\u4e0a\u4f20 \u00b6 7.3.5\u3001\u5bf9\u8c61\u4e0b\u8f7d \u00b6 7.4\u3001\u603b\u7ed3\u4e0e\u5c55\u671b \u00b6 chap8\u3001\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edfCephFS \u00b6 0\u3001 CephFS\u57fa\u4e8eMDS\uff08MetaData Server\uff09\u5bf9\u5143\u6570\u636e\u8fdb\u884c\u7ba1\u7406 \u3002 8.1\u3001\u6587\u4ef6\u7cfb\u7edf\u57fa\u7840\u77e5\u8bc6 \u00b6 8.1.1\u3001\u6587\u4ef6\u7cfb\u7edf \u00b6 VFS 8.1.2\u3001\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u5143\u6570\u636e \u00b6 \u5b9a\u4e494\u79cd\u57fa\u672c\u6570\u636e\u7c7b\u578b\uff1a SuperBlock Inode Dentry File SuperBlock\u548cFile\u7528\u4e8e\u9762\u5411\u524d\u7aef\uff08\u5ba2\u6237\u7aef\uff09\u63d0\u4f9b\u670d\u52a1\uff0c\u800cInode\u548cDentry\u5219\u9700\u8981\u540e\u7aef\uff08\u670d\u52a1\u7aef\uff09\u6587\u4ef6\u7cfb\u7edf\u63d0\u4f9b\u670d\u52a1\u529f\u80fd \uff0c\u91cd\u70b9\u4ecb\u7ecd\u4e0b\u540e2\u8005 Inode Dentry 8.1.3\u3001\u786c\u94fe\u63a5\u548c\u8f6f\u94fe\u63a5 \u00b6 \u786c\u94fe\u63a5 \uff1a\u6307\u591a\u4e2a\u6587\u4ef6\u540d\u6307\u5411\u540c\u4e00\u4e2aInode\u53f7\uff0c \u76f8\u540c\u7684\u5b58\u50a8\u5185\u5bb9\u53ef\u4ee5\u5408\u9002\u4e0d\u540c\u7684\u6587\u4ef6\u540d \uff0c\u76ee\u5f55\u4e0d\u80fd\u7528\u6765\u521b\u5efa\u786c\u94fe\u63a5 \u8f6f\u94fe\u63a5 \uff1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684Inode\uff0c Inode\u5b58\u50a8\u7684\u5185\u5bb9\u662f\u53e6\u5916\u4e00\u4e2a\u6587\u4ef6\u8def\u5f84\u540d\u7684\u6307\u5411 8.1.4\u3001\u65e5\u5fd7 \u00b6 \u65e5\u5fd7\u6587\u4ef6\u7cfb\u7edf\uff0c\u5e38\u89c13\u79cd\u8bbe\u8ba1\u6a21\u5f0f writeback\u6a21\u5f0f ordered\u6a21\u5f0f data\u6a21\u5f0f\uff08writeahead\uff09 \u65e5\u5fd7\u63d0\u4ea4\u6709\u4e24\u79cd\u5e38\u89c1\u7684\u7b56\u7565\uff1a \u8d85\u65f6\u63d0\u4ea4 \u6ee1\u65f6\u63d0\u4ea4 8.2\u3001\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edfCephFS \u00b6 8.2.1\u3001CephFS\u8bbe\u8ba1\u6846\u67b6\u548c\u80cc\u666f \u00b6 \u4e3a\u4e86\u5b9e\u73b0\u6587\u4ef6\u7cfb\u7edf\u6570\u636e\uff08\u5305\u542b\u5143\u6570\u636e\u548c\u7528\u6237\u6570\u636e\uff09\u8d1f\u8f7d\u5747\u8861\uff0c\u4e1a\u754c\u6709\u5982\u4e0b\u51e0\u79cd\u5206\u533a\u65b9\u6cd5\uff1a \uff081\uff09\u9759\u6001\u5b50\u6811\u5206\u533a \uff082\uff09Hash\u8ba1\u7b97\u5206\u533a\u6cd5 \uff083\uff09\u52a8\u6001\u5b50\u6811\u5206\u533a CephFS\u4e00\u5171\u5b58\u5728\u5982\u4e0b\u4e09\u79cd\u5f62\u5f0f\u7684\u5ba2\u6237\u7aef\uff08\u63a5\u53e3\uff09\uff1a \uff081\uff09CephFS Kernel Object \uff082\uff09CephFS FUSE \uff083\uff09User Space Client 8.2.2\u3001MDS\u7684\u4f5c\u7528 \u00b6 MDS\u7528\u4e8e\u4fdd\u5b58CephFS\u7684\u5143\u6570\u636e\u4fe1\u606f\uff0c\u5b83\u662f\u8fd0\u884c\u5728Ceph\u670d\u52a1\u4fa7\u7684\u5b88\u62a4\u8fdb\u7a0b \uff0c\u4f7f\u7528\u52a8\u6001\u7533\u8bf7\u7f13\u5b58\u7a7a\u95f4\u6765\u5b58\u50a8\u5143\u6570\u636e\u4fe1\u606f\uff0c\u5176\u8bb0\u5f55\u7684\u5143\u6570\u636e\u9664\u4e86\u6587\u4ef6\u5728\u78c1\u76d8\u4e2d\u7684\u4f4d\u7f6e\uff0c\u8fd8\u5305\u62ec\u6587\u4ef6\u540d\u3001\u6587\u4ef6\u5c5e\u6027\u3001\u5f52\u5c5e\u76ee\u5f55\u3001\u5b50\u6811\u5206\u5272\u4ee5\u53ca\u8bf8\u5982\u5feb\u7167\u3001\u914d\u989d\u5728\u5185\u7684\u4e00\u4e9b\u9ad8\u7ea7\u7279\u6027\u3002 MDS\u5728\u8bbe\u8ba1\u548c\u5b9e\u73b0\u4e0a\u5177\u6709\u4ee5\u4e0b\u7279\u70b9\uff1a \u9996\u5148\uff0cCeph\u7684\u57fa\u672c\u5b58\u50a8\u5355\u5143\u662f\u5bf9\u8c61 \u5176\u6b21\uff0c\u6bcf\u4e2aMDS\u72ec\u7acb\u66f4\u65b0\u81ea\u5df1\u7684\u65e5\u5fd7 \u6700\u540e\uff0c\u52a8\u6001\u5b50\u6811\u5206\u533a\u5b9e\u73b0\u4e86\u6587\u4ef6\u7cfb\u7edf\u7684\u52a8\u6001\u8d1f\u8f7d\u5747\u8861 8.3\u3001MDS\u8bbe\u8ba1\u539f\u7406\u4e0e\u5b9e\u73b0 \u00b6 8.3.1\u3001MDS\u5143\u6570\u636e\u5b58\u50a8 \u00b6 0\u3001 MDS\u7684\u5143\u6570\u636e\u548c\u4e1a\u52a1\u6570\u636e\u90fd\u5b58\u50a8\u5728RADOS\u5bf9\u8c61\uff08\u7edf\u79f0\u4e3aObject\uff09\u4e2d \u3002 1\u3001\u5143\u6570\u636e\u4e0eObject\u7684\u5173\u7cfb 2\u3001\u5d4c\u5165\u5f0fInode\u548cPrimary Dentry 3\u3001Remote Dentry\u548cAnchor\u8868 4\u3001\u65e5\u5fd7 MDS\u7684\u65e5\u5fd7\u7cfb\u7edf\u4f7f\u7528\u5982\u4e0b\u6df7\u5408\u6a21\u5f0f 8.3.2\u3001MDS\u8d1f\u8f7d\u5747\u8861\u5b9e\u73b0 \u00b6 1\u3001\u5143\u6570\u636e\u8d1f\u8f7d\u5b9e\u73b0\u80cc\u666f 2\u3001\u76ee\u5f55\u5206\u7247 3\u3001\u5b50\u6811\u5206\u533a 4\u3001\u5143\u6570\u636e\u590d\u5236 5\u3001\u9501\u673a\u5236 6\u3001\u8d1f\u8f7d\u5747\u8861 7\u3001\u5b50\u6811\u8fc1\u79fb 8\u3001\u6d41\u91cf\u63a7\u5236 8.3.3\u3001MDS\u6545\u969c\u6062\u590d \u00b6 1\u3001\u65e5\u5fd7\u5728\u6545\u969c\u6062\u590d\u4e2d\u7684\u4f5c\u7528 2\u3001\u6545\u969c\u68c0\u6d4b 3\u3001MDS\u6062\u590d \uff081\uff09Replay \uff082\uff09Resolve \uff083\uff09Reconnect \uff084\uff09Rejoin 8.4\u3001\u603b\u7ed3\u4e0e\u5c55\u671b \u00b6","title":"\u300aceph\u8bbe\u8ba1\u539f\u7406\u4e0e\u5b9e\u73b0\u300b"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#chap1crush","text":"","title":"chap1\u3001\u57fa\u4e8e\u53ef\u6269\u5c55\u54c8\u5e0c\u7684\u53d7\u63a7\u526f\u672c\u5206\u5e03\u7b56\u7565CRUSH"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#0","text":"CRUSH\uff08Controlled Replication Under Scalable Hashing\uff09\uff0c \u57fa\u4e8e\u54c8\u5e0c\u7684\u6570\u636e\u5206\u5e03\u7b97\u6cd5","title":"0\u3001"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#11strawstraw2","text":"straw\u7b97\u6cd5\u6267\u884c\u7ed3\u679c\u53d6\u51b3\u4e8e\u4e09\u4e2a\u56e0\u7d20\uff1a \u56fa\u5b9a\u8f93\u5165\u3001\u5143\u7d20\u7f16\u53f7\u548c\u5143\u7d20\u6743\u91cd \u3002","title":"1.1\u3001straw\u53castraw2\u7b97\u6cd5\u7b80\u4ecb"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#12crush","text":"","title":"1.2\u3001CRUSH\u7b97\u6cd5\u8be6\u89e3"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#121-cluster-map","text":"","title":"1.2.1\u3001\u96c6\u7fa4\u7684\u5c42\u6b21\u5316\u63cf\u8ff0-Cluster Map"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#122-placement-rule","text":"+ \u6bcf\u6761placment rule\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u64cd\u4f5c\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u5171\u67093\u79cd\u7c7b\u578b + \uff081\uff09take + \uff082\uff09select + \uff083\uff09emit","title":"1.2.2\u3001\u6570\u636e\u5206\u5e03\u7b56\u7565--Placement Rule"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#13crush","text":"0\u3001 \u63d0\u5347CRUSH\u7684\u8ba1\u7b97\u6548\u7387","title":"1.3\u3001\u8c03\u5236CRUSH"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#131crush-map","text":"\uff081\uff09\u83b7\u53d6CRUSH map \uff082\uff09\u53cd\u7f16\u8bd1CRUSH map \uff083\uff09\u7f16\u8f91CRUSH map \uff084\uff09\u7f16\u8bd1CRUSH map \uff085\uff09\u6a21\u62df\u6d4b\u8bd5 \uff086\uff09\u6ce8\u5165\u96c6\u7fa4","title":"1.3.1\u3001\u7f16\u8f91CRUSH Map"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#132crush","text":"","title":"1.3.2\u3001\u5b9a\u5236CRUSH\u89c4\u5219"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#133","text":"","title":"1.3.3\u3001\u6570\u636e\u91cd\u5e73\u8861"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#14","text":"list\u548ctree\u7b97\u6cd5\u88ab\u5148\u540e\u5e9f\u5f03\uff0c\u539f\u521b\u7684straw\u7b97\u6cd5\u88ab\u5b8c\u5168\u91cd\u5199","title":"1.4\u3001\u603b\u7ed3\u4e0e\u5c55\u671b"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#chap2bluestore","text":"https://github.com/ceph/ceph/tree/main/src/os/bluestore 0\u3001","title":"chap2\u3001\u65b0\u578b\u5bf9\u8c61\u5b58\u50a8\u5f15\u64ceBlueStore"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#21","text":"\u5199\u4e2d\u95f4\u8bbe\u5907\u7684\u8fc7\u6e21\u8fc7\u7a0b\u79f0\u4e3a \u5199\u65e5\u5fd7 \uff0c\u4e2d\u95f4\u8bbe\u5907\u4e5f\u53eb \u65e5\u5fd7\u8bbe\u5907 \uff0c\u4e00\u822c\u53ef\u7531NVRAM\u6216\u8005SSD\u7b49\u9ad8\u901f\u5b58\u50a8\u8bbe\u5907\u5145\u5f53\u3002 \u51e0\u4e2a\u672f\u8bed block-size\uff08\u5757\u5927\u5c0f\uff09 RMW\uff08Read Modify Write\uff09 COW\uff08Copy-On-Write\uff09 BlueStore\u9488\u5bf9\u5199\u64cd\u4f5c\u7efc\u5408\u8fd0\u7528\u4e86RMW\u548cCOW\u7b56\u7565-\u4efb\u4f55\u4e00\u4e2a\u5199\u8bf7\u6c42\uff0c\u6839\u636e\u78c1\u76d8\u5757\u5927\u5c0f\uff0c\u5c06\u5176\u5207\u5206\u4e3a\u4e09\u4e2a\u90e8\u5206\uff1a \u9996\u5c3e\u975e\u5757\u5927\u5c0f\u5bf9\u9f50\u90e8\u5206\u548c\u4e2d\u95f4\u5757\u5927\u5c0f\u5bf9\u9f50\u90e8\u5206 \u7136\u540e\u9488\u5bf9\u4e2d\u95f4\u5757\u5bf9\u9f50\u90e8\u5206\u91c7\u7528COW\u7b56\u7565 \u9996\u5c3e\u975e\u5757\u5bf9\u9f50\u90e8\u5206\u91c7\u7528RMW\u7b56\u7565","title":"2.1\u3001\u8bbe\u8ba1\u7406\u5ff5\u4e0e\u6307\u5bfc\u539f\u5219"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#22","text":"0\u3001 **BuleStore\u4e2d\u4e60\u60ef\u4e0a\u78c1\u76d8\u683c\u5f0f\u4ee5\" _t \"\u7ed3\u5c3e\u5e76\u4e14\u5168\u90e8\u5c0f\u5199\uff0c\u800c\u5185\u5b58\u683c\u5f0f\u4e0d\u4ee5\" \\t \"\u7ed3\u5c3e\u5e76\u4e14\u53ea\u6709\u9996\u5b57\u6bcd\u5927\u5199\u3002","title":"2.2\u3001\u78c1\u76d8\u6570\u636e\u7ed3\u6784"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#221pg","text":"Ceph\u5e76\u4e0d\u662f\u5c06\u4efb\u4f55\u4e0a\u5c42\u6570\u636e\u4e00\u6b65\u5230\u4f4d\u6620\u5c04\u5230\u78c1\u76d8\uff08OSD\uff09\uff0c\u800c\u662f\u5f15\u5165\u4e86\u4e00\u4e2a\u4e2d\u95f4\u7ed3\u6784\uff0c\u79f0\u4e3a PG\uff0c\u5b9e\u73b0\u4e24\u7ea7\u6620\u5c04 \u7b2c\u4e00\u7ea7\u6620\u5c04\u662f\u9759\u6001\u7684 \u7b2c\u4e8c\u7ea7\u6620\u5c04\u5b9e\u73b0PG\u5230OSD\u7684\u6620\u5c04\uff0c \u4ecd\u7136\u91c7\u7528\u4f2a\u968f\u673a\u54c8\u5e0c\u51fd\u6570 PG\u5bf9\u5e94\u7684\u78c1\u76d8\u7ed3\u6784\u79f0\u4e3a bluestore_cnode_t","title":"2.2.1\u3001PG"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#222","text":"extent\u662f\u5bf9\u8c61\u5185\u7684\u57fa\u672c\u6570\u636e\u7ba1\u7406\u5355\u5143\uff0c\u4e0b\u9762\u5206\u522b\u4e88\u4ee5\u9610\u8ff0\uff1a \u6570\u636e\u6821\u9a8c \u6570\u636e\u538b\u7f29 \u6570\u636e\u5171\u4eab","title":"2.2.2\u3001\u5bf9\u8c61"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#23","text":"","title":"2.3\u3001\u7f13\u5b58\u7ba1\u7406"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#231","text":"","title":"2.3.1\u3001\u5e38\u89c1\u7684\u7f13\u5b58\u6dd8\u6c70\u7b97\u6cd5"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#232bluestore","text":"2\u7c7b\u578b\u7684\u7f13\u5b58\u7b97\u6cd5 LRU 2Q\uff1a \u7c7b\u4f3c\u4e8e\u7b80\u5316\u7248\u672cARC \uff0c\u533a\u522b\u5728\u4e8e\u53ea\u4f7f\u7528\u4e00\u4e2a\u5f71\u5b50\u961f\u5217","title":"2.3.2\u3001BlueStore\u4e2d\u7684\u7f13\u5b58\u7ba1\u7406"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#24","text":"","title":"2.4\u3001\u78c1\u76d8\u7a7a\u95f4\u7ba1\u7406"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#241","text":"","title":"2.4.1\u3001\u5e38\u89c1\u78c1\u76d8\u7a7a\u95f4\u7ba1\u7406\u6a21\u5f0f"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#242bitmapfreelistmanager","text":"","title":"2.4.2\u3001BitmapFreelistManager"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#243bitmapallocator","text":"","title":"2.4.3\u3001BitmapAllocator"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#25bluefs","text":"","title":"2.5\u3001BlueFs"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#251rocksdbbulefs","text":"","title":"2.5.1\u3001RocksDB\u4e0eBuleFs"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#252","text":"","title":"2.5.2\u3001\u78c1\u76d8\u6570\u636e\u7ed3\u6784"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#253","text":"","title":"2.5.3\u3001\u5757\u8bbe\u5907"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#26","text":"","title":"2.6\u3001\u5b9e\u73b0\u539f\u7406"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#261mkfs","text":"mkfs\u4e3b\u8981\u56fa\u5316\u4e00\u4e9b\u7528\u6237\u6307\u5b9a\u7684\u914d\u7f6e\u9879\u5230\u78c1\u76d8\uff0c\u8fd9\u6837\u540e\u7eedBlueStore\u4e0a\u7535\u65f6\uff0c\u8fd9\u4e9b\u914d\u7f6e\u9879\u5c06\u76f4\u63a5\u4ece\u78c1\u76d8\u8bfb\u53d6 \u3002","title":"2.6.1\u3001mkfs"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#262mount","text":"OSD\u8fdb\u7a0b\u4e0a\u7535\u65f6\uff0cBlueStore\u901a\u8fc7mount\u64cd\u4f5c\u5b8c\u6210\u6b63\u5e38\u4e0a\u7535\u524d\u7684\u68c0\u67e5\u548c\u51c6\u5907\u5de5\u4f5c\u3002 mount\u64cd\u4f5c\u5305\u542b\u4ee5\u4e0b\u51e0\u4e2a\u6b65\u9aa4 \uff1a 1\u3001\u6821\u9a8cObjectStore\u7c7b\u578b 2\u3001fsck\u6216\u8005deep-fsck 3\u3001\u52a0\u8f7d\u5e76\u9501\u5b9afsid 4\u3001\u52a0\u8f7d\u4e3b\u5757\u8bbe\u5907 5\u3001\u52a0\u8f7d\u6570\u636e\u5e93\uff0c\u8bfb\u53d6\u5143\u6570\u636e 6\u3001\u52a0\u8f7dCollection","title":"2.6.2\u3001mount"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#263read","text":"","title":"2.6.3\u3001read"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#264write","text":"","title":"2.6.4\u3001write"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#27","text":"","title":"2.7\u3001\u4f7f\u7528\u6307\u5357"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#271bluestore","text":"","title":"2.7.1\u3001\u90e8\u7f72BlueStore"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#272","text":"","title":"2.7.2\u3001\u914d\u7f6e\u53c2\u6570"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#28","text":"","title":"2.8\u3001\u603b\u7ed3\u4e0e\u5c55\u671b"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#chap3overwrites","text":"","title":"chap3\u3001\u7ea0\u5220\u7801\u539f\u7406\u4e0eoverwrites\u652f\u6301"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#0_1","text":"\u7ea0\u5220\u7801\uff08Erasure Coding\uff09 \u7ea0\u5220\u7801\u6700\u7b80\u5355\u7684\u5b9e\u73b0\u65b9\u5f0f\u662f\u5b8c\u5168\u590d\u5236\uff0c\u4e5f\u79f0\u4e3a\u955c\u50cf\uff0c \u5c06\u6570\u636e\u4e0d\u505a\u4efb\u4f55\u5904\u7406\u540c\u65f6\u5199\u5165\u591a\u4e2a\u4e0d\u540c\u7684\u5b58\u50a8\u4ecb\u8d28 \u3002 overwrites\u6280\u672f\uff08\u8986\u76d6\u5199\uff09","title":"0\u3001"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#31raid","text":"\u6570\u636e\u5b58\u50a8\u5728\u5355\u4e2a\u78c1\u76d8\u4e0a\uff0c\u5b58\u5728\u4e00\u4e9b\u56fa\u6709\u7f3a\u9677 \u8bbf\u95ee\u901f\u5ea6\u6162 \u5bb9\u91cf\u5c0f \u5b89\u5168\u6027\u5dee \u4e3b\u6d41\u7684RAID\u6280\u672f RAID0 RAID1 RAID5 RAID6","title":"3.1\u3001RAID\u6280\u672f\u6982\u8ff0"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#32rs-raidjerasure","text":"0\u3001","title":"3.2\u3001RS-RAID\u548cJerasure"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#321","text":"","title":"3.2.1\u3001\u8ba1\u7b97\u6821\u9a8c\u548c"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#322","text":"","title":"3.2.2\u3001\u6570\u636e\u6062\u590d"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#323","text":"","title":"3.2.3\u3001\u7b97\u672f\u8fd0\u7b97"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#324","text":"","title":"3.2.4\u3001\u7f3a\u9677\u4e0e\u6539\u8fdb"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#325jerasure","text":"","title":"3.2.5\u3001Jerasure"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#33ceph","text":"","title":"3.3\u3001\u7ea0\u5220\u7801\u5728Ceph\u4e2d\u7684\u5e94\u7528"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#331","text":"","title":"3.3.1\u3001\u672f\u8bed"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#332","text":"","title":"3.3.2\u3001\u6982\u8ff0"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#333","text":"","title":"3.3.3\u3001\u65b0\u5199"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#334","text":"","title":"3.3.4\u3001\u8bfb"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#335","text":"","title":"3.3.5\u3001\u8986\u76d6\u5199"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#336","text":"","title":"3.3.6\u3001\u65e5\u5fd7"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#337scrub","text":"","title":"3.3.7\u3001Scrub"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#34","text":"","title":"3.4\u3001\u603b\u7ed3\u4e0e\u5c55\u671b"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#chap5qos","text":"","title":"chap5\u3001\u5b58\u50a8\u670d\u52a1\u8d28\u91cfQoS"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#0_2","text":"dmClock\u7528\u4e8e\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684I/O\u8c03\u5ea6\u7b97\u6cd5\uff0c\uff08Handling Throughput Variablity for Hypervisor IO Scheduling\uff09","title":"0\u3001"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#51","text":"BTRFS Q-EBOFS\uff1a \u6ca1\u6709\u88abCeph\u91c7\u7528 \u5728BTRFS\u539f\u6709\u78c1\u76d8\u8c03\u5ea6\u961f\u5217\u4e2d\uff0c\u5f15\u5165\u4e86\u4e00\u5c42\u5ba2\u6237\u7aef\u7ea7\u522b\u7684\u65b0\u961f\u5217\uff0c\u91c7\u7528\u57fa\u4e8e\u6743\u91cd\u7684\u8f6e\u8be2\u673a\u5236\uff0c\u5c06\u4e0d\u540c\u5ba2\u6237\u7aef\u961f\u5217\u4e2d\u7684\u8bf7\u6c42\u5206\u53d1\u81f3\u78c1\u76d8\u8c03\u5ea6\u961f\u5217\uff0c\u4ece\u800c\u5728\u5355\u4e2aOSD\u5c42\u9762\u5b9e\u73b0\u5bf9\u4e0d\u540c\u5ba2\u6237\u7aef\u6309\u5176\u6743\u91cd\u5206\u914dI/O\u8d44\u6e90\u7684\u76ee\u6807\u3002","title":"5.1\u3001\u7814\u7a76\u73b0\u72b6"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#52dmclock","text":"","title":"5.2\u3001dmClock\u7b97\u6cd5\u539f\u7406"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#521mclock","text":"\u57fa\u4e8e\u65f6\u95f4\u6807\u7b7e\u7684I/O\u8c03\u5ea6\u7b97\u6cd5\u3002 mClock\u57fa\u672c\u539f\u7406\u4e3b\u8981\u5305\u542b\u4e09\u4e2a\u65b9\u9762\uff1a \u4e3a\u6bcf\u4e2a\u5ba2\u6237\u7aef\u8bbe\u7f6e\u4e00\u5957QoS\u6a21\u677f\u53c2\u6570\uff0c\u5305\u62ec\u9884\u7559\uff08r\uff09\u3001\u6743\u91cd\uff08w\uff09\u548c\u4e0a\u9650\uff08l\uff09 \u670d\u52a1\u7aef\u5206\u4e24\u4e2a\u9636\u6bb5\u6765\u5904\u7406I/O\u8bf7\u6c42\uff1a \u4e00\u662f\u57fa\u4e8e\u5f3a\u5236\u7684Constraint-based\u9636\u6bb5 \u4e8c\u662f\u57fa\u4e8e\u6743\u91cd\u7684Weight-based\u9636\u6bb5 \u670d\u52a1\u7aef\u4f18\u5148\u5de5\u4f5c\u4e8eConstraint-based\u9636\u6bb5","title":"5.2.1\u3001mClock"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#522dmclock","text":"\u662fmClock\u7b97\u6cd5\u7684\u5206\u5e03\u5f0f\u7248\u672c\uff0c \u4e24\u8005\u7684\u57fa\u672c\u539f\u7406\u76f8\u540c dmClock\u548cmClock\u7684\u5dee\u522b\uff1a \u5206\u5e03\u5f0f\u7cfb\u7edf\u5177\u6709\u591a\u4e2a\u670d\u52a1\u5668 \u5ba2\u6237\u7aef\u8bb0\u5f55\u6bcf\u4e2a\u670d\u52a1\u5668\u5b8c\u6210\u7684\u8bf7\u6c42\u4e2a\u6570 \u670d\u52a1\u7aef\u8ba1\u7b97\u8bf7\u6c42\u7684\u65f6\u95f4\u6807\u7b7e\u65f6\uff0c","title":"5.2.2\u3001dmClock"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#53qos","text":"","title":"5.3\u3001QoS\u7684\u8bbe\u8ba1\u4e0e\u5b9e\u73b0"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#0_3","text":"\u901a\u5e38\u5c06QoS\u7684\u5b9e\u73b0\u7f6e\u4e8e\u6bcf\u4e2aOSD\u4e2d \uff0c\u6bcf\u4e2aOSD\u901a\u8fc7\u4e00\u4e2a\u79f0\u4e3a ShardedOpWQ\u7684\u5de5\u4f5c\u961f\u5217","title":"0\u3001"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#531prio","text":"\u5165\u961f \u51fa\u961f","title":"5.3.1\u3001\u4f18\u5148\u7ea7\u961f\u5217\uff08prio\uff09"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#532wpq","text":"\u57fa\u4e8e\u6743\u91cd\u7684\u4f18\u5148\u7ea7\u961f\u5217\u4e0ePrioritizedQueue\u7684\u961f\u5217\u7ed3\u6784\u7c7b\u4f3c\uff0c\u540c\u6837\u5206\u4e3a\u4f18\u5148\u7ea7prio\u3001\u5ba2\u6237\u7aefclient\u4ee5\u53ca\u771f\u5b9e\u7684\u8bf7\u6c42list\u4e09\u4e2a\u7ea7\u522b\u3002 \u8bf7\u6c42\u7684\u51fa\u961f\u673a\u5236\uff1a \u91c7\u7528\u6743\u91cd\u6982\u7387\u7684\u65b9\u5f0f\u786e\u5b9aprio\u7ea7\u522b \u88ab\u9009\u4e2d\u7684prio\u961f\u5217\u5e76\u4e0d\u5b9a\u80fd\u51fa\u961f\u8bf7\u6c42 client\u7ea7\u522b\u548c\u771f\u5b9e\u8bf7\u6c42\u7684\u9009\u62e9\u91c7\u7528\u4e0ePrioritizedQueue\u76f8\u540c\u7684\u65b9\u5f0f\uff0c\u5206\u522b\u4e3a \u8f6e\u8be2\u548cFIFO\u7b56\u7565","title":"5.3.2\u3001\u6743\u91cd\u7684\u4f18\u5148\u7ea7\u961f\u5217\uff08wpq\uff09"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#533dmclock","text":"dmClock\u662f\u4e00\u4e2a\u4e24\u7ea7\u6620\u5c04\u961f\u5217\uff0c\u7b2c\u4e00\u7ea7\u4e3a\u5ba2\u6237\u7aef\u7684client\u961f\u5217\uff0c\u7b2c\u4e8c\u7ea7\u4e3a\u771f\u5b9e\u7684\u8bf7\u6c42\u961f\u5217\uff0c\u6bcf\u4e2a\u8bf7\u6c42\u5305\u542b\u4e09\u4e2a\u65f6\u95f4\u6807\u7b7e <RWL> dmClock\u91c7\u7528\u5b8c\u5168\u4e8c\u53c9\u6811\u6765\u7ec4\u7ec7\u7ba1\u7406","title":"5.3.3\u3001dmClock\u961f\u5217"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#534client","text":"","title":"5.3.4\u3001Client\u7684\u8bbe\u8ba1"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#54","text":"\u53ef\u80fd\u7684\u6539\u8fdb\u65b9\u5411\u5305\u62ec\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\uff1a 1\u3001\u5408\u7406\u6a21\u677f\u53c2\u6570\u7684\u8bbe\u7f6e 2\u3001I/O\u5e26\u5bbd\u7684\u9650\u5236 3\u3001\u7a81\u53d1I/O\u7684\u5904\u7406","title":"5.4\u3001\u603b\u7ed3\u4e0e\u5c55\u671b"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#chap6rbd","text":"","title":"chap6\u3001\u5206\u5e03\u5f0f\u5757\u5b58\u50a8RBD"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#0_4","text":"RBD\uff08RADOS Block Device\uff09","title":"0\u3001"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#61rbd","text":"\u4e0a\u5c42\u5e94\u7528\u8bbf\u95eeRBD\u5757\u8bbe\u5907\u6709\u4e24\u79cd\u9014\u5f84\uff1a librbd\uff1a\u57fa\u4e8elibrados\u7684\u7528\u6237\u6001\u63a5\u53e3\u5e93 krbd\uff1a\u96c6\u6210\u5728GNU/Linux\u5185\u6838\u7684\u4e00\u4e2a\u5185\u6838\u6a21\u5757\uff0c\u901a\u8fc7\u7528\u6237\u6001\u7684rbd\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u53ef\u4ee5\u5c06RBD\u5757\u8bbe\u5907\u6620\u5c04\u4e3a\u672c\u5730\u7684\u4e00\u4e2a\u5757\u8bbe\u5907\u6587\u4ef6","title":"6.1\u3001RBD\u67b6\u6784"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#62","text":"","title":"6.2\u3001\u5b58\u50a8\u7ec4\u7ec7"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#0_5","text":"RBD\u5757\u8bbe\u5907\u5728Ceph\u4e2d\u88ab\u79f0\u4e3aimage\u3002 image\u7531\u5143\u6570\u6570\u636e\u548c\u6570\u636e\u4e24\u90e8\u5206\u7ec4\u6210 v1\u683c\u5f0f\u7684image\uff0cv2\u683c\u5f0f\u7684image","title":"0\u3001"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#621","text":"","title":"6.2.1\u3001\u5143\u6570\u636e"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#622","text":"","title":"6.2.2\u3001\u6570\u636e"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#63","text":"","title":"6.3\u3001\u529f\u80fd\u7279\u6027"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#631","text":"","title":"6.3.1\u3001\u5feb\u7167"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#632","text":"","title":"6.3.2\u3001\u514b\u9686"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#64","text":"","title":"6.4\u3001\u603b\u7ed3"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#chap7rgw","text":"","title":"chap7\u3001\u5bf9\u8c61\u5b58\u50a8\u7f51\u5173RGW"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#71","text":"","title":"7.1\u3001\u603b\u4f53\u67b6\u6784"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#72","text":"","title":"7.2\u3001\u6570\u636e\u7ec4\u7ec7\u548c\u5b58\u50a8"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#721","text":"","title":"7.2.1\u3001\u7528\u6237"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#722","text":"","title":"7.2.2\u3001\u5b58\u50a8\u6876"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#723","text":"","title":"7.2.3\u3001\u5bf9\u8c61"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#724","text":"","title":"7.2.4\u3001\u6570\u636e\u5b58\u50a8\u4f4d\u7f6e"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#73","text":"","title":"7.3\u3001\u529f\u80fd\u5b9e\u73b0"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#731","text":"\u5bf9\u8c61\u5b58\u50a8\u6700\u57fa\u672c\u7684\u529f\u80fd\u5305\u62ec \u7528\u6237\u3001\u5b58\u50a8\u6876\u3001\u5bf9\u8c61\u7684\u589e\u5220\u6539\u67e5 RGW\u652f\u6301\u7684S3 API RGW\u652f\u6301\u7684Swift API RGW\u5e38\u7528\u7684Admin API Get Usage","title":"7.3.1\u3001\u529f\u80fd\u7279\u6027"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#732io","text":"0\u3001 op thread 1\u3001\u7528\u6237\u8ba4\u8bc1 2\u3001\u7528\u6237/\u5b58\u50a8\u6876/\u5bf9\u8c61\u8bbf\u95ee\u6743\u9650\u63a7\u5236 3\u3001bucket/\u7528\u6237\u914d\u989d","title":"7.3.2\u3001I/O\u8def\u5f84"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#733","text":"","title":"7.3.3\u3001\u5b58\u50a8\u6876\u521b\u5efa"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#734","text":"","title":"7.3.4\u3001\u5bf9\u8c61\u4e0a\u4f20"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#735","text":"","title":"7.3.5\u3001\u5bf9\u8c61\u4e0b\u8f7d"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#74","text":"","title":"7.4\u3001\u603b\u7ed3\u4e0e\u5c55\u671b"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#chap8cephfs","text":"0\u3001 CephFS\u57fa\u4e8eMDS\uff08MetaData Server\uff09\u5bf9\u5143\u6570\u636e\u8fdb\u884c\u7ba1\u7406 \u3002","title":"chap8\u3001\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edfCephFS"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#81","text":"","title":"8.1\u3001\u6587\u4ef6\u7cfb\u7edf\u57fa\u7840\u77e5\u8bc6"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#811","text":"VFS","title":"8.1.1\u3001\u6587\u4ef6\u7cfb\u7edf"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#812","text":"\u5b9a\u4e494\u79cd\u57fa\u672c\u6570\u636e\u7c7b\u578b\uff1a SuperBlock Inode Dentry File SuperBlock\u548cFile\u7528\u4e8e\u9762\u5411\u524d\u7aef\uff08\u5ba2\u6237\u7aef\uff09\u63d0\u4f9b\u670d\u52a1\uff0c\u800cInode\u548cDentry\u5219\u9700\u8981\u540e\u7aef\uff08\u670d\u52a1\u7aef\uff09\u6587\u4ef6\u7cfb\u7edf\u63d0\u4f9b\u670d\u52a1\u529f\u80fd \uff0c\u91cd\u70b9\u4ecb\u7ecd\u4e0b\u540e2\u8005 Inode Dentry","title":"8.1.2\u3001\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u5143\u6570\u636e"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#813","text":"\u786c\u94fe\u63a5 \uff1a\u6307\u591a\u4e2a\u6587\u4ef6\u540d\u6307\u5411\u540c\u4e00\u4e2aInode\u53f7\uff0c \u76f8\u540c\u7684\u5b58\u50a8\u5185\u5bb9\u53ef\u4ee5\u5408\u9002\u4e0d\u540c\u7684\u6587\u4ef6\u540d \uff0c\u76ee\u5f55\u4e0d\u80fd\u7528\u6765\u521b\u5efa\u786c\u94fe\u63a5 \u8f6f\u94fe\u63a5 \uff1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684Inode\uff0c Inode\u5b58\u50a8\u7684\u5185\u5bb9\u662f\u53e6\u5916\u4e00\u4e2a\u6587\u4ef6\u8def\u5f84\u540d\u7684\u6307\u5411","title":"8.1.3\u3001\u786c\u94fe\u63a5\u548c\u8f6f\u94fe\u63a5"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#814","text":"\u65e5\u5fd7\u6587\u4ef6\u7cfb\u7edf\uff0c\u5e38\u89c13\u79cd\u8bbe\u8ba1\u6a21\u5f0f writeback\u6a21\u5f0f ordered\u6a21\u5f0f data\u6a21\u5f0f\uff08writeahead\uff09 \u65e5\u5fd7\u63d0\u4ea4\u6709\u4e24\u79cd\u5e38\u89c1\u7684\u7b56\u7565\uff1a \u8d85\u65f6\u63d0\u4ea4 \u6ee1\u65f6\u63d0\u4ea4","title":"8.1.4\u3001\u65e5\u5fd7"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#82cephfs","text":"","title":"8.2\u3001\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edfCephFS"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#821cephfs","text":"\u4e3a\u4e86\u5b9e\u73b0\u6587\u4ef6\u7cfb\u7edf\u6570\u636e\uff08\u5305\u542b\u5143\u6570\u636e\u548c\u7528\u6237\u6570\u636e\uff09\u8d1f\u8f7d\u5747\u8861\uff0c\u4e1a\u754c\u6709\u5982\u4e0b\u51e0\u79cd\u5206\u533a\u65b9\u6cd5\uff1a \uff081\uff09\u9759\u6001\u5b50\u6811\u5206\u533a \uff082\uff09Hash\u8ba1\u7b97\u5206\u533a\u6cd5 \uff083\uff09\u52a8\u6001\u5b50\u6811\u5206\u533a CephFS\u4e00\u5171\u5b58\u5728\u5982\u4e0b\u4e09\u79cd\u5f62\u5f0f\u7684\u5ba2\u6237\u7aef\uff08\u63a5\u53e3\uff09\uff1a \uff081\uff09CephFS Kernel Object \uff082\uff09CephFS FUSE \uff083\uff09User Space Client","title":"8.2.1\u3001CephFS\u8bbe\u8ba1\u6846\u67b6\u548c\u80cc\u666f"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#822mds","text":"MDS\u7528\u4e8e\u4fdd\u5b58CephFS\u7684\u5143\u6570\u636e\u4fe1\u606f\uff0c\u5b83\u662f\u8fd0\u884c\u5728Ceph\u670d\u52a1\u4fa7\u7684\u5b88\u62a4\u8fdb\u7a0b \uff0c\u4f7f\u7528\u52a8\u6001\u7533\u8bf7\u7f13\u5b58\u7a7a\u95f4\u6765\u5b58\u50a8\u5143\u6570\u636e\u4fe1\u606f\uff0c\u5176\u8bb0\u5f55\u7684\u5143\u6570\u636e\u9664\u4e86\u6587\u4ef6\u5728\u78c1\u76d8\u4e2d\u7684\u4f4d\u7f6e\uff0c\u8fd8\u5305\u62ec\u6587\u4ef6\u540d\u3001\u6587\u4ef6\u5c5e\u6027\u3001\u5f52\u5c5e\u76ee\u5f55\u3001\u5b50\u6811\u5206\u5272\u4ee5\u53ca\u8bf8\u5982\u5feb\u7167\u3001\u914d\u989d\u5728\u5185\u7684\u4e00\u4e9b\u9ad8\u7ea7\u7279\u6027\u3002 MDS\u5728\u8bbe\u8ba1\u548c\u5b9e\u73b0\u4e0a\u5177\u6709\u4ee5\u4e0b\u7279\u70b9\uff1a \u9996\u5148\uff0cCeph\u7684\u57fa\u672c\u5b58\u50a8\u5355\u5143\u662f\u5bf9\u8c61 \u5176\u6b21\uff0c\u6bcf\u4e2aMDS\u72ec\u7acb\u66f4\u65b0\u81ea\u5df1\u7684\u65e5\u5fd7 \u6700\u540e\uff0c\u52a8\u6001\u5b50\u6811\u5206\u533a\u5b9e\u73b0\u4e86\u6587\u4ef6\u7cfb\u7edf\u7684\u52a8\u6001\u8d1f\u8f7d\u5747\u8861","title":"8.2.2\u3001MDS\u7684\u4f5c\u7528"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#83mds","text":"","title":"8.3\u3001MDS\u8bbe\u8ba1\u539f\u7406\u4e0e\u5b9e\u73b0"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#831mds","text":"0\u3001 MDS\u7684\u5143\u6570\u636e\u548c\u4e1a\u52a1\u6570\u636e\u90fd\u5b58\u50a8\u5728RADOS\u5bf9\u8c61\uff08\u7edf\u79f0\u4e3aObject\uff09\u4e2d \u3002 1\u3001\u5143\u6570\u636e\u4e0eObject\u7684\u5173\u7cfb 2\u3001\u5d4c\u5165\u5f0fInode\u548cPrimary Dentry 3\u3001Remote Dentry\u548cAnchor\u8868 4\u3001\u65e5\u5fd7 MDS\u7684\u65e5\u5fd7\u7cfb\u7edf\u4f7f\u7528\u5982\u4e0b\u6df7\u5408\u6a21\u5f0f","title":"8.3.1\u3001MDS\u5143\u6570\u636e\u5b58\u50a8"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#832mds","text":"1\u3001\u5143\u6570\u636e\u8d1f\u8f7d\u5b9e\u73b0\u80cc\u666f 2\u3001\u76ee\u5f55\u5206\u7247 3\u3001\u5b50\u6811\u5206\u533a 4\u3001\u5143\u6570\u636e\u590d\u5236 5\u3001\u9501\u673a\u5236 6\u3001\u8d1f\u8f7d\u5747\u8861 7\u3001\u5b50\u6811\u8fc1\u79fb 8\u3001\u6d41\u91cf\u63a7\u5236","title":"8.3.2\u3001MDS\u8d1f\u8f7d\u5747\u8861\u5b9e\u73b0"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#833mds","text":"1\u3001\u65e5\u5fd7\u5728\u6545\u969c\u6062\u590d\u4e2d\u7684\u4f5c\u7528 2\u3001\u6545\u969c\u68c0\u6d4b 3\u3001MDS\u6062\u590d \uff081\uff09Replay \uff082\uff09Resolve \uff083\uff09Reconnect \uff084\uff09Rejoin","title":"8.3.3\u3001MDS\u6545\u969c\u6062\u590d"},{"location":"12storage/ceph%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/#84","text":"","title":"8.4\u3001\u603b\u7ed3\u4e0e\u5c55\u671b"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/","text":"\u5185\u5bb9 \u00b6 day10\u3001\u7f51\u7edc\u7f16\u7a0b\u57fa\u7840socket \u00b6 01\u3001\u77e5\u8bc6\u70b9\u6982\u8ff0\uff0820200401\uff09 \u00b6 \u7b2c8-10\u5929\uff0c\u81ea\u5df1\u5b9e\u73b0\u4e00\u4e2aMini Web\u670d\u52a1\u5668\uff08\u6709\u4e24\u4e2a\u529f\u80fd\uff09 \u5904\u7406\u7f51\u7edcI/O \u4e1a\u52a1\u5904\u7406 02\u3001\u7f51\u7edc\u5f00\u53d1\u4e24\u79cd\u8bbe\u8ba1\u6a21\u5f0f\uff08\uff09 \u00b6 03\u3001\u7f51\u7edc\u6a21\u578b\u5206\u5c42\uff08\uff09 \u00b6 04\u3001\u4ee5\u592a\u7f51\u5e27\u534f\u8bae\uff08\uff09 \u00b6 05\u3001IP\u534f\u8bae\uff08\uff09 \u00b6 06\u3001UDP\u534f\u8bae\uff08\uff09 \u00b6 07\u3001TCP\u534f\u8bae\uff08\uff09 \u00b6 08\u3001TCP-IP\u56db\u5c42\u6a21\u578b\u534f\u8bae\u5c01\u88c5\uff08\uff09 \u00b6 09\u3001UDP\u548cTCP\u8bb2\u89e3\uff08\uff09 \u00b6 10\u3001\u4ec0\u4e48\u662f\u5957\u63a5\u5b57\uff0820200401\uff09 \u00b6 Socket\u662f\u7f51\u7edc\u901a\u4fe1\u7684\u51fd\u6570\u63a5\u53e3\u7684\u603b\u79f0 \uff0c\u5c01\u88c5\u4e86\u4f20\u8f93\u5c42\u7684\u534f\u8bae\uff08TCP\uff0cUDP\uff09\u3002 \u6d4f\u89c8\u5668\uff0c\u5e94\u7528\u5c42\u7528\u7684\u662fHTTP\uff0c\u5f80\u4e0b\u5c01\u88c5\u7684\u662fTCP\u3002 Socket\uff1aIP+Port\u3002 11\u3001\u5957\u63a5\u5b57\u5185\u5b58\u6a21\u578b\uff0820200401\uff09 \u00b6 socket\u901a\u4fe1 \u670d\u52a1\u5668\u7aef\uff08\u63d2\u5ea7\uff09 \u88ab\u52a8 \u8ba9\u5ba2\u6237\u7aef\u8fde\u63a5\uff1b \u5ba2\u6237\u7aef\uff08\u7535\u98ce\u6247\u3001\u7535\u89c6\uff09 \u4e3b\u52a8 socket\u7f16\u7a0b-- \u7f51\u7edcIO\u7f16\u7a0b \u8bfb\u5199\u64cd\u4f5c\uff08read/wirte) \u6587\u4ef6\u63cf\u8ff0\u7b26 \u521b\u5efa\u4e00\u4e2a\u5957\u63a5\u5b57\uff0c\u5f97\u5230\u7684\u662f\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c \u8fd9\u4e2afd\u4e5f\u662f\u4e00\u5757\u5185\u6838\u7f13\u51b2\u533a \u5185\u6838\u7f13\u51b2\u533a\u5206\u4e3a\u4e24\u90e8\u5206\uff08\u8bfb\u7f13\u51b2\u533a\uff0c\u5199\u7f13\u51b2\u533a\uff09 \uff0c\u8fd9\u662f\u7cfb\u7edf\u5904\u7406\u597d\u7684\uff0c\u4e0d\u7528\u5e94\u7528\u7a0b\u5e8f\u5173\u5fc3\u3002 \u5ba2\u6237\u7aef\u7684\u6570\u636e\u5148write\u5230\u5199\u7f13\u51b2\u533a\uff0c\u7136\u540e\u4f1a\u5230\u540c\u6b65\u5230\u670d\u52a1\u7aef\u7684\u8bfb\u7f13\u51b2\u533a\u91cc\uff0c\u670d\u52a1\u7aeffd\u91cc\u7684\u5199\u7f13\u51b2\u533a\u4e5f\u4e00\u6837\u3002 \u4e0e\u533f\u540d\u7ba1\u9053\u7684\u533a\u522b\uff1f \u9ed8\u8ba4\u662f\u963b\u585e\u7684 \uff0c\u5bf9\u5e94\u7684\u662ffd\u7684\u8bbe\u5907\u7684\u6587\u4ef6\u6027\u8d28\uff0c\u4e0d\u662fwirte(),read()\u51fd\u6570\u7684\u6027\u8d28\u3002 \u533f\u540d\u7ba1\u9053 \u5206\u4e3a\u8bfb\u3001\u5199\u4e24\u7aef \u961f\u5217 \u6570\u636e\u7ed3\u6784 \u7ba1\u9053\u7684\u8bfb\u5199\u4e24\u7aef\u5206\u522b\u5bf9\u5e94\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26 \u5185\u6838\u7f13\u51b2\u533a\uff08\u5185\u5b58\u4e2d\u4e00\u5757\u5b58\u50a8\u7a7a\u95f4\uff09 \u9ed8\u8ba4\u662f\u963b\u585e\u7684 12\u3001\u77e5\u8bc6\u70b9\u590d\u4e60\uff08\uff09 \u00b6 13\u3001\u5927\u7aef\u548c\u5c0f\u7aef\u5b58\u50a8\uff08\uff09 \u00b6 14\u3001\u5927\u5c0f\u7aef\u8f6c\u6362\u51fd\u6570 \u00b6 day11\u3001TCP\u4e09\u6b21\u63e1\u624b-\u5e76\u53d1 \u00b6 1\u3001\u5b66\u4e60\u76ee\u6807 \u00b6 3\u6b21\u63e1\u624b\u30014\u6b21\u6325\u624b\u3001\u6ed1\u52a8\u7a97\u53e3 connect\u65f6\u5c31\u4f1a\u63e1\u624b\uff0cclose\u65f6\u5c31\u4f1a\u6325\u624b \u9519\u8bef\u5904\u7406\u51fd\u6570\u5c01\u88c5 \u591a\u8fdb\u7a0b\u5e76\u53d1\uff0c\u591a\u7ebf\u7a0b\u5e76\u53d1 2\u3001\u77e5\u8bc6\u70b9\u56de\u987e \u00b6 \u7f51\u7edc\u5f00\u53d1\u8bbe\u8ba1\u6a21\u5f0f C/S\uff1a\u684c\u9762\u5ba2\u6237\u7aef B/S\uff1a\u8de8\u5e73\u53f0\uff0chttp\uff0c \u6548\u7387\u4f4e \u5206\u5c42\u6a21\u578b\uff1a \u4e03\u5c42 \u56db\u5c42\uff1a\u7f51\u7edc\u63a5\u53e3\u5c42\u3001\u7f51\u7edc\u5c42\u3001\u4f20\u8f93\u5c42\u3001\u5e94\u7528\u5c42 tcp,udp socket \u6587\u4ef6\uff08\u5185\u6838\u4e2d\u7684\u7f13\u51b2\u533a\uff09\u64cd\u4f5c socket tcp server\u7684\u64cd\u4f5c\u6d41\u7a0b \u8fd8\u662f\u8bb0\u4f4f\u8fd9\u4e9b\u51e0\u79cd\u7ec6\u8282 \uff0c10min\u5de6\u53f3 accpet()\u7684\u8fd4\u56de\u503c\uff0c\u662f\u7528\u4e8e\u901a\u4fe1\u7684 \uff0clisten()\u7684\u8fd4\u56de\u503c\uff0c\u662f\u7528\u4e8e\u76d1\u542c\u7684 close(lfd)\uff0cclose(cfd)\uff0c \u5c31\u9700\u8981\u5173\u95ed2\u6b21 socket tcp client\u7684\u64cd\u4f5c\u6d41\u7a0b struct sockaddr_in client; \uff0c\u8fdb\u884cconnect\u64cd\u4f5c 3\u3001tcp\u5ba2\u6237\u7aef\u4ee3\u7801\u5b9e\u73b0\uff0820200401\uff09 \u00b6 [client_tcp.c] 4\u3001socket\u51fd\u6570\u5c01\u88c5\uff0820200402\uff09 \u00b6 [wrap.c]\u67e5\u770b Man\u6587\u6863\u8df3\u8f6c\u7684\u65f6\u5019\uff0c\u4e0d\u533a\u5206\u5927\u5c0f\u5199 \uff0c\u53ef\u4ee5\u628aaccept()\u7684\u51fd\u6570\u91cd\u88c5\u5305\u88c5\u6210Accpet()\u3002 \u7528\u5565+K\u53ef\u4ee5\u8df3\u8f6c\uff1flionel bind(),connect(),listen(),socket(),close()\uff0c\u8fd9\u4e9b\u8fd4\u56de-1\u65f6\uff0c\u5c31\u6253\u5370\u9519\u8bef\u3002 accept()\u3001read()\uff0cwrite()\u8fd4\u56de-1\uff0c\u90fd\u9012\u5f52\u8c03\u7528\u3002 read\u548cwrite\u4f1a\u963b\u585e \u3002 readn()\u662f\u81ea\u5df1\u5199\u7684\uff0c\u591a\u4e86\u4e2a \u5e94\u8be5\u8bfb\u53d6\u7684\u5b57\u8282\u6570 n \uff1b writen()\u4e5f\u662f\u81ea\u5df1\u5199\u7684\uff0c\u8ddfreadn()\u4e00\u6837 Readline()\u8c03\u7528\u4e00\u4e2a\u9759\u6001\u51fd\u6570my_read() 5\u3001TCP\u4e09\u6b21\u63e1\u624b\uff0820200403\uff09 \u00b6 \u8fde\u63a5\u670d\u52a1\u5668\u7684\u8fc7\u7a0b\u4e2d\u5b8c\u6210\u4e09\u6b21\u63e1\u624b\uff0c6\u4e2a\u6807\u5fd7\u4f4d\uff1a SYN\uff1a\u8bf7\u6c42\u5efa\u7acb\u8fde\u63a5 ACK\uff1a\u5e94\u7b54 FIN\uff1a\u65ad\u5f00\u8fde\u63a5 RST URG PSH \u7b2c1\u6b21\u63e1\u624b\u662f\u7531\u5ba2\u6237\u7aef\u53d1\u8d77 \uff0c \u5ba2\u6237\u7aef\uff1a SYN\u6807\u5fd7\u4f4d+32\u4f4d\u5e8f\u53f7\uff08\u968f\u673a\u4ea7\u751f\uff09+\u6570\u636e\uff08\u4e5f\u53ef\u4ee5\u4e0d\u5e26\u6570\u636e\uff09 \u670d\u52a1\u5668 \u5224\u65adSYN\u503c\u4e3a1\u65f6\uff0c\u7b2c1\u6b21\u63e1\u624b\u624d\u7b97\u6210\u529f\u3002 \u7b2c2\u6b21\u63e1\u624b \u670d\u52a1\u5668 ACK\u6807\u5fd7\u4f4d+32\u786e\u8ba4\u5e8f\u53f7\uff08\u5728\u968f\u673a\u5e8f\u53f7\u57fa\u7840\u4e0a+1\uff09+\u6570\u636e\uff08\u4e5f\u53ef\u4ee5\u4e0d\u5e26\u6570\u636e\uff09 \u53d1\u8d77\u4e00\u4e2a\u8fde\u63a5\u8bf7\u6c42\uff1aSYN\u6807\u5fd7\u4f4d+32\u4f4d\u5e8f\u53f7\uff08\u968f\u673a\u4ea7\u751f\uff09+\u6570\u636e\uff08\u4e5f\u53ef\u4ee5\u4e0d\u5e26\u6570\u636e\uff09 \u5ba2\u6237\u7aef \u68c0\u6d4bACK\u6807\u5fd7\u4f4d\u662f\u4e0d\u662f\u4e3a1 \u68c0\u6d4b32\u4f4d\u786e\u8ba4\u5e8f\u53f7\u662f\u5426\u662f\u81ea\u5df1\u968f\u673a\u5e8f\u53f7\u57fa\u7840\u4e0a\u52a01 \u7b2c3\u6b21\u63e1\u624b \u5ba2\u6237\u7aef \u53d1\u9001\u786e\u8ba4\u6570\u636e\u5305\uff1aACK\u6807\u5fd7\u4f4d+32\u4f4d\u786e\u8ba4\u5e8f\u53f7 \u670d\u52a1\u5668\uff1a \u68c0\u6d4b\uff1aACK\u662f\u5426\u4e3a1\uff0c \u68c0\u6d4b\uff1a\u786e\u8ba4\u5e8f\u53f7\u662f\u5426\u6b63\u786e \u601d\u8003 \u5e26\u6570\u636e\u7684\u65f6\u5019\uff0c\u56de\u7684\u786e\u8ba4\u5e8f\u53f7\u662f\u591a\u5c11\uff1f\uff08\u5927\u5c0f\u540e\u518d\u52a01\uff1f\uff09 6\u3001TCP\u7684\u6570\u636e\u4f20\u8f93\u8fc7\u7a0b\uff0820200403\uff09 \u00b6 MSS\uff08\u6700\u5927\u6570\u636e\u957f\u5ea6\uff09\uff1a\u5ba2\u6237\u7aef\u544a\u8bc9\u670d\u52a1\u5668\uff0c\u4f60\u7ed9\u6211\u53d1\u7684\u6570\u636e\u957f\u5ea6\u7684\u503c\u3002 \u4e09\u6b21\u63e1\u624b\uff0c\u5efa\u7acb\u8fde\u63a5\u7684\u8fc7\u7a0b \u5ba2\u6237\u7aef\uff1a connect() \u670d\u52a1\u5668\uff1a accept() \u6570\u636e\u4f20\u8f93 \u5ba2\u6237\u7aef\uff1a\u7f16\u53f7\uff08\u5bf9\u65b9\u6700\u540e\u53d1\u9001ACK\u7684\u65f6\u5019\u643a\u5e26\u7684\u786e\u8ba4\u5e8f\u53f7\uff09+ACK+\u5bf9\u65b9\u6700\u540e\u4e00\u6b21\u7684ACK\u7f16\u53f7 \u670d\u52a1\u7aef\uff1aACK+\u786e\u8ba4+\u6570\u636e \u5ba2\u6237\u7aef\uff1aACK+\u786e\u8ba4 \u8fd9\u90e8\u5206\u5176\u5b9e\u6ca1\u592a\u5b8c\u5168\u61c2\uff0c\u4f46\u770b\u56fe\u80fd\u8bf4\u51fa\u4e2a\u5927\u6982\u6765 \uff0c \u6570\u636e\u8fde\u63a5\u8fc7\u7a0b\u4e2d\u6ca1\u6709SYN\u5173\u952e\u5b57 07\u3001\u56db\u6b21\u6325\u624b\uff0820200403\uff09 \u00b6 \u54ea\u4e00\u4e9b\u4e3b\u52a8\u4e3b\u52a8\u65ad\u5f00\u8fde\u63a5\u90fd\u53ef\u4ee5 \u3002 \u9700\u8981\u4e00\u4e2a\u6807\u5fd7\u4f4d\uff1aFIN\u3002 \u7b2c\u4e00\u6b21\u6325\u624b \u5ba2\u6237\u7aef\uff08\u53d1\u9001\u65ad\u5f00\u7684\u8bf7\u6c42\uff09\uff1a FIN+\u5bf9\u65b9\u6700\u540e\u53d1\u9001ACK\u7684\u65f6\u5019\u643a\u5e26\u7684\u786e\u8ba4\u5e8f\u53f7+\u6570\u636e\uff08\u53ef\u4ee5\u4e0d\u5e26\uff09\uff1b ACK+\u5e8f\u53f7\uff08\u5bf9\u65b9\u7684\u53d1\u9001\u7684\u5e8f\u53f7+\u957f\u5ea6\uff09 \u670d\u52a1\u7aef\uff1a \u68c0\u6d4bFIN\u503c\u662f\u5426\u4e3a1 ACK\u7684\u4f5c\u7528\uff1a\u544a\u8bc9\u5bf9\u65b9\u4e4b\u524d\u53d1\u7684\u6570\u636e\u6536\u5230\u4e86\u591a\u5c11 \u7b2c\u4e8c\u6b21\u6325\u624b \u670d\u52a1\u5668\uff08\u7ed9Client\u786e\u8ba4\u6570\u636e\u5305\uff09 ACK+\u786e\u8ba4\u7f16\u53f7\uff08FIN\u5bf9\u5e94\u7684\u5e8f\u53f7+1+\u6570\u636e\u5927\u5c0f\uff09 \u5ba2\u6237\u7aef\uff1a \u68c0\u6d4b\uff1aACK\u7684\u503c \u68c0\u6d4b\uff1a\u786e\u8ba4\u5e8f\u53f7 \u7b2c\u4e09\u6b21\u6325\u624b\uff1a\uff08 \u670d\u52a1\u5668\u53d1\u8d77\u7684\u544a\u522b\u8fc7\u7a0b \uff09 \u670d\u52a1\u5668\u7aef\uff08\u53d1\u9001\u65ad\u5f00\u8fde\u63a5\u7684\u8bf7\u6c42\uff09 FIN+\u5e8f\u53f7\uff08\u6700\u540e\u4e00\u6b21\u6536\u5230\uff0c\u5bf9\u65b9\u7684ACK\uff09 ACK+\u5e8f\u53f7 \u5ba2\u6237\u7aef\uff1a \u6570\u636e\u68c0\u6d4b\uff0c\u6570\u636e\u662f\u4e0d\u662f\u6536\u5230 \u7b2c\u56db\u6b21\u6325\u624b \u5ba2\u6237\u7aef\uff1a ACK+\u5e8f\u53f7\uff08\u6536\u5230\u7684ACK\u5e8f\u53f7+1\uff09 \u7b2c2\u6b21\u548c\u7b2c3\u6b21\u90fd\u662f\u540c\u4e00\u4e2a\u4eba\u53d1\u7684 \uff0c \u4e3b\u8981\u662f\u5e8f\u53f7\u7684\u503c\uff0c\u8981\u786e\u8ba4\u4e00\u4e0b \u3002 \u5728\u4ee3\u7801\u4e2d\u8868\u73b0\u5c31\u662f \u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u90fd\u662f\u7528 close() 08\u3001\u6ed1\u52a8\u7a97\u53e3\uff0820200403\uff09 \u00b6 \u6ed1\u52a8\u7a97\u53e3 \u5c31\u662f\u7f13\u5b58\uff0c\u5bf9\u5e94\u7684\u201c16\u4f4d\u7a97\u53e3\u5927\u5c0f\u201d\uff0c\u5c31\u662f\u8bb0\u5f55\u7684\u7f13\u5b58\u5927\u5c0f\u3002 WIN 4096 win-\u6ed1\u52a8\u7a97\u53e3 4096-\u6ed1\u52a8\u7a97\u53e3\u5bf9\u5e94\u7684\u7f13\u51b2\u533a\u5927\u5c0f \u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u7684WIN\uff0c\u5927\u5c0f\u503c\u53ef\u4ee5\u4e0d\u4e00\u6837 \uff0c\u4e00\u822c\u90fd\u4e0d\u4e00\u6837\u3002 \u53ef\u4ee5\u53d1\u5f88\u591a\u6761\uff0c\u670d\u52a1\u5668\u518d\u7b54\u590d\u3002 09\u3001\u591a\u8fdb\u7a0b\u5e76\u53d1\u670d\u52a1\u5668\u5206\u6790\uff0820200404\uff09 \u00b6 \u5e76\u53d1 \uff1a\u5728\u67d0\u4e2a\u65f6\u95f4\u70b9\u5904\u7406\u7684\u4e2a\u6570\u3002 \u670d\u52a1\u7aef\u53ea\u5904\u7406\u5355\u8fde\u63a5 \u521b\u5efa\u5957\u63a5\u5b57 \u7ed1\u5b9a \u76d1\u542c \u63a5\u53d7\u8fde\u63a5\u8bf7\u6c42 \u901a\u4fe1 \u670d\u52a1\u7aef\u5904\u7406\u591a\u8fde\u63a5 \u76d1\u542c\uff1a\u6700\u591a\u53ef\u4ee5128\u4e2a\u3010listen(fd,128)\u3011 \u63a5\u53d7\u8fde\u63a5\u8bf7\u6c42 \u8ba9\u7236\u8fdb\u7a0b\u521b\u5efa\u5b50\u8fdb\u7a0b\uff0c\u53bb\u8fde\u63a5\u5ba2\u6237\u7aefA \u7236\u8fdb\u7a0b\u53ea\u7b49\u5f85\u8fde\u63a5\u8bf7\u6c42 \uff0c\u6709\u8bf7\u6c42\u5c31fork()\u4e00\u4e0b \u4f7f\u7528\u591a\u8fdb\u7a0b\u7684\u65b9\u5f0f\uff0c\u89e3\u51b3\u670d\u52a1\u5668\u5904\u7406\u591a\u8fde\u63a5\u7684\u95ee\u9898 \u5171\u4eab \u8bfb\u65f6\u5171\u4eab\uff0c\u5199\u65f6\u590d\u5236 \uff0c\u8bfb\u7684\u65f6\u5019\u5bf9\u5e94\u7684\u540c\u4e00\u4e2a\u7269\u7406\u5730\u5740\uff1b\u5199\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u5f00\u8f9f\u65b0\u7684\u7a7a\u95f4\uff0c\u518d\u8bfb\u5c31\u4f1a\u53bb\u65b0\u5f00\u8f9f\u7684\u7a7a\u95f4\u8bfb\u3002 \u5171\u4eab\u7684\u5185\u5bb9\u6709\uff1a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff1b\u5185\u5b58\u6620\u5c04\u533a--mmap\u521b\u5efa\u51fa\u6765\u7684\uff1b \u7236\u8fdb\u7a0b\u7684\u89d2\u8272\u662f\u4ec0\u4e48\uff1f \u7b49\u5f85\u63a5\u6536\u5ba2\u6237\u7aef\u8fde\u63a5 ---accept() \u6709\u8fde\u63a5\uff0c\u521b\u5efa\u4e00\u4e2a\u5b50\u8fdb\u7a0b fork() \u5c06\u901a\u4fe1\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u5173\u95ed \u5b50\u8fdb\u7a0b\u7684\u89d2\u8272\u662f\u4ec0\u4e48\uff1f \u901a\u4fe1 \u4f7f\u7528accept()\u8fd4\u56de\u503c\uff0c\u5c31\u662ffd\u3002 \u5173\u6389\u76d1\u542c\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26 \u4e3b\u8981\u539f\u56e0\u662f\uff1a\u6d6a\u8d39\u8d44\u6e90\uff08\u56e0\u4e3afd\u7684\u4e2a\u6570\u6709\u9650\uff0c\u624d1024\u4e2a\uff09 \u521b\u5efa\u7684\u8fdb\u7a0b\u7684\u4e2a\u6570\u6709\u9650\u5236\u5417\uff1f \u6709\uff0c\u53d7\u786c\u4ef6\u9650\u5236\u3002 \u6587\u4ef6\u63cf\u8ff0\u7b26\u9ed8\u8ba4\u6709\u4e0a\u9650\u662f1024\u4e2a \u3002 \u5b50\u8fdb\u7a0b\u8d44\u6e90\u56de\u6536 \u4e0d\u56de\u6536\u7684\u8bdd\uff0c\u4f1a\u88abinit\u56de\u6536\u6216\u53d8\u6210\u50f5\u5c38\u8fdb\u7a0b\u3002 wait()\u6216waitpid()\u56de\u6536\u3002 \u7528\u4fe1\u53f7\u56de\u6536 \u4fe1\u53f7\u6355\u6349\uff08signal\uff0csigaction\uff09\u63a8\u8350\u540e\u8005 \u6355\u6349SIGCHLD\u4fe1\u53f7 \u6587\u4ef6\u63cf\u8ff0\u7b26\uff08\u67092\u4e2a\uff09\uff1f \u7528\u4e8e\u76d1\u542c\u7684 \u7528\u4e8e\u901a\u4fe1\u7684 10\u3001\u591a\u8fdb\u7a0b\u5e76\u53d1\u670d\u52a1\u5668\u4f2a\u4ee3\u7801\uff0820200404\uff09 \u00b6 [\u591a\u8fdb\u7a0b\u5e76\u53d1\u670d\u52a1\u5668\u4f2a\u4ee3\u7801.c] 11\u3001\u591a\u8fdb\u7a0b\u5e76\u53d1\u670d\u52a1\u5668\u4ee3\u7801\u5b9e\u73b0\uff0820200404\uff09 \u00b6 [process_server.c] 12\u3001\u591a\u7ebf\u7a0b\u5e76\u53d1\u670d\u52a1\u5668\u5b9e\u73b0\u601d\u8def\uff0820200404\uff09 \u00b6 \u670d\u52a1\u5668\u6536\u5230\u5ba2\u6237\u7aef\u7684connect()\uff0c\u53ef\u4ee5\u5f53\u4f5c\u662f\u4e3b\u7ebf\u7a0b\u6536\u5230\uff0c\u7136\u540e pthread_creat() \u521b\u5efa\u5b50\u7ebf\u7a0b\u5904\u7406\u3002 \u628a\u6587\u4ef6\u63cf\u8ff0\u4f20\u5230\u5b50\u7ebf\u7a0b\u5185\u90e8\uff0c\u8fdb\u884cread/write\u64cd\u4f5c\u3002 \u7ebf\u7a0b\u5171\u4eab\uff1a \u5168\u5c40\u6570\u636e\u533a \u5806\u533a\u6570\u636e \u4e00\u5757\u6709\u6548\u5185\u5b58\u7684\u5730\u5740 \u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u8981\u5907\u4efd\u72ec\u7acb\u7684\u5904\u7406 \uff0c\u628a\u5904\u7406\u5c01\u88c5\u5230\u7ed3\u6784\u4f53\u91cc\uff0c\u540c\u65f6\u5728\u56de\u8c03\u51fd\u6570\u91cc\u5904\u7406\u3002 13\u3001\u591a\u7ebf\u7a0b\u7248\u5ba2\u6237\u7aef\u4ee3\u7801\u5b9e\u73b0\uff0820200404\uff09 \u00b6 [pthread_server.c] day12\u3001TCP\u72b6\u6001\u8f6c\u6362-select-poll \u00b6 01\u3001\u77e5\u8bc6\u70b9\u6982\u8ff0 \u00b6 02\u3001\u4e09\u6b21\u63e1\u624b\u56db\u6b21\u6325\u624b\u590d\u4e60 \u00b6 03\u3001\u591a\u8fdb\u7a0b\u591a\u7ebf\u7a0b\u5e76\u53d1\u590d\u4e60\uff08\uff09 \u00b6 04\u3001recv\u548csend\u51fd\u6570\uff0820200406\uff09 \u00b6 \u6570\u636e\u63a5\u6536 read() recv() \u6570\u636e\u53d1\u9001 write() send() \u4e24\u8005\u662f\u53ef\u66ff\u4ee3\u7684\uff0c \u533a\u522b\u5728\u4e8e\u540e\u9762\u7684\u51fd\u6570\u591a\u4e86\u4e00\u4e2a\u53c2\u6570flags\uff0c\u8d4b\u503c\u4e3a0\u5373\u53ef \u3002 UDP\u7684\u8bdd\uff0c\u7528\u7684\u662f recvfrom() \u548c sendto() \u5b83\u4eec\u7684flags\u4e5f\u8d4b\u503c\u4e3a0 \u3002 05\u3001tcp\u72b6\u6001\u8f6c\u6362\uff0820200408\uff09 \u00b6 \u5ba2\u6237\u7aef\uff1a CLOSED -> SYN_SENT -> ESTABLISTHED ->\u6570\u636e\u4f20\u5077\u4e2d\u72b6\u6001\u4e0d\u53d8-> \u8c01\u5148\u53d1\u9001\u6325\u624b\u8bf7\u6c42\uff0c\u8c01\u5148\u53d8 -> FIN_WAIT_1 -> FIN_WAIT_2 -> TIME_WAIT -> CLOSED \u4e3b\u52a8\u65ad\u5f00\u7684\u4e00\u65b9\uff0c\u6700\u540e\u7684\u72b6\u6001\u662f TIME_WAIT \u3002 \u670d\u52a1\u7aef\uff1a CLOSED -> LISTEN -> SYN_RCVD -> ESTABLISTHED -> CLOSE_WAIT -> LAST_ACK -> CLOSED \u8fd9\u4e0d\u662f\u670d\u52a1\u7aef\u4e3b\u52a8\u65ad\u5f00\u8fde\u63a5 \u3002 06\u30012msl\u7b49\u5f85\u65f6\u957f\uff0820200408\uff09 \u00b6 \u80fd\u6355\u6349\u5230\u7684\u72b6\u6001\uff08netstat\u547d\u4ee4\u4f1a\u6355\u6349\uff09 LISTEN ESTABLISHED \u4e3b\u52a8\u65ad\u5f00\u8fde\u63a5\u7684\u4e00\u65b9\u5230 TIME_WAIT \u72b6\u6001\u65f6\uff0c\u4f1a\u7b49\u5f852MSL\u65f6\u957f\uff0c\u4e00\u4e2aMSL\u662f30\u79d2\uff0c2\u4e2a\u5c31\u662f1\u5206\u949f\u3002 \u6015\u5bf9\u65b9\u6ca1\u6709\u6536\u5230\uff0c\u7528\u8fd9\u4e2a2MSL\u518d\u53d1\u9001\u4e00\u6b21\u3002 07\u3001\u534a\u5173\u95ed\uff0820200408\uff09 \u00b6 \u5982\u4f55\u7406\u89e3\uff1f \u6709\u4e00\u7aef\u5173\u95ed\uff0c\u53e6\u4e00\u7aef\u6ca1\u5173\u95ed A\u7ed9B\u53d1\u9001\u662fFIN\uff08A\u8c03\u7528\u4e86close\u51fd\u6570\uff09\uff0c\u4f46\u662fB\u6ca1\u6709\u7ed9A\u53d1\u9001FIN\uff08B\u6ca1\u6709\u8c03\u7528close\uff09 \u5373A\u65ad\u5f00\u4e86\u4e0eB\u7684\u8fde\u63a5\uff0cB\u6ca1\u6709\u65ad\u5f00\u4e0eA\u7684\u8fde\u63a5\u3002 \u7279\u70b9\uff1a A\u4e0d\u80fd\u7ed9B\u53d1\u9001\u6570\u636e\uff0c\u4f46\u80fd\u6536\u5230B\u53d1\u9001\u7684\u6570\u636e\u3002 B\u80fd\u7ed9A\u53d1\u9001\u6570\u636e \u51fd\u6570\uff1a shutdown(int sockfd, int how) how SHUT_RD 0\u8bfb SHUT_WR 1 \u5199 SHUT_RDWR 2 \u8bfb\u5199 \u628a\u62f7\u8d1d\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e5f\u4e0d\u80fd\u7528\u4e86 dup,dup2 \u590d\u5236\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0cdup2()\u8fd8\u80fd\u5f97\u5b9a\u5411\u3002 \u601d\u8003\uff1aclose\u51fd\u6570\u80fd\u5426\u5b9e\u73b0\u534a\u5173\u95ed\uff1f 08\u3001netstat\u547d\u4ee4\uff0820200407\uff09 \u00b6 \u7528netstat\u6355\u6349\u8fdb\u7a0b\u7684\u72b6\u6001\uff08\u5957\u63a5\u5b57\u901a\u4fe1\uff09 -a\uff0c\u9ed8\u8ba4\u4e0d\u663e\u793aLISTEN\u76f8\u5173\uff0c\u6240\u4ee5\u8981\u7528a -p\uff0c\u663e\u793a\u5efa\u7acb\u76f8\u5173\u94fe\u63a5\u7684\u7a0b\u5e8f\u540d -n\uff0c\u62d2\u7edd\u663e\u793a\u522b\u540d\uff0c\u80fd\u663e\u793a\u6570\u5b57\u7684\u5168\u90e8\u8f6c\u5316\u4e3a\u6570\u5b57 -t\uff08tcp\uff09\u4ec5\u663e\u793atcp\u76f8\u5173\u9009\u9879 -u\uff08udp\uff09\u4ec5\u663e\u793audp\u76f8\u5173\u9009\u9879 l \u4ec5\u5217\u51fa\u6709\u5728Listen\uff08\u76d1\u542c\uff09\u7684\u670d\u52a1\u72b6\u6001 grep -apn \u670d\u52a1\u7aef\u6c38\u8fdc\u6709\u4e2a\u76d1\u542c\u5957\u63a5\u5b57 \uff0c\u6700\u540e\u770b\u540d\u79f0\u5224\u65ad\u670d\u52a1\u5668\u8fd8\u662f\u5ba2\u6237\u7aef\u3002 \u7b2c1\u4e2aip+port\u8868\u793a\u5f53\u524d\u540d\u79f0\u7684\u672c\u5730IP+Port\uff0c\u7b2c2\u4e2a\u662f\u8fde\u7684\u8fdc\u7aef\u7684IP+Port\u3002 TIME_WAIT \uff0c\u4e3b\u52a8\u65ad\u5f00\u7684\u4e00\u65b9\uff0c\u4f1a\u6709\u4e00\u4e2aTIME_WAIT\u72b6\u6001 \uff0c\u8fd9\u4e2a\u7b49\u5f85\u5927\u6982\u662f1min\u3002 FIN_WAIT2 \u548c CLOSE_WAIT \u53c8\u5206\u522b\u662f\u8c01\u662f\u53d1\u8d77\u4eba\u5462\uff1f 09\u3001\u7aef\u53e3\u590d\u7528\u8bbe\u7f6e\uff0820200409\uff09 \u00b6 \u4f5c\u4e3aserver\u7aef\u4e3b\u52a8\u65ad\u5f00\u8fde\u63a5\u540e\uff0c\u518d\u542f\u52a8\u4f1a\u6709\u201cAddress already in use\u201d\uff0c\u539f\u56e0\u662f \u4e3b\u52a8\u65ad\u5f00\u8fde\u63a5\u7684\u4e00\u65b9\u67092MSL\u7684\u7b49\u5f85\u65f6\u957f \u3002--lionel\uff0c\u6211\u5728\u5b9a\u4f4d\u95ee\u9898\u7684\u65e5\u5fd7\u91cc\u5c31\u89c1\u8fc7\uff0c\u4f46\u5f53\u65f6\u4e0d\u77e5\u9053\u5565\u539f\u56e0\u5462\u3002 \u5f53\u7136\u4e5f\u53ef\u4ee5\u7528 \u7aef\u53e3\u590d\u7528 \u7684\u65b9\u5f0f\u89e3\u51b3\u3002 \u7aef\u53e3\u590d\u7528\u7684\u7528\u9014 \u9632\u6b62\u670d\u52a1\u5668\u91cd\u542f\u65f6\u4e4b\u524d\u7ed1\u5b9a\u7684\u7aef\u53e3\u8fd8\u672a\u91ca\u653e \u7a0b\u5e8f\u7a81\u7136\u9000\u51fa\u800c\u7cfb\u7edf\u6ca1\u6709\u91ca\u653e\u7aef\u53e3 \u8bbe\u7f6e\u65b9\u6cd5 int opt = 1; setsockopt(sockfd, SOL_SOCKET,SO_REUSEADDR,(const void*)&amp;opt, sizeof(opt)); \u6587\u4ef6\u63cf\u8ff0\u7b26\u662f\u76d1\u542c\u63cf\u8ff0\u7b26 \u3002 \u6ce8\u610f\u4e8b\u9879 \u5728\u7ed1\u5b9a\u4e4b\u524d\u8bbe\u7f6e\u7aef\u53e3\u590d\u7528\u7684\u5c5e\u6027 \u3002 10\u3001IO\u591a\u8def\u8f6c\u6362\u8bb2\u89e3\uff0820200408\uff09 \u00b6 IO\u64cd\u4f5c\u65b9\u5f0f \u963b\u585e\u7b49\u5f85 \u597d\u5904\uff1a\u4e0d\u5360CPU\u5b9d\u8d35\u7684\u65f6\u95f4\u7247 \u7f3a\u70b9\uff1a\u540c\u4e00\u65f6\u523b\u53ea\u80fd\u5904\u7406\u4e00\u4e2a\u64cd\u4f5c\uff0c\u6548\u7387\u4f4e \u591a\u8fdb\u7a0b/\u591a\u7ebf\u7a0b \u89e3\u51b3\uff0c\u53ea\u7b49\u5f85\uff0c\u518d\u7528\u5b50\u7ebf\u7a0b/\u5b50\u7ebf\u7a0b\u5904\u7406\u76f8\u5e94\u4e1a\u52a1\uff0c \u521b\u5efa\u8fdb\u7a0b/\u7ebf\u7a0b\u592a\u8017\u8d39\u8d44\u6e90 \u975e\u963b\u585e\uff0c\u5fd9\u8f6e\u8be2 \u4f18\u70b9\uff1a\u63d0\u9ad8\u4e86\u7a0b\u5e8f\u7684\u6267\u884c\u6548\u7387 \u7f3a\u70b9\uff1a\u9700\u8981\u5360\u7528\u66f4\u591a\u7684CPU\u548c\u7cfb\u7edf\u8d44\u6e90 \u5355\u4efb\u52a1/\u591a\u4efb\u52a1 \uff08\u4e0d\u65ad\u95ee\uff09 \u89e3\u51b3\u65b9\u6848\uff1a\u4f7f\u7528IO\u591a\u8def\u8f6c\u63a5\u6280\u672fselect/poll/epoll \u7b2c\u4e00\u79cd\uff1aselect/poll \u5148\u59d4\u6258\u5185\u6838\u5e2e\u6211\u4eec\u68c0\u6d4b\u4e00\u4e0b\u6709\u54ea\u4e9b\u5ba2\u6237\u7aef\u4f1a\u8ddf\u6211\u901a\u4fe1 \uff0c\u901a\u8fc7 select() \u6765\u5b9e\u73b0\u3002 select()\u53ea\u8bc6\u6570\u4e0d\u8ba4\u5b57\uff0c\u53ea\u4f1a\u544a\u8bc9\u4f60\u6709\u51e0\u4e2a\u5feb\u9012\uff08\u5ba2\u6237\u7aef\uff09\u5230\u4e86 \uff0c\u4f46\u662f\u54ea\u4e2a\u5feb\u9012\uff0c\u9700\u8981\u6328\u4e2a\u904d\u5386\u6240\u6709\u5ba2\u6237\u7aef\u3002 poll\u904d\u5386\u7684\u662f\u7ebf\u6027\u8868\u3002 \u7b2c\u4e8c\u79cd\uff1aepoll epoll()\u4e0d\u4ec5\u544a\u8bc9\u4f60\u6570\u91cf\uff0c\u4e5f\u4f1a\u544a\u8bc9\u4f60\u54ea\u4e2a\u5feb\u9012\u516c\u53f8\u7684\u5feb\u9012 \u3002 epoll\u904d\u5386\u7684\u662f\u7ea2\u9ed1\u6811\u3002 \u4ee5\u53d6\u5feb\u9012\u7684\u4f8b\u5b50\u6765\u8bb2 11\u3001\u5185\u6838\u5927\u81f4\u662f\u5982\u4f55\u5b9e\u73b0IO\u8fde\u63a5\u7684\uff0820200408\uff09 \u00b6 \u5148\u6784\u9020\u4e00\u5f20\u6709\u5173\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u5217\u8868\uff0c\u5c06\u8981\u76d1\u542c\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u6dfb\u52a0\u5230\u8be5\u8868\u4e2d \u963b\u585e\u4fe1\u53f7\u96c6\u8868/\u81ea\u5b9a\u4e49\u4fe1\u53f7\u96c6\u8868\uff0c\u518d\u7528 sigpromask() \u662f\u8fd9\u4e24\u5f20\u7684\u6865\u6881\u3002 \u7136\u540e\u8c03\u7528\u4e00\u4e2a\u51fd\u6570\uff0c\u76d1\u542c\u8be5\u8868\u4e2d\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u76f4\u63a5\u8fd9\u4e9b\u63cf\u8ff0\u7b26\u8868\u4e2d\u7684\u4e00\u4e2a\u8fdb\u884cI/O\u64cd\u4f5c\u65f6\uff0c\u8be5\u51fd\u6570\u624d\u8fd4\u56de \u8be5\u51fd\u6570\u4e3a\u963b\u585e\u51fd\u6570 \u51fd\u6570\u5bf9\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u68c0\u6d4b\u64cd\u4f5c\u662f\u7531\u5185\u6838\u5b8c\u6210\u7684 \u5728\u8fd4\u56de\u65f6\uff0c\u5b83\u544a\u8bc9\u8fdb\u7a0b\u6709\u591a\u5c11\uff08\u54ea\u4e9b\uff09\u63cf\u8ff0\u7b26\u8981\u8fdb\u884cI/O\u64cd\u4f5c \u901a\u8fc7\u8c03\u7528selec()\u51fd\u6570\uff0c\u628a\u6784\u9020\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u5217\u8868\u7ed9\u5230\u5185\u6838\uff1f --\u662f\u8fd9\u6837\u7684\u5417\uff1f 12\u3001select\u7684\u53c2\u6570\u548c\u8fd4\u56de\u503c\uff0820200409\uff09 \u00b6 int select(int nfds, fd_set *readfds, fd_set *writefds, fd_set *exceptfds, struct timeval *timeout); ndfs\uff1a\u4e00\u7ec4\u63cf\u8ff0\u7b26\u4e2d\u6700\u5927\u7684\u503c\u518d\u52a01\uff1b\u6700\u591a\u4f201024 fd_set \u662f\u4e2a\u6570\u7ec4\uff0c\u5927\u5c0f\u662f16\u4e2a\uff0c\u6240\u4ee5\u6700\u591a\u4f201024\uff0816 \u4e58 8\u4f4d \u4e58 \u5b57\u8282\uff09\uff0c\u6240\u4ee5\u6700\u591a1024\u4e2a\u6807\u5fd7\u4f4d\u3002 readfds\uff1a \u4f20\u5165\u4f20\u51fa\u53c2\u6570 \uff0c\u8bfb\u96c6\u5408 writefds\uff1a\u4e00\u822c\u4f20\u7a7a \uff08\u5199\u662f\u4e3b\u52a8\u64cd\u4f5c\uff0c\u4e0d\u6355\u6349\uff09 exceptfds\uff1a\u4e00\u822c\u4f20\u7a7a \u5f02\u5e38\u96c6\u5408 timeout\uff1a \u901a\u8fc7\u8bbe\u7f6e\u5b83\u6765\u786e\u5b9a\u662f\u5426\u963b\u585e NULL\uff1a\u6c38\u4e45\u963b\u585e\uff08\u5f53\u68c0\u6d4b\u5230fd\u6709\u53d8\u5316\u7684\u65f6\u5019\u8fd4\u56de\uff09 \u8981\u8ba9\u7ed3\u6784\u4f53\u53d8\u91cf\u7684a\u6709\u503c\uff0ca.tv_sec=0\uff0ca.tv_usec=0\u3002 \u6587\u4ef6\u63cf\u8ff0\u7b26\u96c6\u7c7b\u578b\uff1a fd_set rdset; FD_ZERO()\u6e05\u7a7a FD_CLR()\u5220\u9664\u67d0\u9879 FD_SET()\u6dfb\u52a0\u6587\u4ef6\u63cf\u8ff0\u7b26 FD_ISSET()\u5224\u65ad\u662f\u5426\u5b58\u5728\u96c6\u5408\u4e2d \u6ca1\u6709\u8bbe\u7f6e\u4e0a\uff0c\u5c31\u662f0 select\u51fd\u6570\u7684\u4f18\u7f3a\u70b9 \u4f18\u70b9 \u8de8\u5e73\u53f0 \u7f3a\u70b9 \u5185\u6838\u7684\u5f00\u9500\u592a\u5927\uff08\u4e00\u662f\u62f7\u8d1d\uff1b\u4e8c\u662f\u904d\u5386\uff09 select\u652f\u6301\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u6570\u91cf\u592a\u5c0f\u4e86\uff0c\u9ed8\u8ba4\u662f1024 13\u3001\u590d\u4e60\uff08\uff09 \u00b6 14\u3001select\u5de5\u4f5c\u8fc7\u7a0b\uff0820200409\uff09 \u00b6 \u9700\u6c42\uff1a\u5ba2\u6237\u7aefA,B,C,D,E,F\u8fde\u63a5\u5230\u670d\u52a1\u5668\uff1b\u5206\u522b\u5bf9\u5e94\u6587\u4ef6\u63cf\u8ff0\u7b263\uff0c4\uff0c100\uff0c101\uff0c102\uff0c103\uff0cABC\u53d1\u9001\u4e86\u6570\u636e\u3002 \u7b2c\u4e00\u6b65\uff1a\u521b\u5efafd_set\u7c7b\u578b\u7684reads; \u8fd9\u662f\u7528\u6237\u7a7a\u95f4 \u7b2c\u4e8c\u6b65\uff1a\u6dfb\u52a0\u5230reads\uff0c FD_SET(3,&reads) \u7b2c\u4e09\u6b65\uff1a select(103+1,&reads,NULL,NULL,NULL); \u5185\u6838\u4f1a\u628a\u7528\u6237\u7a7a\u95f4\u7684reads\uff0c\u62f7\u8d1d\u5230\u5185\u6838\u7a7a\u95f4\u3002 \u5185\u6838\u6839\u636e\u503c\u4e3a1\uff0c\u53bb\u627e\u6587\u4ef6\u63cf\u8ff0\u7b26\uff1b \u5982\u679c\u6587\u4ef6\u63cf\u8ff0\u7b26\u6ca1\u6709\u6570\u636e\uff0c\u5185\u6838\u4f1a\u628a\u503c\u4ece1\u53d8\u4e3a0 \uff0c\u6709\u503c\u7684\u8bdd\uff0c\u5c31\u4e0d\u53d8\u3002 \u5185\u6838\u628a\u4fee\u6539\u8fc7\u7684\u8868\u4f1a\u518d\u4f20\u7ed9\u7528\u6237\u7a7a\u95f4\uff0c\u4f1a\u8986\u76d6\u5230\u7528\u6237\u7a7a\u95f4\u7684reads \uff08\u8fd9\u6837\u5c31\u53ef\u80fd\u4e0d\u4e00\u6837\u4e86\uff09 \u5f97\u5b9a\u4e49\u4e24\u4e2afd_set\u53d8\u91cf \uff0c\u7528\u4e8e\u5bf9\u6bd4\u3002 15\u3001select\u4f2a\u4ee3\u7801\u5b9e\u73b0\uff0820200410\uff09 \u00b6 [select\u4f2a\u4ee3\u7801\u5b9e\u73b0.cpp] 16\u3001select\u4ee3\u7801\u5b9e\u73b0\uff0820200410\uff09 \u00b6 [day12_17select.c] 17\u3001poll\u51fd\u6570\u4ecb\u7ecd\uff0820200410\uff09 \u00b6 poll\u7684\u6570\u636e\u7ed3\u6784\u662f\u4e2a\u94fe\u63a5\uff0cepoll\u7684\u6570\u636e\u7ed3\u6784\u662f\u4e2a\u6811\u3002 poll\u4e24\u5757\u4e92\u62f7\u8d1d\u4e5f\u6709\u5f00\u9500\u3002 int poll(struct pollfd *fd, nfds_t nfds, int timeout) pollfd\uff1a\u6570\u7ec4\u7684\u5730\u5740 nfds\uff1a\u6570\u7ec4\u7684\u6700\u5927\u957f\u5ea6\uff0c\u6570\u7ec4\u4e2d\u6700\u540e\u4e00\u4e2a\u4f7f\u7528\u7684\u5143\u7d20\u4e0b\u6807+1 \u5185\u6838\u4f1a\u8f6e\u8be2\u68c0\u6d4bfd\u6570\u7ec4\u7684\u6bcf\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26 timeout\uff1a -1\uff1a\u6c38\u4e45\u963b\u585e 0\uff1a\u8c03\u7528\u5b8c\u6210\u7acb\u5373\u8fd4\u56de >0 \uff1a\u7b49\u5f85\u7684\u65f6\u957f\u6beb\u79d2 \u8fd4\u56de\u503c\uff1aIO\u53d1\u9001\u53d8\u5316\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u4e2a\u6570 \u6ca1\u592a\u597d\u597d\u542c --\u540e\u9762\u518d\u8865\u5145\u8fd9\u90e8\u5206 18\u3001poll\u5b9e\u73b0IO\u8f6c\u63a5\u4ee3\u7801\u5206\u6790\uff0820200411\uff09 \u00b6 \u6bd4\u8f83poll.c\u548cselect.c \uff0c\u8fd9\u4e24\u4e2a\u90fd\u627e\u4ed6\u4eec\u7684\u4f8b\u5b50\u5427\u3002 \u8981\u628a\u6d41\u7a0b\u641e\u6e05\u695a \u3002 day13\u3001epoll-udp \u00b6 01\u3001\u77e5\u8bc6\u70b9\u6982\u8ff0 \u00b6 02\u3001\u901a\u8fc7gdb\u5b9a\u4f4d\u6bb5\u9519\u8bef\u7684\u4f4d\u7f6e\uff0820200412\uff09 \u00b6 set args \u8bbe\u7f6e\u53c2\u6570 r \u8fd0\u884c \u6700\u7ec8\u5b9a\u4f4d\u662f pthread_detach() \u5f15\u7528\u53c2\u6570\u6709\u9519\u3002 \u6211\u5bf9pthread_detach()\u8fd8\u4e0d\u719f\u6089 03\u3001tcp\u72b6\u6001\u8f6c\u6362\u590d\u4e60\uff08\uff09 \u00b6 04\u3001select\u590d\u4e60\uff08\uff09 \u00b6 05\u3001epoll\u76f8\u5173\u7684\u51fd\u6570\u4ecb\u7ecd\uff0820200412\uff09 \u00b6 epoll\u5728\u5185\u90e8\u662f\u4e2a\u6811\u7ed3\u6784 \u3002 \u6301\u5728\u6811\u4e0a\u7684\u662f struct epoll_event \u7c7b\u578b\u91cc\u7684 fd \u3002 epoll_create() \u7528\u6765\u751f\u6210\u4e00\u4e2a\u6811\u7684\u6839\u7ed3\u70b9 \u53c2\u6570size\uff1aepoll\u4e0a\u80fd\u5173\u6ce8\u7684\u6700\u5927\u63cf\u8ff0\u7b26\u6570 epoll_clt() \u63a7\u5236\u67d0\u4e2aepoll\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e8b\u4ef6\uff0c\u53ef\u4ee5\u6ce8\u518c\u3001\u4fee\u6539\u3001\u5220\u9664 epfd\u53c2\u6570\uff1acreate()\u521b\u5efa\u7684 op\u53c2\u6570\uff1a EPOLL_CTL_ADD EPOLL_CTL_MOD EPOLL_CTL_DEL fd\u53c2\u6570\uff1a\u5173\u8054\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26 event\u53c2\u6570\uff1a\u544a\u8bc9\u5185\u6838\u8981\u76d1\u542c\u4ec0\u4e48\u4e8b\u4ef6 epoll_wait() \u7b49\u5f85IO\u4e8b\u4ef6\u53d1\u751f---\u53ef\u4ee5\u8bbe\u7f6e\u963b\u585e\u7684\u51fd\u6570 epid\u53c2\u6570\uff1aepoll_create()\u521b\u5efa\u7684 struct epoll_event* events \u53c2\u6570\uff1a\u7ed3\u6784\u4f53\u6570\u7ec4\uff0c\u4f5c\u7528\u662f\uff08\u6709\u54ea\u51e0\u4e2a\u53d8\u5316\u4e86\uff0c\u90fd\u5728\u8fd9\u4e2a\u7ed3\u6784\u4f53\u91cc\uff09 \u4f20\u51fa\u53c2\u6570 maxevents\u53c2\u6570\uff1a\u544a\u8bc9\u5185\u6838events\u7684\u5927\u5c0f\uff08\u7ed3\u6784\u4f53\u6570\u7ec4\u7684\u5bb9\u91cf\uff09 timeout\u53c2\u6570\uff1a\u8d85\u65f6\u65f6\u95f4 -1\uff1a\u6c38\u4e45\u963b\u585e 0\uff1a\u7acb\u5373\u8fd4\u56de\uff0c\u963b\u585e0\u6beb\u79d2\uff0c\u7acb\u5373\u8fd4\u56de\u4e86 \u5927\u4e8e0\uff1a\u963b\u585e\u65f6\u957f\uff0c\u5355\u4f4d\u662f\u6beb\u79d2 06\u3001epoll\u5de5\u4f5c\u6d41\u7a0b\uff0820200415\uff09 \u00b6 [\u4f2a\u4ee3\u7801.c] 07\u3001\uff08\uff09 \u00b6 08\u3001epoll\u6a21\u578b\u4ee3\u7801\u5b9e\u73b0\uff0820200415\uff09 \u00b6 09\u3001epoll\u590d\u4e60\uff08\uff09 \u00b6 10\u3001epoll\u6c34\u5e73\u89e6\u53d1\u6a21\u5f0f\uff0820200419\uff09 \u00b6 \u9ed8\u8ba4\u7684\u89e6\u53d1\u5de5\u4f5c\u6a21\u5f0f \u6c34\u5e73\u89e6\u53d1\u6a21\u5f0f \u53ea\u8981fd\u5bf9\u5e94\u7684\u7f13\u51b2\u533a\u6709\u6570\u636e\uff0c \u6839\u636e\u8bfb\u6765\u89e3\u91ca epoll_wait()\u8fd4\u56de \u8fd4\u56de\u7684\u6b21\u6570\u4e0e\u53d1\u9001\u6570\u636e\u7684\u6b21\u6570\u6ca1\u6709\u5173\u7cfb \u53d1100\u4e2a\u6570\u636e\uff0c\u6bcf\u6b21\u53ea\u8bfb1\u4e2a\u7684\u8bdd\uff0c\u5c31\u8981\u8bfb100\u6b21\u3002 \u4e0d\u9700\u8981\u989d\u5916\u7684\u64cd\u4f5c [lt_epoll.c] \u8bfb\u6570\u636e\u65f6\uff0c\u539f\u6765\u7684buf[1024]\uff0cbufchar[5]\u3002 printf()\u662f\u6807\u51c6C\u5e93\u51fd\u6570\uff0c\u6709\u9ed8\u8ba4\u7f13\u51b2\u533a8K\uff0c\u662f \u884c\u7f13\u51b2 \uff0c\u52a0 \\n \u624d\u4f1a\u5f3a\u5237\u7f13\u51b2\u533a\u3002 \u6362\u6210 write(STDOUT_FILENO,buf,len); \uff0c \u539f\u5148\u5b9a\u4e49\u7684buf\uff0c\u6700\u540e\u4e00\u4f4d\u6ca1\u6709\u7ed9\u5b83\u5f3a\u5236\u52a0\u4e00\u4e2a \\0 \uff0c\u8fd9\u4e2a\u5728\u4ee3\u7801\u4e2d\u786e\u5b9e\u6709\u98ce\u9669\u3002 linux\u7cfb\u7edf\u51fd\u6570\uff0c\u6709\u54ea\u4e9b\u3002 epoll_wait() \u8c03\u7528\u6b21\u6570\u8d8a\u591a\uff0c\u7cfb\u7edf\u7684\u5f00\u9500\u8d8a\u5f0f\u3002 11\u3001\u8fb9\u6cbf\u89e6\u53d1\u6a21\u5f0f\uff0820200419\uff09 \u00b6 ET fd-\u9ed8\u8ba4\u963b\u585e\u5c5e\u6027 \u5ba2\u6237\u7aef\u7ed9server\u53d1\u6570\u636e\uff1a \u53d1\u4e00\u6b21\u6570\u636eserver\u7684epoll_wait()\u88ab\u89e6\u53d1\u4e00\u6b21\uff08\u5373\u8fd4\u56de\u4e00\u6b21\uff09 \u4e0d\u7ba1\u6709\u6ca1\u6709\u8bfb\u5b8c\uff0c\u90fd\u53ea\u8fd4\u56de\u4e00\u6b21\uff0c \u4e0d\u5728\u4e4e\u6570\u636e\u6709\u6ca1\u6709\u8bfb\u5b8c \u5982\u679c\u8bfb\u4e0d\u5b8c\uff0c\u5982\u4f55\u5168\u90e8\u8bfb\u51fa\u6765\uff1f while(recv()); \u8fd9\u79cd\u5199\u6cd5\u7684\u526f\u4f5c\u7528\u662f \u6570\u636e\u8bfb\u5b8c\u4e4b\u540erecv\u4f1a\u963b\u585e \u3002 \u89e3\u51b3\u963b\u585e\u95ee\u9898\uff08\u8bbe\u7f6e\u975e\u963b\u585e--fd\uff09 [et_poll.c] \u8fb9\u5ef6\u89e6\u53d1\uff1a\u8981\u52a0\u4e2a\u5b8f temp.events = EPOLLIN | EPOLLET; 12\u3001\u8fb9\u6cbf\u975e\u963b\u585e\u6a21\u5f0f\uff0820200419\uff09 \u00b6 \u6548\u7387\u6700\u9ad8 \u5982\u4f55\u8bbe\u7f6e\u975e\u963b\u585e open()\uff0c\u901a\u8fc7\u8bbe\u7f6eflags\u7684\u5fc5\u9009\u9879\uff0c\u4ee5\u53ca\u53ef\u9009\u9879 O_NOBLOCK \uff0c \u9002\u7528\u4e8e\u7ec8\u7aef\u6587\u4ef6/dev/tty fcntl() \u66f4\u6539\u5c5e\u6027\u524d\u5148\u83b7\u53d6 int flag = fcntl(fd,F_GETFL); \u8bbe\u7f6e\u4e00\u4e0b flag |= O_NONBLOCK; \u518d\u8bbe\u7f6e\u56de\u53bb fcntl(fd,F_SETFL,flag); \u5c06\u7f13\u51b2\u533a\u7684\u5168\u90e8\u6570\u636e\u90fd\u8bfb\u51fa while(recv() >0 ) {printf();} //\u5f53\u7f13\u51b2\u533a\u6570\u636e\u8bfb\u5b8c\u4e4b\u540e\uff0c\u8fd4\u56de\u662f\u5426\u4e3a0\uff1f [noblock_et_poll.c] while()\u540e\u518d\u8fdb\u884c\u6570\u636e\u56de\u5199 send(fd,buf,len,0); len ==0 prinf(\"\u65ad\u5f00\u8fde\u63a5\");close(fd); \u8fd8\u5f97\u4ece\u6811\u4e0a\u5220\u9664 len == -1,printf();exit(1); \u8fd9\u91cc\u5224\u65ad\u4e00\u4e0b errno==EAGAIN \u963b\u585e \u6570\u636e\u8bfb\u5b8c\u4e4b\u540e \u975e\u963b\u585e \u5f3a\u884c\u8bfb\u4e86\u4e00\u4e2a\u6ca1\u6709\u6570\u636e\u7684\u7f13\u51b2\u533a\uff08fd\uff09 \u5224\u65ad errno==EAGAIN 13\u3001\u6587\u4ef6\u63cf\u8ff0\u7b26\u7a81\u78341024\uff0820200419\uff09 \u00b6 select--\u7a81\u7834\u4e0d\u4e86\uff0c\u9700\u8981\u7f16\u8bd1\u5185\u6838 \u901a\u8fc7\u6570\u7ec4\u5b9e\u73b0\u7684\uff0c \u6570\u7ec4\u6709\u56fa\u5b9a\u5927\u5c0f poll\u548cepoll\u53ef\u4ee5\u7a81\u78341024\u9650\u5236 poll\u662f\u901a\u8fc7\u5185\u90e8\u94fe\u8868\u5b9e\u73b0\u7684 epoll\u662f\u901a\u8fc7\u7ea2\u9ed1\u6811\u6765\u5b9e\u73b0\u7684 \u67e5\u770b\u53d7\u8ba1\u7b97\u673a\u786c\u4ef6\u9650\u5236\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0a\u9650 cat\u6216vi /proc/sys/fs.file-max ulimit -a \u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u4fee\u6539\u4e0a\u9650\u503c /etc/security/limits.conf ulimit -n \u4fee\u6539open files\u7684\u6570\u91cf 14\u3001udp\u901a\u4fe1\u6d41\u7a0b\uff0820200413\uff09 \u00b6 \u57fa\u4e8eSOCK_STREAM\uff0c \u9762\u5411\u65e0\u8fde\u63a5 \uff0c\u4e0d\u9700\u8981 connect() \u670d\u52a1\u5668\u7aef\uff1a Server\u53ea\u6709\u4e00\u4e2a \u521b\u5efa\u5957\u63a5\u5b57 int fd = socket(af_inet,sock_dgram,0); \u7ed1\u5b9a\u672c\u5730IP\u548c\u7aef\u53e3 bind() \u901a\u4fe1\uff1a\u63a5\u6536\u6570\u636e recvfrom() \u53d1\u9001\u6570\u636e sendto() \u5173\u95ed\u5957\u63a5\u5b57 close() \u5ba2\u6237\u7aef \u521b\u5efa\u5957\u63a5\u5b57 int fd = socket(af_inet,sock_dgram,0); \u901a\u4fe1\uff1a\u53d1\u9001\u6570\u636e sendto() \u63a5\u6536\u6570\u636e recvfrom() \u5173\u95ed\u5957\u63a5\u5b57 close() \u5ba2\u6237\u7aef\u662f\u901a\u8fc7\uff08IP+\u7aef\u53e3\uff09\u53d1\u9001\u7ed9\u670d\u52a1\u5668\u7aef\uff0c\u670d\u52a1\u5668\u4f1a\u4fdd\u5b58\u5ba2\u6237\u7aef\u7684IP+\u7aef\u53e3\u4fe1\u606f \u3002 qt\u91cc\u9762\uff0c\u4e24\u8005\u6d41\u7a0b\u90fd\u5dee\u4e0d\u591a\uff0c\u5982\u679c\u4efb\u4f55\u4e00\u7aef\u60f3\u63a5\u53d7\u6570\u636e\uff0c\u5fc5\u987b\u7ed1\u5b9a\u7aef\u53e3 \u56e0\u4e3a\u662f\u88ab\u5c01\u88c5\u8fc7\u4e86\u3002 \u8d8a\u5c01\u88c5\u8d8a\u7b80\u5355\uff0c\u8d8a\u7b80\u5355\u8d8a\u4e0d\u77e5\u9053\u600e\u4e48\u56de\u4e8b 15\u3001udp\u670d\u52a1\u5668\u7aef\u4ee3\u7801\u5b9e\u73b0\uff0820200413\uff09 \u00b6 recvfrom() sendto() [server.c] 16\u3001udp\u5ba2\u6237\u7aef\u4ee3\u7801\u5b9e\u73b0\uff0820200413\uff09 \u00b6 [client.c] day14\u3001\u5e7f\u64ad-\u7ec4\u64ad-\u672c\u5730\u5957\u63a5\u5b57 \u00b6 01\u3001\u77e5\u8bc6\u70b9\u6982\u8ff0 \u00b6 02\u3001epoll\u590d\u4e60 \u00b6 03\u3001udp\u901a\u4fe1\u6d41\u7a0b\u590d\u4e60\uff08\uff09 \u00b6 04\u3001tcp_udp\u4f7f\u7528\u573a\u666f\uff0820200419\uff09 \u00b6 1\u3001tcp\u4f7f\u7528\u573a\u666f \u5bf9\u6570\u636e\u5b89\u5168\u6027\u8981\u6c42\u9ad8\u7684\u65f6\u5019 \u767b\u5f55\u6570\u636e\u7684\u4f20\u8f93 \u6587\u4ef6\u4f20\u8f93 http\u534f\u8bae \u4f20\u8f93\u5c42\u534f\u8bae--tcp 2\u3001udp\u4f7f\u7528\u573a\u666f \u6548\u7387\u9ad8--\u5b9e\u65f6\u6027\u8981\u6c42\u6bd4\u8f83\u9ad8 \u89c6\u9891\u804a\u5929 \u901a\u8bdd \u6709\u5b9e\u529b\u7684\u5927\u516c\u53f8 \u5148\u4f7f\u7528upd\uff0c\u5728\u5e94\u7528\u5c42\u81ea\u5b9a\u4e49\u534f\u8bae\uff0c\u505a\u6570\u636e\u6821\u9a8c 05\u3001\u5e7f\u64ad\u901a\u4fe1\u6d41\u7a0b\uff0820200419\uff09 \u00b6 \u5e7f\u64ad\uff08\u53ea\u6709\u5728udp\u65f6\u624d\u53ef\u4ee5\uff09 \u670d\u52a1\u5668\uff1a\u53ea\u4e3b\u52a8\u53d1\u6570\u636e \u9700\u8981\u5e7f\u64ad\u5730\u5740\uff0c\u53d1\u9001\u5230\u56fa\u5b9a\u7aef\u53e3 \u7a97\u53e3\u5957\u63a5\u5b57--socket fd\u9700\u8981\u7ed1\u5b9a\u670d\u52a1\u5668IP\u548c\u7aef\u53e3 \u521d\u59cb\u5316\u5ba2\u6237\u7aefIP\u548c\u7aef\u53e3\u4fe1\u606f struct sockaddr_in cli; \u53d1\u9001\u6570\u636e sendto(fd,buf,len,0,) \u8bbe\u7f6e\u5e7f\u64ad\u6743\u9650 setsockopt() \u5ba2\u6237\u7aef\uff1a\u88ab\u52a8\u6536\u6570\u636e \u7ed1\u5b9a\u56fa\u5b9a\u7aef\u53e3 \uff0c\u4f60\u4e0d\u7ed1\u5b9a\u56fa\u5b9a\u7aef\u53e3\uff0c\u4e5f\u4f1a\u6536\u5230\u6570\u636e\uff0c\u53ea\u4e0d\u8fc7\u4e0d\u5904\u7406\uff0c\u88ab\u5f53\u6210\u5783\u573e\u5904\u7406\u5904\u7406\u6389\u4e86 \u521b\u5efa\u5957\u63a5\u5b57 \u663e\u793a\u7ed1\u5b9aIP\u548c\u7aef\u53e3 bind() \u63a5\u6536\u6570\u636e--server\u6570\u636e recvfrom() \u9002\u7528\u8303\u56f4 \u53ea\u9002\u7528\u4e8e\u5c40\u57df\u7f51 \u5e7f\u64ad\u5730\u5740 XXX.XXX.123.255\uff0c123\u7f51\u6bb5\u7684\u90fd\u80fd\u6536\u5230\uff0c 255\u5c31\u662f\u5e7f\u64ad\u5730\u5740 \u3002 XXX.XXX.123.1\uff0c 1\u662f\u7f51\u5173 255.255.255.255\u6240\u6709\u7f51\u6bb5\u90fd\u80fd\u6536\u5230\u3002 06\u3001\u5e7f\u64ad\u670d\u52a1\u5668\u4ee3\u7801\u5b9e\u73b0\uff0820200419\uff09 \u00b6 [broadcast_server.c] 07\u3001\u5e7f\u64ad\u5ba2\u6237\u7aef\u4ee3\u7801\u5b9e\u73b0\uff0820200419\uff09 \u00b6 [broadcast_client.c] 08\u3001\u5e7f\u64ad\u5ba2\u6237\u7aef\u901a\u4fe1\u603b\u7ed3\uff0820200419\uff09 \u00b6 09\u3001\u7ec4\u64ad\u901a\u4fe1\u6d41\u7a0b\uff0820200420\uff09 \u00b6 \u5e7f\u64ad\u53ea\u80fd\u7528\u4e8e\u5c40\u57df\u7f51\u8303\u56f4 \u3002 \u7ec4\u64ad\u53ef\u4ee5\u9002\u7528\u4e8e\u5c40\u57df\u7f51\u548cInternet \u7ec4\u64adServer \u53ea\u53d1\u9001\u6570\u636e \u9700\u8981\u4f7f\u7528\u7ec4\u64ad\u5730\u5740\uff0c\u53d1\u9001\u5230\u5ba2\u6237\u7aef\u5bf9\u5e94\u7684\u7aef\u53e38989 \u6dfb\u52a0\u7ec4\u64ad\u6743\u9650 \uff0c setsockopt() \u7ec4\u64adClient \u7ed1\u5b9a\u56fa\u5b9a\u7aef\u53e38989 \u52a0\u5165\u5230\u7ec4\u64ad\u5730\u5740\uff0c setsockopt() \u53ea\u63a5\u6536\uff0c\u4e0d\u53d1\u9001\u6570\u636e \u7ec4\u64ad\u5730\u5740 \uff084\u7c7b\uff09 224.0.0.0-224.0.0.255\uff08\u9884\u7559\u7684\u6c38\u4e45\u5730\u5740\uff09 239.0.0.0-239.255.255.255\uff08\u5c40\u57df\u7f51\uff09 struct ip_mreqn struct in_addr 10\u3001\u7ec4\u64ad\u670d\u52a1\u5668\u4ee3\u7801\u5b9e\u73b0\uff082020420\uff09 \u00b6 \u8981\u5bf9 struct ip_mreqn \u521d\u59cb\u5316\uff0c\u540d\u79f0\u8bb0\u4e3a \u7f8e\u4eba\u513f\u53bb\u54ea if_nametoindex() \u901a\u8fc7eth0\u8fd9\u6837\u7684\u540d\u79f0\uff0c\u83b7\u53d6mac\u5730\u5740\uff0c if\u4ee3\u8868ifconfig\u7684if \u3002 \u5bf9\u6bd4\u4e00\u4e0b\u7ec4\u64ad\u3001\u5e7f\u64ad\u7684\u4ee3\u7801 11\u3001\u7ec4\u64ad\u5ba2\u6237\u7aef\u4ee3\u7801\u5b9e\u73b0\uff0820200420\uff09 \u00b6 12\u3001\u590d\u4e60 \u00b6 13\u3001\u672c\u5730\u5957\u63a5\u5b57\u901a\u4fe1\u6d41\u7a0b\uff0820200421\uff09 \u00b6 \u6587\u4ef6\u683c\u5f0f \u7ba1\u9053\uff1ap \u5957\u63a5\u5b57\uff1as \u8fd9\u4e24\u4e2a\u6587\u4ef6\u662f\u4f2a\u6587\u4ef6 \uff08\u5728\u78c1\u76d8\u4e0a\u5927\u5c0f\u6c38\u8fdc\u4e3a0\uff0c\u4e0d\u5b58\u5728\u78c1\u76d8\uff0c\u5b58\u5728\u5185\u6838\u7f13\u51b2\u533a\u91cc\uff09 \u6709\u4e24\u79cd\u65b9\u5f0f tcp\u6d41\u7a0b\uff0c \u8bb2\u8fd9\u4e2a udp \u670d\u52a1\u5668\u7aef \u521b\u5efa\u5957\u63a5\u5b57 int lfd = socket(AF_LOCAL,sock_stream,0) \u7ed1\u5b9a struct sockaddr_un serv; serv.sun_family=af_local; strcpy(serv.sun_path,\"server.socket\");bind(lfd,(struct sockaddr_un&serv,len); \u53ea\u6709\u7ed1\u5b9a\u6210\u529f\u540e\uff0c.socket\u6587\u4ef6\u624d\u80fd\u88ab\u521b\u4ef6\u51fa\u6765 \u8bbe\u7f6e\u76d1\u542c listen() \u7b49\u5f85\u63a5\u6536\u6d88\u606f\u8bf7\u6c42 struct sockaddr_un client; int len = sizeof(client); int cfd = accept(lfd,&client,&len); \u901a\u4fe1 send\u548crecv \u65ad\u5f00\u8fde\u63a5 close(cfd),close(lfd) \u5ba2\u6237\u7aef \u521b\u5efa\u5957\u63a5\u5b57 int lfd = socket(AF_LOCAL,sock_stream,0) \u7ed1\u5b9a\u4e00\u4e2a\u5957\u63a5\u5b57\u6587\u4ef6 \uff1a struct sockaddr_un client; client.sun_family=af_local; strcpy(client.sun_path,\"client.socket\");bind(lfd,(struct sockaddr_un&client,len); \u8fde\u63a5\u670d\u52a1\u5668\uff1a struct sockaddr_un serv; serv.sun_family=af_local; strcpy(serv.sun_path,\"server.socket\"); \uff0c \u7136\u540e\u518d\u8fde\u63a5server \uff0c connect(fd,&serv,sizeof(serv)); \u901a\u4fe1 send\u548crecv \u65ad\u5f00\u8fde\u63a5 close(cfd),close(lfd) 14\u3001\u672c\u5730\u5957\u63a5\u5b57Server\u5b9e\u73b0\uff0820200421\uff09 \u00b6 15\u3001\u672c\u5730\u5957\u63a5\u5b57Client\u5b9e\u73b0\uff0820200421\uff09 \u00b6 16\u3001\u5fc3\u8df3\u5305\uff0820200422\uff09 \u00b6 \u4f5c\u7528\uff1a \u5224\u65ad\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u662f\u5426\u5904\u4e8e\u8fde\u63a5\u72b6\u6001 \u5fc3\u8df3\u673a\u5236 \u4e0d\u4f1a\u643a\u5e26\u5927\u91cf\u7684\u6570\u636e \u6bcf\u4e2a\u4e00\u5b9a\u65f6\u95f4 \u670d\u52a1\u5668->\u5ba2\u6237\u7aef/\u5ba2\u6237\u7aef->\u670d\u52a1\u5668\u53d1\u9001\u4e00\u4e2a\u6570\u636e\u5305 \u5fc3\u8df3\u5305\u770b\u6210\u4e00\u4e2a\u534f\u8bae \u5e94\u7528\u5c42\u534f\u8bae \u5224\u65ad\u7f51\u7edc\u662f\u5426\u65ad\u5f00 \u6709\u591a\u4e2a\u8fde\u7eed\u7684\u5fc3\u8df3\u5305\u6ca1\u6536\u5230/\u6ca1\u6709\u56de\u590d \u5173\u95ed\u901a\u4fe1\u7684\u5957\u63a5\u5b57 \u91cd\u8fde \u91cd\u65b0\u521d\u59cb\u5957\u63a5\u5b57 \u7ee7\u7eed\u53d1\u9001\u5fc3\u8df3\u5305 \u4e52\u4e53\u5305 \u6bd4\u5fc3\u8df3\u5305\u643a\u5e26\u7684\u6570\u636e\u591a\u4e00\u4e9b \u9664\u4e86\u77e5\u9053\u8fde\u63a5\u662f\u5426\u5b58\u5728\uff0c\u8fd8\u80fd\u83b7\u53d6\u4e00\u4e9b\u4fe1\u606f \u5fc3\u8df3\u5305\u7684\u5b9e\u73b0 -- \u770b\u4e00\u4e0b\u9879\u76ee\u91cc\u7684\u4ee3\u7801 17\u3001epoll\u53cd\u5e94\u5806\u6a21\u578bmain\u51fd\u6570\uff0820200424\uff09 \u00b6 [epoll_loop.c]\u7684\u6e90\u7801\u5b66\u4e60 \u770b\u4ee3\u7801\u65f6\uff0c\u5148\u4e0d\u8981\u8ffd\u6c42\u7ec6\u8282\uff0c\u8981\u5148\u7406\u6e05\u6d41\u7a0b \u3002 18\u3001epoll\u53cd\u5e94\u5806\u6a21\u578b\u76d1\u542c\u5957\u63a5\u5b57\u521d\u59cb\u51fd\u6570\uff0820200425\uff09 \u00b6 19\u3001epoll\u53cd\u5e94\u5806\u6a21\u578bacceptconn\u51fd\u6570 \u00b6 day15\u3001libevent \u00b6 day16\u3001xml json \u00b6","title":"\u300aLinux\u9ad8\u5e76\u53d1\u7f51\u7edc\u7f16\u7a0b\u5f00\u53d1\u300b"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#_1","text":"","title":"\u5185\u5bb9"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#day10socket","text":"","title":"day10\u3001\u7f51\u7edc\u7f16\u7a0b\u57fa\u7840socket"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#0120200401","text":"\u7b2c8-10\u5929\uff0c\u81ea\u5df1\u5b9e\u73b0\u4e00\u4e2aMini Web\u670d\u52a1\u5668\uff08\u6709\u4e24\u4e2a\u529f\u80fd\uff09 \u5904\u7406\u7f51\u7edcI/O \u4e1a\u52a1\u5904\u7406","title":"01\u3001\u77e5\u8bc6\u70b9\u6982\u8ff0\uff0820200401\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#02","text":"","title":"02\u3001\u7f51\u7edc\u5f00\u53d1\u4e24\u79cd\u8bbe\u8ba1\u6a21\u5f0f\uff08\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#03","text":"","title":"03\u3001\u7f51\u7edc\u6a21\u578b\u5206\u5c42\uff08\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#04","text":"","title":"04\u3001\u4ee5\u592a\u7f51\u5e27\u534f\u8bae\uff08\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#05ip","text":"","title":"05\u3001IP\u534f\u8bae\uff08\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#06udp","text":"","title":"06\u3001UDP\u534f\u8bae\uff08\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#07tcp","text":"","title":"07\u3001TCP\u534f\u8bae\uff08\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#08tcp-ip","text":"","title":"08\u3001TCP-IP\u56db\u5c42\u6a21\u578b\u534f\u8bae\u5c01\u88c5\uff08\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#09udptcp","text":"","title":"09\u3001UDP\u548cTCP\u8bb2\u89e3\uff08\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#1020200401","text":"Socket\u662f\u7f51\u7edc\u901a\u4fe1\u7684\u51fd\u6570\u63a5\u53e3\u7684\u603b\u79f0 \uff0c\u5c01\u88c5\u4e86\u4f20\u8f93\u5c42\u7684\u534f\u8bae\uff08TCP\uff0cUDP\uff09\u3002 \u6d4f\u89c8\u5668\uff0c\u5e94\u7528\u5c42\u7528\u7684\u662fHTTP\uff0c\u5f80\u4e0b\u5c01\u88c5\u7684\u662fTCP\u3002 Socket\uff1aIP+Port\u3002","title":"10\u3001\u4ec0\u4e48\u662f\u5957\u63a5\u5b57\uff0820200401\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#1120200401","text":"socket\u901a\u4fe1 \u670d\u52a1\u5668\u7aef\uff08\u63d2\u5ea7\uff09 \u88ab\u52a8 \u8ba9\u5ba2\u6237\u7aef\u8fde\u63a5\uff1b \u5ba2\u6237\u7aef\uff08\u7535\u98ce\u6247\u3001\u7535\u89c6\uff09 \u4e3b\u52a8 socket\u7f16\u7a0b-- \u7f51\u7edcIO\u7f16\u7a0b \u8bfb\u5199\u64cd\u4f5c\uff08read/wirte) \u6587\u4ef6\u63cf\u8ff0\u7b26 \u521b\u5efa\u4e00\u4e2a\u5957\u63a5\u5b57\uff0c\u5f97\u5230\u7684\u662f\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c \u8fd9\u4e2afd\u4e5f\u662f\u4e00\u5757\u5185\u6838\u7f13\u51b2\u533a \u5185\u6838\u7f13\u51b2\u533a\u5206\u4e3a\u4e24\u90e8\u5206\uff08\u8bfb\u7f13\u51b2\u533a\uff0c\u5199\u7f13\u51b2\u533a\uff09 \uff0c\u8fd9\u662f\u7cfb\u7edf\u5904\u7406\u597d\u7684\uff0c\u4e0d\u7528\u5e94\u7528\u7a0b\u5e8f\u5173\u5fc3\u3002 \u5ba2\u6237\u7aef\u7684\u6570\u636e\u5148write\u5230\u5199\u7f13\u51b2\u533a\uff0c\u7136\u540e\u4f1a\u5230\u540c\u6b65\u5230\u670d\u52a1\u7aef\u7684\u8bfb\u7f13\u51b2\u533a\u91cc\uff0c\u670d\u52a1\u7aeffd\u91cc\u7684\u5199\u7f13\u51b2\u533a\u4e5f\u4e00\u6837\u3002 \u4e0e\u533f\u540d\u7ba1\u9053\u7684\u533a\u522b\uff1f \u9ed8\u8ba4\u662f\u963b\u585e\u7684 \uff0c\u5bf9\u5e94\u7684\u662ffd\u7684\u8bbe\u5907\u7684\u6587\u4ef6\u6027\u8d28\uff0c\u4e0d\u662fwirte(),read()\u51fd\u6570\u7684\u6027\u8d28\u3002 \u533f\u540d\u7ba1\u9053 \u5206\u4e3a\u8bfb\u3001\u5199\u4e24\u7aef \u961f\u5217 \u6570\u636e\u7ed3\u6784 \u7ba1\u9053\u7684\u8bfb\u5199\u4e24\u7aef\u5206\u522b\u5bf9\u5e94\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26 \u5185\u6838\u7f13\u51b2\u533a\uff08\u5185\u5b58\u4e2d\u4e00\u5757\u5b58\u50a8\u7a7a\u95f4\uff09 \u9ed8\u8ba4\u662f\u963b\u585e\u7684","title":"11\u3001\u5957\u63a5\u5b57\u5185\u5b58\u6a21\u578b\uff0820200401\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#12","text":"","title":"12\u3001\u77e5\u8bc6\u70b9\u590d\u4e60\uff08\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#13","text":"","title":"13\u3001\u5927\u7aef\u548c\u5c0f\u7aef\u5b58\u50a8\uff08\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#14","text":"","title":"14\u3001\u5927\u5c0f\u7aef\u8f6c\u6362\u51fd\u6570"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#day11tcp-","text":"","title":"day11\u3001TCP\u4e09\u6b21\u63e1\u624b-\u5e76\u53d1"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#1","text":"3\u6b21\u63e1\u624b\u30014\u6b21\u6325\u624b\u3001\u6ed1\u52a8\u7a97\u53e3 connect\u65f6\u5c31\u4f1a\u63e1\u624b\uff0cclose\u65f6\u5c31\u4f1a\u6325\u624b \u9519\u8bef\u5904\u7406\u51fd\u6570\u5c01\u88c5 \u591a\u8fdb\u7a0b\u5e76\u53d1\uff0c\u591a\u7ebf\u7a0b\u5e76\u53d1","title":"1\u3001\u5b66\u4e60\u76ee\u6807"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#2","text":"\u7f51\u7edc\u5f00\u53d1\u8bbe\u8ba1\u6a21\u5f0f C/S\uff1a\u684c\u9762\u5ba2\u6237\u7aef B/S\uff1a\u8de8\u5e73\u53f0\uff0chttp\uff0c \u6548\u7387\u4f4e \u5206\u5c42\u6a21\u578b\uff1a \u4e03\u5c42 \u56db\u5c42\uff1a\u7f51\u7edc\u63a5\u53e3\u5c42\u3001\u7f51\u7edc\u5c42\u3001\u4f20\u8f93\u5c42\u3001\u5e94\u7528\u5c42 tcp,udp socket \u6587\u4ef6\uff08\u5185\u6838\u4e2d\u7684\u7f13\u51b2\u533a\uff09\u64cd\u4f5c socket tcp server\u7684\u64cd\u4f5c\u6d41\u7a0b \u8fd8\u662f\u8bb0\u4f4f\u8fd9\u4e9b\u51e0\u79cd\u7ec6\u8282 \uff0c10min\u5de6\u53f3 accpet()\u7684\u8fd4\u56de\u503c\uff0c\u662f\u7528\u4e8e\u901a\u4fe1\u7684 \uff0clisten()\u7684\u8fd4\u56de\u503c\uff0c\u662f\u7528\u4e8e\u76d1\u542c\u7684 close(lfd)\uff0cclose(cfd)\uff0c \u5c31\u9700\u8981\u5173\u95ed2\u6b21 socket tcp client\u7684\u64cd\u4f5c\u6d41\u7a0b struct sockaddr_in client; \uff0c\u8fdb\u884cconnect\u64cd\u4f5c","title":"2\u3001\u77e5\u8bc6\u70b9\u56de\u987e"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#3tcp20200401","text":"[client_tcp.c]","title":"3\u3001tcp\u5ba2\u6237\u7aef\u4ee3\u7801\u5b9e\u73b0\uff0820200401\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#4socket20200402","text":"[wrap.c]\u67e5\u770b Man\u6587\u6863\u8df3\u8f6c\u7684\u65f6\u5019\uff0c\u4e0d\u533a\u5206\u5927\u5c0f\u5199 \uff0c\u53ef\u4ee5\u628aaccept()\u7684\u51fd\u6570\u91cd\u88c5\u5305\u88c5\u6210Accpet()\u3002 \u7528\u5565+K\u53ef\u4ee5\u8df3\u8f6c\uff1flionel bind(),connect(),listen(),socket(),close()\uff0c\u8fd9\u4e9b\u8fd4\u56de-1\u65f6\uff0c\u5c31\u6253\u5370\u9519\u8bef\u3002 accept()\u3001read()\uff0cwrite()\u8fd4\u56de-1\uff0c\u90fd\u9012\u5f52\u8c03\u7528\u3002 read\u548cwrite\u4f1a\u963b\u585e \u3002 readn()\u662f\u81ea\u5df1\u5199\u7684\uff0c\u591a\u4e86\u4e2a \u5e94\u8be5\u8bfb\u53d6\u7684\u5b57\u8282\u6570 n \uff1b writen()\u4e5f\u662f\u81ea\u5df1\u5199\u7684\uff0c\u8ddfreadn()\u4e00\u6837 Readline()\u8c03\u7528\u4e00\u4e2a\u9759\u6001\u51fd\u6570my_read()","title":"4\u3001socket\u51fd\u6570\u5c01\u88c5\uff0820200402\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#5tcp20200403","text":"\u8fde\u63a5\u670d\u52a1\u5668\u7684\u8fc7\u7a0b\u4e2d\u5b8c\u6210\u4e09\u6b21\u63e1\u624b\uff0c6\u4e2a\u6807\u5fd7\u4f4d\uff1a SYN\uff1a\u8bf7\u6c42\u5efa\u7acb\u8fde\u63a5 ACK\uff1a\u5e94\u7b54 FIN\uff1a\u65ad\u5f00\u8fde\u63a5 RST URG PSH \u7b2c1\u6b21\u63e1\u624b\u662f\u7531\u5ba2\u6237\u7aef\u53d1\u8d77 \uff0c \u5ba2\u6237\u7aef\uff1a SYN\u6807\u5fd7\u4f4d+32\u4f4d\u5e8f\u53f7\uff08\u968f\u673a\u4ea7\u751f\uff09+\u6570\u636e\uff08\u4e5f\u53ef\u4ee5\u4e0d\u5e26\u6570\u636e\uff09 \u670d\u52a1\u5668 \u5224\u65adSYN\u503c\u4e3a1\u65f6\uff0c\u7b2c1\u6b21\u63e1\u624b\u624d\u7b97\u6210\u529f\u3002 \u7b2c2\u6b21\u63e1\u624b \u670d\u52a1\u5668 ACK\u6807\u5fd7\u4f4d+32\u786e\u8ba4\u5e8f\u53f7\uff08\u5728\u968f\u673a\u5e8f\u53f7\u57fa\u7840\u4e0a+1\uff09+\u6570\u636e\uff08\u4e5f\u53ef\u4ee5\u4e0d\u5e26\u6570\u636e\uff09 \u53d1\u8d77\u4e00\u4e2a\u8fde\u63a5\u8bf7\u6c42\uff1aSYN\u6807\u5fd7\u4f4d+32\u4f4d\u5e8f\u53f7\uff08\u968f\u673a\u4ea7\u751f\uff09+\u6570\u636e\uff08\u4e5f\u53ef\u4ee5\u4e0d\u5e26\u6570\u636e\uff09 \u5ba2\u6237\u7aef \u68c0\u6d4bACK\u6807\u5fd7\u4f4d\u662f\u4e0d\u662f\u4e3a1 \u68c0\u6d4b32\u4f4d\u786e\u8ba4\u5e8f\u53f7\u662f\u5426\u662f\u81ea\u5df1\u968f\u673a\u5e8f\u53f7\u57fa\u7840\u4e0a\u52a01 \u7b2c3\u6b21\u63e1\u624b \u5ba2\u6237\u7aef \u53d1\u9001\u786e\u8ba4\u6570\u636e\u5305\uff1aACK\u6807\u5fd7\u4f4d+32\u4f4d\u786e\u8ba4\u5e8f\u53f7 \u670d\u52a1\u5668\uff1a \u68c0\u6d4b\uff1aACK\u662f\u5426\u4e3a1\uff0c \u68c0\u6d4b\uff1a\u786e\u8ba4\u5e8f\u53f7\u662f\u5426\u6b63\u786e \u601d\u8003 \u5e26\u6570\u636e\u7684\u65f6\u5019\uff0c\u56de\u7684\u786e\u8ba4\u5e8f\u53f7\u662f\u591a\u5c11\uff1f\uff08\u5927\u5c0f\u540e\u518d\u52a01\uff1f\uff09","title":"5\u3001TCP\u4e09\u6b21\u63e1\u624b\uff0820200403\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#6tcp20200403","text":"MSS\uff08\u6700\u5927\u6570\u636e\u957f\u5ea6\uff09\uff1a\u5ba2\u6237\u7aef\u544a\u8bc9\u670d\u52a1\u5668\uff0c\u4f60\u7ed9\u6211\u53d1\u7684\u6570\u636e\u957f\u5ea6\u7684\u503c\u3002 \u4e09\u6b21\u63e1\u624b\uff0c\u5efa\u7acb\u8fde\u63a5\u7684\u8fc7\u7a0b \u5ba2\u6237\u7aef\uff1a connect() \u670d\u52a1\u5668\uff1a accept() \u6570\u636e\u4f20\u8f93 \u5ba2\u6237\u7aef\uff1a\u7f16\u53f7\uff08\u5bf9\u65b9\u6700\u540e\u53d1\u9001ACK\u7684\u65f6\u5019\u643a\u5e26\u7684\u786e\u8ba4\u5e8f\u53f7\uff09+ACK+\u5bf9\u65b9\u6700\u540e\u4e00\u6b21\u7684ACK\u7f16\u53f7 \u670d\u52a1\u7aef\uff1aACK+\u786e\u8ba4+\u6570\u636e \u5ba2\u6237\u7aef\uff1aACK+\u786e\u8ba4 \u8fd9\u90e8\u5206\u5176\u5b9e\u6ca1\u592a\u5b8c\u5168\u61c2\uff0c\u4f46\u770b\u56fe\u80fd\u8bf4\u51fa\u4e2a\u5927\u6982\u6765 \uff0c \u6570\u636e\u8fde\u63a5\u8fc7\u7a0b\u4e2d\u6ca1\u6709SYN\u5173\u952e\u5b57","title":"6\u3001TCP\u7684\u6570\u636e\u4f20\u8f93\u8fc7\u7a0b\uff0820200403\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#0720200403","text":"\u54ea\u4e00\u4e9b\u4e3b\u52a8\u4e3b\u52a8\u65ad\u5f00\u8fde\u63a5\u90fd\u53ef\u4ee5 \u3002 \u9700\u8981\u4e00\u4e2a\u6807\u5fd7\u4f4d\uff1aFIN\u3002 \u7b2c\u4e00\u6b21\u6325\u624b \u5ba2\u6237\u7aef\uff08\u53d1\u9001\u65ad\u5f00\u7684\u8bf7\u6c42\uff09\uff1a FIN+\u5bf9\u65b9\u6700\u540e\u53d1\u9001ACK\u7684\u65f6\u5019\u643a\u5e26\u7684\u786e\u8ba4\u5e8f\u53f7+\u6570\u636e\uff08\u53ef\u4ee5\u4e0d\u5e26\uff09\uff1b ACK+\u5e8f\u53f7\uff08\u5bf9\u65b9\u7684\u53d1\u9001\u7684\u5e8f\u53f7+\u957f\u5ea6\uff09 \u670d\u52a1\u7aef\uff1a \u68c0\u6d4bFIN\u503c\u662f\u5426\u4e3a1 ACK\u7684\u4f5c\u7528\uff1a\u544a\u8bc9\u5bf9\u65b9\u4e4b\u524d\u53d1\u7684\u6570\u636e\u6536\u5230\u4e86\u591a\u5c11 \u7b2c\u4e8c\u6b21\u6325\u624b \u670d\u52a1\u5668\uff08\u7ed9Client\u786e\u8ba4\u6570\u636e\u5305\uff09 ACK+\u786e\u8ba4\u7f16\u53f7\uff08FIN\u5bf9\u5e94\u7684\u5e8f\u53f7+1+\u6570\u636e\u5927\u5c0f\uff09 \u5ba2\u6237\u7aef\uff1a \u68c0\u6d4b\uff1aACK\u7684\u503c \u68c0\u6d4b\uff1a\u786e\u8ba4\u5e8f\u53f7 \u7b2c\u4e09\u6b21\u6325\u624b\uff1a\uff08 \u670d\u52a1\u5668\u53d1\u8d77\u7684\u544a\u522b\u8fc7\u7a0b \uff09 \u670d\u52a1\u5668\u7aef\uff08\u53d1\u9001\u65ad\u5f00\u8fde\u63a5\u7684\u8bf7\u6c42\uff09 FIN+\u5e8f\u53f7\uff08\u6700\u540e\u4e00\u6b21\u6536\u5230\uff0c\u5bf9\u65b9\u7684ACK\uff09 ACK+\u5e8f\u53f7 \u5ba2\u6237\u7aef\uff1a \u6570\u636e\u68c0\u6d4b\uff0c\u6570\u636e\u662f\u4e0d\u662f\u6536\u5230 \u7b2c\u56db\u6b21\u6325\u624b \u5ba2\u6237\u7aef\uff1a ACK+\u5e8f\u53f7\uff08\u6536\u5230\u7684ACK\u5e8f\u53f7+1\uff09 \u7b2c2\u6b21\u548c\u7b2c3\u6b21\u90fd\u662f\u540c\u4e00\u4e2a\u4eba\u53d1\u7684 \uff0c \u4e3b\u8981\u662f\u5e8f\u53f7\u7684\u503c\uff0c\u8981\u786e\u8ba4\u4e00\u4e0b \u3002 \u5728\u4ee3\u7801\u4e2d\u8868\u73b0\u5c31\u662f \u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u90fd\u662f\u7528 close()","title":"07\u3001\u56db\u6b21\u6325\u624b\uff0820200403\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#0820200403","text":"\u6ed1\u52a8\u7a97\u53e3 \u5c31\u662f\u7f13\u5b58\uff0c\u5bf9\u5e94\u7684\u201c16\u4f4d\u7a97\u53e3\u5927\u5c0f\u201d\uff0c\u5c31\u662f\u8bb0\u5f55\u7684\u7f13\u5b58\u5927\u5c0f\u3002 WIN 4096 win-\u6ed1\u52a8\u7a97\u53e3 4096-\u6ed1\u52a8\u7a97\u53e3\u5bf9\u5e94\u7684\u7f13\u51b2\u533a\u5927\u5c0f \u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u7684WIN\uff0c\u5927\u5c0f\u503c\u53ef\u4ee5\u4e0d\u4e00\u6837 \uff0c\u4e00\u822c\u90fd\u4e0d\u4e00\u6837\u3002 \u53ef\u4ee5\u53d1\u5f88\u591a\u6761\uff0c\u670d\u52a1\u5668\u518d\u7b54\u590d\u3002","title":"08\u3001\u6ed1\u52a8\u7a97\u53e3\uff0820200403\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#0920200404","text":"\u5e76\u53d1 \uff1a\u5728\u67d0\u4e2a\u65f6\u95f4\u70b9\u5904\u7406\u7684\u4e2a\u6570\u3002 \u670d\u52a1\u7aef\u53ea\u5904\u7406\u5355\u8fde\u63a5 \u521b\u5efa\u5957\u63a5\u5b57 \u7ed1\u5b9a \u76d1\u542c \u63a5\u53d7\u8fde\u63a5\u8bf7\u6c42 \u901a\u4fe1 \u670d\u52a1\u7aef\u5904\u7406\u591a\u8fde\u63a5 \u76d1\u542c\uff1a\u6700\u591a\u53ef\u4ee5128\u4e2a\u3010listen(fd,128)\u3011 \u63a5\u53d7\u8fde\u63a5\u8bf7\u6c42 \u8ba9\u7236\u8fdb\u7a0b\u521b\u5efa\u5b50\u8fdb\u7a0b\uff0c\u53bb\u8fde\u63a5\u5ba2\u6237\u7aefA \u7236\u8fdb\u7a0b\u53ea\u7b49\u5f85\u8fde\u63a5\u8bf7\u6c42 \uff0c\u6709\u8bf7\u6c42\u5c31fork()\u4e00\u4e0b \u4f7f\u7528\u591a\u8fdb\u7a0b\u7684\u65b9\u5f0f\uff0c\u89e3\u51b3\u670d\u52a1\u5668\u5904\u7406\u591a\u8fde\u63a5\u7684\u95ee\u9898 \u5171\u4eab \u8bfb\u65f6\u5171\u4eab\uff0c\u5199\u65f6\u590d\u5236 \uff0c\u8bfb\u7684\u65f6\u5019\u5bf9\u5e94\u7684\u540c\u4e00\u4e2a\u7269\u7406\u5730\u5740\uff1b\u5199\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u5f00\u8f9f\u65b0\u7684\u7a7a\u95f4\uff0c\u518d\u8bfb\u5c31\u4f1a\u53bb\u65b0\u5f00\u8f9f\u7684\u7a7a\u95f4\u8bfb\u3002 \u5171\u4eab\u7684\u5185\u5bb9\u6709\uff1a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff1b\u5185\u5b58\u6620\u5c04\u533a--mmap\u521b\u5efa\u51fa\u6765\u7684\uff1b \u7236\u8fdb\u7a0b\u7684\u89d2\u8272\u662f\u4ec0\u4e48\uff1f \u7b49\u5f85\u63a5\u6536\u5ba2\u6237\u7aef\u8fde\u63a5 ---accept() \u6709\u8fde\u63a5\uff0c\u521b\u5efa\u4e00\u4e2a\u5b50\u8fdb\u7a0b fork() \u5c06\u901a\u4fe1\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u5173\u95ed \u5b50\u8fdb\u7a0b\u7684\u89d2\u8272\u662f\u4ec0\u4e48\uff1f \u901a\u4fe1 \u4f7f\u7528accept()\u8fd4\u56de\u503c\uff0c\u5c31\u662ffd\u3002 \u5173\u6389\u76d1\u542c\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26 \u4e3b\u8981\u539f\u56e0\u662f\uff1a\u6d6a\u8d39\u8d44\u6e90\uff08\u56e0\u4e3afd\u7684\u4e2a\u6570\u6709\u9650\uff0c\u624d1024\u4e2a\uff09 \u521b\u5efa\u7684\u8fdb\u7a0b\u7684\u4e2a\u6570\u6709\u9650\u5236\u5417\uff1f \u6709\uff0c\u53d7\u786c\u4ef6\u9650\u5236\u3002 \u6587\u4ef6\u63cf\u8ff0\u7b26\u9ed8\u8ba4\u6709\u4e0a\u9650\u662f1024\u4e2a \u3002 \u5b50\u8fdb\u7a0b\u8d44\u6e90\u56de\u6536 \u4e0d\u56de\u6536\u7684\u8bdd\uff0c\u4f1a\u88abinit\u56de\u6536\u6216\u53d8\u6210\u50f5\u5c38\u8fdb\u7a0b\u3002 wait()\u6216waitpid()\u56de\u6536\u3002 \u7528\u4fe1\u53f7\u56de\u6536 \u4fe1\u53f7\u6355\u6349\uff08signal\uff0csigaction\uff09\u63a8\u8350\u540e\u8005 \u6355\u6349SIGCHLD\u4fe1\u53f7 \u6587\u4ef6\u63cf\u8ff0\u7b26\uff08\u67092\u4e2a\uff09\uff1f \u7528\u4e8e\u76d1\u542c\u7684 \u7528\u4e8e\u901a\u4fe1\u7684","title":"09\u3001\u591a\u8fdb\u7a0b\u5e76\u53d1\u670d\u52a1\u5668\u5206\u6790\uff0820200404\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#1020200404","text":"[\u591a\u8fdb\u7a0b\u5e76\u53d1\u670d\u52a1\u5668\u4f2a\u4ee3\u7801.c]","title":"10\u3001\u591a\u8fdb\u7a0b\u5e76\u53d1\u670d\u52a1\u5668\u4f2a\u4ee3\u7801\uff0820200404\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#1120200404","text":"[process_server.c]","title":"11\u3001\u591a\u8fdb\u7a0b\u5e76\u53d1\u670d\u52a1\u5668\u4ee3\u7801\u5b9e\u73b0\uff0820200404\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#1220200404","text":"\u670d\u52a1\u5668\u6536\u5230\u5ba2\u6237\u7aef\u7684connect()\uff0c\u53ef\u4ee5\u5f53\u4f5c\u662f\u4e3b\u7ebf\u7a0b\u6536\u5230\uff0c\u7136\u540e pthread_creat() \u521b\u5efa\u5b50\u7ebf\u7a0b\u5904\u7406\u3002 \u628a\u6587\u4ef6\u63cf\u8ff0\u4f20\u5230\u5b50\u7ebf\u7a0b\u5185\u90e8\uff0c\u8fdb\u884cread/write\u64cd\u4f5c\u3002 \u7ebf\u7a0b\u5171\u4eab\uff1a \u5168\u5c40\u6570\u636e\u533a \u5806\u533a\u6570\u636e \u4e00\u5757\u6709\u6548\u5185\u5b58\u7684\u5730\u5740 \u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u8981\u5907\u4efd\u72ec\u7acb\u7684\u5904\u7406 \uff0c\u628a\u5904\u7406\u5c01\u88c5\u5230\u7ed3\u6784\u4f53\u91cc\uff0c\u540c\u65f6\u5728\u56de\u8c03\u51fd\u6570\u91cc\u5904\u7406\u3002","title":"12\u3001\u591a\u7ebf\u7a0b\u5e76\u53d1\u670d\u52a1\u5668\u5b9e\u73b0\u601d\u8def\uff0820200404\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#1320200404","text":"[pthread_server.c]","title":"13\u3001\u591a\u7ebf\u7a0b\u7248\u5ba2\u6237\u7aef\u4ee3\u7801\u5b9e\u73b0\uff0820200404\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#day12tcp-select-poll","text":"","title":"day12\u3001TCP\u72b6\u6001\u8f6c\u6362-select-poll"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#01","text":"","title":"01\u3001\u77e5\u8bc6\u70b9\u6982\u8ff0"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#02_1","text":"","title":"02\u3001\u4e09\u6b21\u63e1\u624b\u56db\u6b21\u6325\u624b\u590d\u4e60"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#03_1","text":"","title":"03\u3001\u591a\u8fdb\u7a0b\u591a\u7ebf\u7a0b\u5e76\u53d1\u590d\u4e60\uff08\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#04recvsend20200406","text":"\u6570\u636e\u63a5\u6536 read() recv() \u6570\u636e\u53d1\u9001 write() send() \u4e24\u8005\u662f\u53ef\u66ff\u4ee3\u7684\uff0c \u533a\u522b\u5728\u4e8e\u540e\u9762\u7684\u51fd\u6570\u591a\u4e86\u4e00\u4e2a\u53c2\u6570flags\uff0c\u8d4b\u503c\u4e3a0\u5373\u53ef \u3002 UDP\u7684\u8bdd\uff0c\u7528\u7684\u662f recvfrom() \u548c sendto() \u5b83\u4eec\u7684flags\u4e5f\u8d4b\u503c\u4e3a0 \u3002","title":"04\u3001recv\u548csend\u51fd\u6570\uff0820200406\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#05tcp20200408","text":"\u5ba2\u6237\u7aef\uff1a CLOSED -> SYN_SENT -> ESTABLISTHED ->\u6570\u636e\u4f20\u5077\u4e2d\u72b6\u6001\u4e0d\u53d8-> \u8c01\u5148\u53d1\u9001\u6325\u624b\u8bf7\u6c42\uff0c\u8c01\u5148\u53d8 -> FIN_WAIT_1 -> FIN_WAIT_2 -> TIME_WAIT -> CLOSED \u4e3b\u52a8\u65ad\u5f00\u7684\u4e00\u65b9\uff0c\u6700\u540e\u7684\u72b6\u6001\u662f TIME_WAIT \u3002 \u670d\u52a1\u7aef\uff1a CLOSED -> LISTEN -> SYN_RCVD -> ESTABLISTHED -> CLOSE_WAIT -> LAST_ACK -> CLOSED \u8fd9\u4e0d\u662f\u670d\u52a1\u7aef\u4e3b\u52a8\u65ad\u5f00\u8fde\u63a5 \u3002","title":"05\u3001tcp\u72b6\u6001\u8f6c\u6362\uff0820200408\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#062msl20200408","text":"\u80fd\u6355\u6349\u5230\u7684\u72b6\u6001\uff08netstat\u547d\u4ee4\u4f1a\u6355\u6349\uff09 LISTEN ESTABLISHED \u4e3b\u52a8\u65ad\u5f00\u8fde\u63a5\u7684\u4e00\u65b9\u5230 TIME_WAIT \u72b6\u6001\u65f6\uff0c\u4f1a\u7b49\u5f852MSL\u65f6\u957f\uff0c\u4e00\u4e2aMSL\u662f30\u79d2\uff0c2\u4e2a\u5c31\u662f1\u5206\u949f\u3002 \u6015\u5bf9\u65b9\u6ca1\u6709\u6536\u5230\uff0c\u7528\u8fd9\u4e2a2MSL\u518d\u53d1\u9001\u4e00\u6b21\u3002","title":"06\u30012msl\u7b49\u5f85\u65f6\u957f\uff0820200408\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#0720200408","text":"\u5982\u4f55\u7406\u89e3\uff1f \u6709\u4e00\u7aef\u5173\u95ed\uff0c\u53e6\u4e00\u7aef\u6ca1\u5173\u95ed A\u7ed9B\u53d1\u9001\u662fFIN\uff08A\u8c03\u7528\u4e86close\u51fd\u6570\uff09\uff0c\u4f46\u662fB\u6ca1\u6709\u7ed9A\u53d1\u9001FIN\uff08B\u6ca1\u6709\u8c03\u7528close\uff09 \u5373A\u65ad\u5f00\u4e86\u4e0eB\u7684\u8fde\u63a5\uff0cB\u6ca1\u6709\u65ad\u5f00\u4e0eA\u7684\u8fde\u63a5\u3002 \u7279\u70b9\uff1a A\u4e0d\u80fd\u7ed9B\u53d1\u9001\u6570\u636e\uff0c\u4f46\u80fd\u6536\u5230B\u53d1\u9001\u7684\u6570\u636e\u3002 B\u80fd\u7ed9A\u53d1\u9001\u6570\u636e \u51fd\u6570\uff1a shutdown(int sockfd, int how) how SHUT_RD 0\u8bfb SHUT_WR 1 \u5199 SHUT_RDWR 2 \u8bfb\u5199 \u628a\u62f7\u8d1d\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e5f\u4e0d\u80fd\u7528\u4e86 dup,dup2 \u590d\u5236\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0cdup2()\u8fd8\u80fd\u5f97\u5b9a\u5411\u3002 \u601d\u8003\uff1aclose\u51fd\u6570\u80fd\u5426\u5b9e\u73b0\u534a\u5173\u95ed\uff1f","title":"07\u3001\u534a\u5173\u95ed\uff0820200408\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#08netstat20200407","text":"\u7528netstat\u6355\u6349\u8fdb\u7a0b\u7684\u72b6\u6001\uff08\u5957\u63a5\u5b57\u901a\u4fe1\uff09 -a\uff0c\u9ed8\u8ba4\u4e0d\u663e\u793aLISTEN\u76f8\u5173\uff0c\u6240\u4ee5\u8981\u7528a -p\uff0c\u663e\u793a\u5efa\u7acb\u76f8\u5173\u94fe\u63a5\u7684\u7a0b\u5e8f\u540d -n\uff0c\u62d2\u7edd\u663e\u793a\u522b\u540d\uff0c\u80fd\u663e\u793a\u6570\u5b57\u7684\u5168\u90e8\u8f6c\u5316\u4e3a\u6570\u5b57 -t\uff08tcp\uff09\u4ec5\u663e\u793atcp\u76f8\u5173\u9009\u9879 -u\uff08udp\uff09\u4ec5\u663e\u793audp\u76f8\u5173\u9009\u9879 l \u4ec5\u5217\u51fa\u6709\u5728Listen\uff08\u76d1\u542c\uff09\u7684\u670d\u52a1\u72b6\u6001 grep -apn \u670d\u52a1\u7aef\u6c38\u8fdc\u6709\u4e2a\u76d1\u542c\u5957\u63a5\u5b57 \uff0c\u6700\u540e\u770b\u540d\u79f0\u5224\u65ad\u670d\u52a1\u5668\u8fd8\u662f\u5ba2\u6237\u7aef\u3002 \u7b2c1\u4e2aip+port\u8868\u793a\u5f53\u524d\u540d\u79f0\u7684\u672c\u5730IP+Port\uff0c\u7b2c2\u4e2a\u662f\u8fde\u7684\u8fdc\u7aef\u7684IP+Port\u3002 TIME_WAIT \uff0c\u4e3b\u52a8\u65ad\u5f00\u7684\u4e00\u65b9\uff0c\u4f1a\u6709\u4e00\u4e2aTIME_WAIT\u72b6\u6001 \uff0c\u8fd9\u4e2a\u7b49\u5f85\u5927\u6982\u662f1min\u3002 FIN_WAIT2 \u548c CLOSE_WAIT \u53c8\u5206\u522b\u662f\u8c01\u662f\u53d1\u8d77\u4eba\u5462\uff1f","title":"08\u3001netstat\u547d\u4ee4\uff0820200407\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#0920200409","text":"\u4f5c\u4e3aserver\u7aef\u4e3b\u52a8\u65ad\u5f00\u8fde\u63a5\u540e\uff0c\u518d\u542f\u52a8\u4f1a\u6709\u201cAddress already in use\u201d\uff0c\u539f\u56e0\u662f \u4e3b\u52a8\u65ad\u5f00\u8fde\u63a5\u7684\u4e00\u65b9\u67092MSL\u7684\u7b49\u5f85\u65f6\u957f \u3002--lionel\uff0c\u6211\u5728\u5b9a\u4f4d\u95ee\u9898\u7684\u65e5\u5fd7\u91cc\u5c31\u89c1\u8fc7\uff0c\u4f46\u5f53\u65f6\u4e0d\u77e5\u9053\u5565\u539f\u56e0\u5462\u3002 \u5f53\u7136\u4e5f\u53ef\u4ee5\u7528 \u7aef\u53e3\u590d\u7528 \u7684\u65b9\u5f0f\u89e3\u51b3\u3002 \u7aef\u53e3\u590d\u7528\u7684\u7528\u9014 \u9632\u6b62\u670d\u52a1\u5668\u91cd\u542f\u65f6\u4e4b\u524d\u7ed1\u5b9a\u7684\u7aef\u53e3\u8fd8\u672a\u91ca\u653e \u7a0b\u5e8f\u7a81\u7136\u9000\u51fa\u800c\u7cfb\u7edf\u6ca1\u6709\u91ca\u653e\u7aef\u53e3 \u8bbe\u7f6e\u65b9\u6cd5 int opt = 1; setsockopt(sockfd, SOL_SOCKET,SO_REUSEADDR,(const void*)&amp;opt, sizeof(opt)); \u6587\u4ef6\u63cf\u8ff0\u7b26\u662f\u76d1\u542c\u63cf\u8ff0\u7b26 \u3002 \u6ce8\u610f\u4e8b\u9879 \u5728\u7ed1\u5b9a\u4e4b\u524d\u8bbe\u7f6e\u7aef\u53e3\u590d\u7528\u7684\u5c5e\u6027 \u3002","title":"09\u3001\u7aef\u53e3\u590d\u7528\u8bbe\u7f6e\uff0820200409\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#10io20200408","text":"IO\u64cd\u4f5c\u65b9\u5f0f \u963b\u585e\u7b49\u5f85 \u597d\u5904\uff1a\u4e0d\u5360CPU\u5b9d\u8d35\u7684\u65f6\u95f4\u7247 \u7f3a\u70b9\uff1a\u540c\u4e00\u65f6\u523b\u53ea\u80fd\u5904\u7406\u4e00\u4e2a\u64cd\u4f5c\uff0c\u6548\u7387\u4f4e \u591a\u8fdb\u7a0b/\u591a\u7ebf\u7a0b \u89e3\u51b3\uff0c\u53ea\u7b49\u5f85\uff0c\u518d\u7528\u5b50\u7ebf\u7a0b/\u5b50\u7ebf\u7a0b\u5904\u7406\u76f8\u5e94\u4e1a\u52a1\uff0c \u521b\u5efa\u8fdb\u7a0b/\u7ebf\u7a0b\u592a\u8017\u8d39\u8d44\u6e90 \u975e\u963b\u585e\uff0c\u5fd9\u8f6e\u8be2 \u4f18\u70b9\uff1a\u63d0\u9ad8\u4e86\u7a0b\u5e8f\u7684\u6267\u884c\u6548\u7387 \u7f3a\u70b9\uff1a\u9700\u8981\u5360\u7528\u66f4\u591a\u7684CPU\u548c\u7cfb\u7edf\u8d44\u6e90 \u5355\u4efb\u52a1/\u591a\u4efb\u52a1 \uff08\u4e0d\u65ad\u95ee\uff09 \u89e3\u51b3\u65b9\u6848\uff1a\u4f7f\u7528IO\u591a\u8def\u8f6c\u63a5\u6280\u672fselect/poll/epoll \u7b2c\u4e00\u79cd\uff1aselect/poll \u5148\u59d4\u6258\u5185\u6838\u5e2e\u6211\u4eec\u68c0\u6d4b\u4e00\u4e0b\u6709\u54ea\u4e9b\u5ba2\u6237\u7aef\u4f1a\u8ddf\u6211\u901a\u4fe1 \uff0c\u901a\u8fc7 select() \u6765\u5b9e\u73b0\u3002 select()\u53ea\u8bc6\u6570\u4e0d\u8ba4\u5b57\uff0c\u53ea\u4f1a\u544a\u8bc9\u4f60\u6709\u51e0\u4e2a\u5feb\u9012\uff08\u5ba2\u6237\u7aef\uff09\u5230\u4e86 \uff0c\u4f46\u662f\u54ea\u4e2a\u5feb\u9012\uff0c\u9700\u8981\u6328\u4e2a\u904d\u5386\u6240\u6709\u5ba2\u6237\u7aef\u3002 poll\u904d\u5386\u7684\u662f\u7ebf\u6027\u8868\u3002 \u7b2c\u4e8c\u79cd\uff1aepoll epoll()\u4e0d\u4ec5\u544a\u8bc9\u4f60\u6570\u91cf\uff0c\u4e5f\u4f1a\u544a\u8bc9\u4f60\u54ea\u4e2a\u5feb\u9012\u516c\u53f8\u7684\u5feb\u9012 \u3002 epoll\u904d\u5386\u7684\u662f\u7ea2\u9ed1\u6811\u3002 \u4ee5\u53d6\u5feb\u9012\u7684\u4f8b\u5b50\u6765\u8bb2","title":"10\u3001IO\u591a\u8def\u8f6c\u6362\u8bb2\u89e3\uff0820200408\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#11io20200408","text":"\u5148\u6784\u9020\u4e00\u5f20\u6709\u5173\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u5217\u8868\uff0c\u5c06\u8981\u76d1\u542c\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u6dfb\u52a0\u5230\u8be5\u8868\u4e2d \u963b\u585e\u4fe1\u53f7\u96c6\u8868/\u81ea\u5b9a\u4e49\u4fe1\u53f7\u96c6\u8868\uff0c\u518d\u7528 sigpromask() \u662f\u8fd9\u4e24\u5f20\u7684\u6865\u6881\u3002 \u7136\u540e\u8c03\u7528\u4e00\u4e2a\u51fd\u6570\uff0c\u76d1\u542c\u8be5\u8868\u4e2d\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u76f4\u63a5\u8fd9\u4e9b\u63cf\u8ff0\u7b26\u8868\u4e2d\u7684\u4e00\u4e2a\u8fdb\u884cI/O\u64cd\u4f5c\u65f6\uff0c\u8be5\u51fd\u6570\u624d\u8fd4\u56de \u8be5\u51fd\u6570\u4e3a\u963b\u585e\u51fd\u6570 \u51fd\u6570\u5bf9\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u68c0\u6d4b\u64cd\u4f5c\u662f\u7531\u5185\u6838\u5b8c\u6210\u7684 \u5728\u8fd4\u56de\u65f6\uff0c\u5b83\u544a\u8bc9\u8fdb\u7a0b\u6709\u591a\u5c11\uff08\u54ea\u4e9b\uff09\u63cf\u8ff0\u7b26\u8981\u8fdb\u884cI/O\u64cd\u4f5c \u901a\u8fc7\u8c03\u7528selec()\u51fd\u6570\uff0c\u628a\u6784\u9020\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u5217\u8868\u7ed9\u5230\u5185\u6838\uff1f --\u662f\u8fd9\u6837\u7684\u5417\uff1f","title":"11\u3001\u5185\u6838\u5927\u81f4\u662f\u5982\u4f55\u5b9e\u73b0IO\u8fde\u63a5\u7684\uff0820200408\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#12select20200409","text":"int select(int nfds, fd_set *readfds, fd_set *writefds, fd_set *exceptfds, struct timeval *timeout); ndfs\uff1a\u4e00\u7ec4\u63cf\u8ff0\u7b26\u4e2d\u6700\u5927\u7684\u503c\u518d\u52a01\uff1b\u6700\u591a\u4f201024 fd_set \u662f\u4e2a\u6570\u7ec4\uff0c\u5927\u5c0f\u662f16\u4e2a\uff0c\u6240\u4ee5\u6700\u591a\u4f201024\uff0816 \u4e58 8\u4f4d \u4e58 \u5b57\u8282\uff09\uff0c\u6240\u4ee5\u6700\u591a1024\u4e2a\u6807\u5fd7\u4f4d\u3002 readfds\uff1a \u4f20\u5165\u4f20\u51fa\u53c2\u6570 \uff0c\u8bfb\u96c6\u5408 writefds\uff1a\u4e00\u822c\u4f20\u7a7a \uff08\u5199\u662f\u4e3b\u52a8\u64cd\u4f5c\uff0c\u4e0d\u6355\u6349\uff09 exceptfds\uff1a\u4e00\u822c\u4f20\u7a7a \u5f02\u5e38\u96c6\u5408 timeout\uff1a \u901a\u8fc7\u8bbe\u7f6e\u5b83\u6765\u786e\u5b9a\u662f\u5426\u963b\u585e NULL\uff1a\u6c38\u4e45\u963b\u585e\uff08\u5f53\u68c0\u6d4b\u5230fd\u6709\u53d8\u5316\u7684\u65f6\u5019\u8fd4\u56de\uff09 \u8981\u8ba9\u7ed3\u6784\u4f53\u53d8\u91cf\u7684a\u6709\u503c\uff0ca.tv_sec=0\uff0ca.tv_usec=0\u3002 \u6587\u4ef6\u63cf\u8ff0\u7b26\u96c6\u7c7b\u578b\uff1a fd_set rdset; FD_ZERO()\u6e05\u7a7a FD_CLR()\u5220\u9664\u67d0\u9879 FD_SET()\u6dfb\u52a0\u6587\u4ef6\u63cf\u8ff0\u7b26 FD_ISSET()\u5224\u65ad\u662f\u5426\u5b58\u5728\u96c6\u5408\u4e2d \u6ca1\u6709\u8bbe\u7f6e\u4e0a\uff0c\u5c31\u662f0 select\u51fd\u6570\u7684\u4f18\u7f3a\u70b9 \u4f18\u70b9 \u8de8\u5e73\u53f0 \u7f3a\u70b9 \u5185\u6838\u7684\u5f00\u9500\u592a\u5927\uff08\u4e00\u662f\u62f7\u8d1d\uff1b\u4e8c\u662f\u904d\u5386\uff09 select\u652f\u6301\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u6570\u91cf\u592a\u5c0f\u4e86\uff0c\u9ed8\u8ba4\u662f1024","title":"12\u3001select\u7684\u53c2\u6570\u548c\u8fd4\u56de\u503c\uff0820200409\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#13_1","text":"","title":"13\u3001\u590d\u4e60\uff08\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#14select20200409","text":"\u9700\u6c42\uff1a\u5ba2\u6237\u7aefA,B,C,D,E,F\u8fde\u63a5\u5230\u670d\u52a1\u5668\uff1b\u5206\u522b\u5bf9\u5e94\u6587\u4ef6\u63cf\u8ff0\u7b263\uff0c4\uff0c100\uff0c101\uff0c102\uff0c103\uff0cABC\u53d1\u9001\u4e86\u6570\u636e\u3002 \u7b2c\u4e00\u6b65\uff1a\u521b\u5efafd_set\u7c7b\u578b\u7684reads; \u8fd9\u662f\u7528\u6237\u7a7a\u95f4 \u7b2c\u4e8c\u6b65\uff1a\u6dfb\u52a0\u5230reads\uff0c FD_SET(3,&reads) \u7b2c\u4e09\u6b65\uff1a select(103+1,&reads,NULL,NULL,NULL); \u5185\u6838\u4f1a\u628a\u7528\u6237\u7a7a\u95f4\u7684reads\uff0c\u62f7\u8d1d\u5230\u5185\u6838\u7a7a\u95f4\u3002 \u5185\u6838\u6839\u636e\u503c\u4e3a1\uff0c\u53bb\u627e\u6587\u4ef6\u63cf\u8ff0\u7b26\uff1b \u5982\u679c\u6587\u4ef6\u63cf\u8ff0\u7b26\u6ca1\u6709\u6570\u636e\uff0c\u5185\u6838\u4f1a\u628a\u503c\u4ece1\u53d8\u4e3a0 \uff0c\u6709\u503c\u7684\u8bdd\uff0c\u5c31\u4e0d\u53d8\u3002 \u5185\u6838\u628a\u4fee\u6539\u8fc7\u7684\u8868\u4f1a\u518d\u4f20\u7ed9\u7528\u6237\u7a7a\u95f4\uff0c\u4f1a\u8986\u76d6\u5230\u7528\u6237\u7a7a\u95f4\u7684reads \uff08\u8fd9\u6837\u5c31\u53ef\u80fd\u4e0d\u4e00\u6837\u4e86\uff09 \u5f97\u5b9a\u4e49\u4e24\u4e2afd_set\u53d8\u91cf \uff0c\u7528\u4e8e\u5bf9\u6bd4\u3002","title":"14\u3001select\u5de5\u4f5c\u8fc7\u7a0b\uff0820200409\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#15select20200410","text":"[select\u4f2a\u4ee3\u7801\u5b9e\u73b0.cpp]","title":"15\u3001select\u4f2a\u4ee3\u7801\u5b9e\u73b0\uff0820200410\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#16select20200410","text":"[day12_17select.c]","title":"16\u3001select\u4ee3\u7801\u5b9e\u73b0\uff0820200410\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#17poll20200410","text":"poll\u7684\u6570\u636e\u7ed3\u6784\u662f\u4e2a\u94fe\u63a5\uff0cepoll\u7684\u6570\u636e\u7ed3\u6784\u662f\u4e2a\u6811\u3002 poll\u4e24\u5757\u4e92\u62f7\u8d1d\u4e5f\u6709\u5f00\u9500\u3002 int poll(struct pollfd *fd, nfds_t nfds, int timeout) pollfd\uff1a\u6570\u7ec4\u7684\u5730\u5740 nfds\uff1a\u6570\u7ec4\u7684\u6700\u5927\u957f\u5ea6\uff0c\u6570\u7ec4\u4e2d\u6700\u540e\u4e00\u4e2a\u4f7f\u7528\u7684\u5143\u7d20\u4e0b\u6807+1 \u5185\u6838\u4f1a\u8f6e\u8be2\u68c0\u6d4bfd\u6570\u7ec4\u7684\u6bcf\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26 timeout\uff1a -1\uff1a\u6c38\u4e45\u963b\u585e 0\uff1a\u8c03\u7528\u5b8c\u6210\u7acb\u5373\u8fd4\u56de >0 \uff1a\u7b49\u5f85\u7684\u65f6\u957f\u6beb\u79d2 \u8fd4\u56de\u503c\uff1aIO\u53d1\u9001\u53d8\u5316\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u4e2a\u6570 \u6ca1\u592a\u597d\u597d\u542c --\u540e\u9762\u518d\u8865\u5145\u8fd9\u90e8\u5206","title":"17\u3001poll\u51fd\u6570\u4ecb\u7ecd\uff0820200410\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#18pollio20200411","text":"\u6bd4\u8f83poll.c\u548cselect.c \uff0c\u8fd9\u4e24\u4e2a\u90fd\u627e\u4ed6\u4eec\u7684\u4f8b\u5b50\u5427\u3002 \u8981\u628a\u6d41\u7a0b\u641e\u6e05\u695a \u3002","title":"18\u3001poll\u5b9e\u73b0IO\u8f6c\u63a5\u4ee3\u7801\u5206\u6790\uff0820200411\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#day13epoll-udp","text":"","title":"day13\u3001epoll-udp"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#01_1","text":"","title":"01\u3001\u77e5\u8bc6\u70b9\u6982\u8ff0"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#02gdb20200412","text":"set args \u8bbe\u7f6e\u53c2\u6570 r \u8fd0\u884c \u6700\u7ec8\u5b9a\u4f4d\u662f pthread_detach() \u5f15\u7528\u53c2\u6570\u6709\u9519\u3002 \u6211\u5bf9pthread_detach()\u8fd8\u4e0d\u719f\u6089","title":"02\u3001\u901a\u8fc7gdb\u5b9a\u4f4d\u6bb5\u9519\u8bef\u7684\u4f4d\u7f6e\uff0820200412\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#03tcp","text":"","title":"03\u3001tcp\u72b6\u6001\u8f6c\u6362\u590d\u4e60\uff08\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#04select","text":"","title":"04\u3001select\u590d\u4e60\uff08\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#05epoll20200412","text":"epoll\u5728\u5185\u90e8\u662f\u4e2a\u6811\u7ed3\u6784 \u3002 \u6301\u5728\u6811\u4e0a\u7684\u662f struct epoll_event \u7c7b\u578b\u91cc\u7684 fd \u3002 epoll_create() \u7528\u6765\u751f\u6210\u4e00\u4e2a\u6811\u7684\u6839\u7ed3\u70b9 \u53c2\u6570size\uff1aepoll\u4e0a\u80fd\u5173\u6ce8\u7684\u6700\u5927\u63cf\u8ff0\u7b26\u6570 epoll_clt() \u63a7\u5236\u67d0\u4e2aepoll\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e8b\u4ef6\uff0c\u53ef\u4ee5\u6ce8\u518c\u3001\u4fee\u6539\u3001\u5220\u9664 epfd\u53c2\u6570\uff1acreate()\u521b\u5efa\u7684 op\u53c2\u6570\uff1a EPOLL_CTL_ADD EPOLL_CTL_MOD EPOLL_CTL_DEL fd\u53c2\u6570\uff1a\u5173\u8054\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26 event\u53c2\u6570\uff1a\u544a\u8bc9\u5185\u6838\u8981\u76d1\u542c\u4ec0\u4e48\u4e8b\u4ef6 epoll_wait() \u7b49\u5f85IO\u4e8b\u4ef6\u53d1\u751f---\u53ef\u4ee5\u8bbe\u7f6e\u963b\u585e\u7684\u51fd\u6570 epid\u53c2\u6570\uff1aepoll_create()\u521b\u5efa\u7684 struct epoll_event* events \u53c2\u6570\uff1a\u7ed3\u6784\u4f53\u6570\u7ec4\uff0c\u4f5c\u7528\u662f\uff08\u6709\u54ea\u51e0\u4e2a\u53d8\u5316\u4e86\uff0c\u90fd\u5728\u8fd9\u4e2a\u7ed3\u6784\u4f53\u91cc\uff09 \u4f20\u51fa\u53c2\u6570 maxevents\u53c2\u6570\uff1a\u544a\u8bc9\u5185\u6838events\u7684\u5927\u5c0f\uff08\u7ed3\u6784\u4f53\u6570\u7ec4\u7684\u5bb9\u91cf\uff09 timeout\u53c2\u6570\uff1a\u8d85\u65f6\u65f6\u95f4 -1\uff1a\u6c38\u4e45\u963b\u585e 0\uff1a\u7acb\u5373\u8fd4\u56de\uff0c\u963b\u585e0\u6beb\u79d2\uff0c\u7acb\u5373\u8fd4\u56de\u4e86 \u5927\u4e8e0\uff1a\u963b\u585e\u65f6\u957f\uff0c\u5355\u4f4d\u662f\u6beb\u79d2","title":"05\u3001epoll\u76f8\u5173\u7684\u51fd\u6570\u4ecb\u7ecd\uff0820200412\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#06epoll20200415","text":"[\u4f2a\u4ee3\u7801.c]","title":"06\u3001epoll\u5de5\u4f5c\u6d41\u7a0b\uff0820200415\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#07","text":"","title":"07\u3001\uff08\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#08epoll20200415","text":"","title":"08\u3001epoll\u6a21\u578b\u4ee3\u7801\u5b9e\u73b0\uff0820200415\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#09epoll","text":"","title":"09\u3001epoll\u590d\u4e60\uff08\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#10epoll20200419","text":"\u9ed8\u8ba4\u7684\u89e6\u53d1\u5de5\u4f5c\u6a21\u5f0f \u6c34\u5e73\u89e6\u53d1\u6a21\u5f0f \u53ea\u8981fd\u5bf9\u5e94\u7684\u7f13\u51b2\u533a\u6709\u6570\u636e\uff0c \u6839\u636e\u8bfb\u6765\u89e3\u91ca epoll_wait()\u8fd4\u56de \u8fd4\u56de\u7684\u6b21\u6570\u4e0e\u53d1\u9001\u6570\u636e\u7684\u6b21\u6570\u6ca1\u6709\u5173\u7cfb \u53d1100\u4e2a\u6570\u636e\uff0c\u6bcf\u6b21\u53ea\u8bfb1\u4e2a\u7684\u8bdd\uff0c\u5c31\u8981\u8bfb100\u6b21\u3002 \u4e0d\u9700\u8981\u989d\u5916\u7684\u64cd\u4f5c [lt_epoll.c] \u8bfb\u6570\u636e\u65f6\uff0c\u539f\u6765\u7684buf[1024]\uff0cbufchar[5]\u3002 printf()\u662f\u6807\u51c6C\u5e93\u51fd\u6570\uff0c\u6709\u9ed8\u8ba4\u7f13\u51b2\u533a8K\uff0c\u662f \u884c\u7f13\u51b2 \uff0c\u52a0 \\n \u624d\u4f1a\u5f3a\u5237\u7f13\u51b2\u533a\u3002 \u6362\u6210 write(STDOUT_FILENO,buf,len); \uff0c \u539f\u5148\u5b9a\u4e49\u7684buf\uff0c\u6700\u540e\u4e00\u4f4d\u6ca1\u6709\u7ed9\u5b83\u5f3a\u5236\u52a0\u4e00\u4e2a \\0 \uff0c\u8fd9\u4e2a\u5728\u4ee3\u7801\u4e2d\u786e\u5b9e\u6709\u98ce\u9669\u3002 linux\u7cfb\u7edf\u51fd\u6570\uff0c\u6709\u54ea\u4e9b\u3002 epoll_wait() \u8c03\u7528\u6b21\u6570\u8d8a\u591a\uff0c\u7cfb\u7edf\u7684\u5f00\u9500\u8d8a\u5f0f\u3002","title":"10\u3001epoll\u6c34\u5e73\u89e6\u53d1\u6a21\u5f0f\uff0820200419\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#1120200419","text":"ET fd-\u9ed8\u8ba4\u963b\u585e\u5c5e\u6027 \u5ba2\u6237\u7aef\u7ed9server\u53d1\u6570\u636e\uff1a \u53d1\u4e00\u6b21\u6570\u636eserver\u7684epoll_wait()\u88ab\u89e6\u53d1\u4e00\u6b21\uff08\u5373\u8fd4\u56de\u4e00\u6b21\uff09 \u4e0d\u7ba1\u6709\u6ca1\u6709\u8bfb\u5b8c\uff0c\u90fd\u53ea\u8fd4\u56de\u4e00\u6b21\uff0c \u4e0d\u5728\u4e4e\u6570\u636e\u6709\u6ca1\u6709\u8bfb\u5b8c \u5982\u679c\u8bfb\u4e0d\u5b8c\uff0c\u5982\u4f55\u5168\u90e8\u8bfb\u51fa\u6765\uff1f while(recv()); \u8fd9\u79cd\u5199\u6cd5\u7684\u526f\u4f5c\u7528\u662f \u6570\u636e\u8bfb\u5b8c\u4e4b\u540erecv\u4f1a\u963b\u585e \u3002 \u89e3\u51b3\u963b\u585e\u95ee\u9898\uff08\u8bbe\u7f6e\u975e\u963b\u585e--fd\uff09 [et_poll.c] \u8fb9\u5ef6\u89e6\u53d1\uff1a\u8981\u52a0\u4e2a\u5b8f temp.events = EPOLLIN | EPOLLET;","title":"11\u3001\u8fb9\u6cbf\u89e6\u53d1\u6a21\u5f0f\uff0820200419\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#1220200419","text":"\u6548\u7387\u6700\u9ad8 \u5982\u4f55\u8bbe\u7f6e\u975e\u963b\u585e open()\uff0c\u901a\u8fc7\u8bbe\u7f6eflags\u7684\u5fc5\u9009\u9879\uff0c\u4ee5\u53ca\u53ef\u9009\u9879 O_NOBLOCK \uff0c \u9002\u7528\u4e8e\u7ec8\u7aef\u6587\u4ef6/dev/tty fcntl() \u66f4\u6539\u5c5e\u6027\u524d\u5148\u83b7\u53d6 int flag = fcntl(fd,F_GETFL); \u8bbe\u7f6e\u4e00\u4e0b flag |= O_NONBLOCK; \u518d\u8bbe\u7f6e\u56de\u53bb fcntl(fd,F_SETFL,flag); \u5c06\u7f13\u51b2\u533a\u7684\u5168\u90e8\u6570\u636e\u90fd\u8bfb\u51fa while(recv() >0 ) {printf();} //\u5f53\u7f13\u51b2\u533a\u6570\u636e\u8bfb\u5b8c\u4e4b\u540e\uff0c\u8fd4\u56de\u662f\u5426\u4e3a0\uff1f [noblock_et_poll.c] while()\u540e\u518d\u8fdb\u884c\u6570\u636e\u56de\u5199 send(fd,buf,len,0); len ==0 prinf(\"\u65ad\u5f00\u8fde\u63a5\");close(fd); \u8fd8\u5f97\u4ece\u6811\u4e0a\u5220\u9664 len == -1,printf();exit(1); \u8fd9\u91cc\u5224\u65ad\u4e00\u4e0b errno==EAGAIN \u963b\u585e \u6570\u636e\u8bfb\u5b8c\u4e4b\u540e \u975e\u963b\u585e \u5f3a\u884c\u8bfb\u4e86\u4e00\u4e2a\u6ca1\u6709\u6570\u636e\u7684\u7f13\u51b2\u533a\uff08fd\uff09 \u5224\u65ad errno==EAGAIN","title":"12\u3001\u8fb9\u6cbf\u975e\u963b\u585e\u6a21\u5f0f\uff0820200419\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#13102420200419","text":"select--\u7a81\u7834\u4e0d\u4e86\uff0c\u9700\u8981\u7f16\u8bd1\u5185\u6838 \u901a\u8fc7\u6570\u7ec4\u5b9e\u73b0\u7684\uff0c \u6570\u7ec4\u6709\u56fa\u5b9a\u5927\u5c0f poll\u548cepoll\u53ef\u4ee5\u7a81\u78341024\u9650\u5236 poll\u662f\u901a\u8fc7\u5185\u90e8\u94fe\u8868\u5b9e\u73b0\u7684 epoll\u662f\u901a\u8fc7\u7ea2\u9ed1\u6811\u6765\u5b9e\u73b0\u7684 \u67e5\u770b\u53d7\u8ba1\u7b97\u673a\u786c\u4ef6\u9650\u5236\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0a\u9650 cat\u6216vi /proc/sys/fs.file-max ulimit -a \u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u4fee\u6539\u4e0a\u9650\u503c /etc/security/limits.conf ulimit -n \u4fee\u6539open files\u7684\u6570\u91cf","title":"13\u3001\u6587\u4ef6\u63cf\u8ff0\u7b26\u7a81\u78341024\uff0820200419\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#14udp20200413","text":"\u57fa\u4e8eSOCK_STREAM\uff0c \u9762\u5411\u65e0\u8fde\u63a5 \uff0c\u4e0d\u9700\u8981 connect() \u670d\u52a1\u5668\u7aef\uff1a Server\u53ea\u6709\u4e00\u4e2a \u521b\u5efa\u5957\u63a5\u5b57 int fd = socket(af_inet,sock_dgram,0); \u7ed1\u5b9a\u672c\u5730IP\u548c\u7aef\u53e3 bind() \u901a\u4fe1\uff1a\u63a5\u6536\u6570\u636e recvfrom() \u53d1\u9001\u6570\u636e sendto() \u5173\u95ed\u5957\u63a5\u5b57 close() \u5ba2\u6237\u7aef \u521b\u5efa\u5957\u63a5\u5b57 int fd = socket(af_inet,sock_dgram,0); \u901a\u4fe1\uff1a\u53d1\u9001\u6570\u636e sendto() \u63a5\u6536\u6570\u636e recvfrom() \u5173\u95ed\u5957\u63a5\u5b57 close() \u5ba2\u6237\u7aef\u662f\u901a\u8fc7\uff08IP+\u7aef\u53e3\uff09\u53d1\u9001\u7ed9\u670d\u52a1\u5668\u7aef\uff0c\u670d\u52a1\u5668\u4f1a\u4fdd\u5b58\u5ba2\u6237\u7aef\u7684IP+\u7aef\u53e3\u4fe1\u606f \u3002 qt\u91cc\u9762\uff0c\u4e24\u8005\u6d41\u7a0b\u90fd\u5dee\u4e0d\u591a\uff0c\u5982\u679c\u4efb\u4f55\u4e00\u7aef\u60f3\u63a5\u53d7\u6570\u636e\uff0c\u5fc5\u987b\u7ed1\u5b9a\u7aef\u53e3 \u56e0\u4e3a\u662f\u88ab\u5c01\u88c5\u8fc7\u4e86\u3002 \u8d8a\u5c01\u88c5\u8d8a\u7b80\u5355\uff0c\u8d8a\u7b80\u5355\u8d8a\u4e0d\u77e5\u9053\u600e\u4e48\u56de\u4e8b","title":"14\u3001udp\u901a\u4fe1\u6d41\u7a0b\uff0820200413\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#15udp20200413","text":"recvfrom() sendto() [server.c]","title":"15\u3001udp\u670d\u52a1\u5668\u7aef\u4ee3\u7801\u5b9e\u73b0\uff0820200413\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#16udp20200413","text":"[client.c]","title":"16\u3001udp\u5ba2\u6237\u7aef\u4ee3\u7801\u5b9e\u73b0\uff0820200413\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#day14-","text":"","title":"day14\u3001\u5e7f\u64ad-\u7ec4\u64ad-\u672c\u5730\u5957\u63a5\u5b57"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#01_2","text":"","title":"01\u3001\u77e5\u8bc6\u70b9\u6982\u8ff0"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#02epoll","text":"","title":"02\u3001epoll\u590d\u4e60"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#03udp","text":"","title":"03\u3001udp\u901a\u4fe1\u6d41\u7a0b\u590d\u4e60\uff08\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#04tcp_udp20200419","text":"1\u3001tcp\u4f7f\u7528\u573a\u666f \u5bf9\u6570\u636e\u5b89\u5168\u6027\u8981\u6c42\u9ad8\u7684\u65f6\u5019 \u767b\u5f55\u6570\u636e\u7684\u4f20\u8f93 \u6587\u4ef6\u4f20\u8f93 http\u534f\u8bae \u4f20\u8f93\u5c42\u534f\u8bae--tcp 2\u3001udp\u4f7f\u7528\u573a\u666f \u6548\u7387\u9ad8--\u5b9e\u65f6\u6027\u8981\u6c42\u6bd4\u8f83\u9ad8 \u89c6\u9891\u804a\u5929 \u901a\u8bdd \u6709\u5b9e\u529b\u7684\u5927\u516c\u53f8 \u5148\u4f7f\u7528upd\uff0c\u5728\u5e94\u7528\u5c42\u81ea\u5b9a\u4e49\u534f\u8bae\uff0c\u505a\u6570\u636e\u6821\u9a8c","title":"04\u3001tcp_udp\u4f7f\u7528\u573a\u666f\uff0820200419\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#0520200419","text":"\u5e7f\u64ad\uff08\u53ea\u6709\u5728udp\u65f6\u624d\u53ef\u4ee5\uff09 \u670d\u52a1\u5668\uff1a\u53ea\u4e3b\u52a8\u53d1\u6570\u636e \u9700\u8981\u5e7f\u64ad\u5730\u5740\uff0c\u53d1\u9001\u5230\u56fa\u5b9a\u7aef\u53e3 \u7a97\u53e3\u5957\u63a5\u5b57--socket fd\u9700\u8981\u7ed1\u5b9a\u670d\u52a1\u5668IP\u548c\u7aef\u53e3 \u521d\u59cb\u5316\u5ba2\u6237\u7aefIP\u548c\u7aef\u53e3\u4fe1\u606f struct sockaddr_in cli; \u53d1\u9001\u6570\u636e sendto(fd,buf,len,0,) \u8bbe\u7f6e\u5e7f\u64ad\u6743\u9650 setsockopt() \u5ba2\u6237\u7aef\uff1a\u88ab\u52a8\u6536\u6570\u636e \u7ed1\u5b9a\u56fa\u5b9a\u7aef\u53e3 \uff0c\u4f60\u4e0d\u7ed1\u5b9a\u56fa\u5b9a\u7aef\u53e3\uff0c\u4e5f\u4f1a\u6536\u5230\u6570\u636e\uff0c\u53ea\u4e0d\u8fc7\u4e0d\u5904\u7406\uff0c\u88ab\u5f53\u6210\u5783\u573e\u5904\u7406\u5904\u7406\u6389\u4e86 \u521b\u5efa\u5957\u63a5\u5b57 \u663e\u793a\u7ed1\u5b9aIP\u548c\u7aef\u53e3 bind() \u63a5\u6536\u6570\u636e--server\u6570\u636e recvfrom() \u9002\u7528\u8303\u56f4 \u53ea\u9002\u7528\u4e8e\u5c40\u57df\u7f51 \u5e7f\u64ad\u5730\u5740 XXX.XXX.123.255\uff0c123\u7f51\u6bb5\u7684\u90fd\u80fd\u6536\u5230\uff0c 255\u5c31\u662f\u5e7f\u64ad\u5730\u5740 \u3002 XXX.XXX.123.1\uff0c 1\u662f\u7f51\u5173 255.255.255.255\u6240\u6709\u7f51\u6bb5\u90fd\u80fd\u6536\u5230\u3002","title":"05\u3001\u5e7f\u64ad\u901a\u4fe1\u6d41\u7a0b\uff0820200419\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#0620200419","text":"[broadcast_server.c]","title":"06\u3001\u5e7f\u64ad\u670d\u52a1\u5668\u4ee3\u7801\u5b9e\u73b0\uff0820200419\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#0720200419","text":"[broadcast_client.c]","title":"07\u3001\u5e7f\u64ad\u5ba2\u6237\u7aef\u4ee3\u7801\u5b9e\u73b0\uff0820200419\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#0820200419","text":"","title":"08\u3001\u5e7f\u64ad\u5ba2\u6237\u7aef\u901a\u4fe1\u603b\u7ed3\uff0820200419\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#0920200420","text":"\u5e7f\u64ad\u53ea\u80fd\u7528\u4e8e\u5c40\u57df\u7f51\u8303\u56f4 \u3002 \u7ec4\u64ad\u53ef\u4ee5\u9002\u7528\u4e8e\u5c40\u57df\u7f51\u548cInternet \u7ec4\u64adServer \u53ea\u53d1\u9001\u6570\u636e \u9700\u8981\u4f7f\u7528\u7ec4\u64ad\u5730\u5740\uff0c\u53d1\u9001\u5230\u5ba2\u6237\u7aef\u5bf9\u5e94\u7684\u7aef\u53e38989 \u6dfb\u52a0\u7ec4\u64ad\u6743\u9650 \uff0c setsockopt() \u7ec4\u64adClient \u7ed1\u5b9a\u56fa\u5b9a\u7aef\u53e38989 \u52a0\u5165\u5230\u7ec4\u64ad\u5730\u5740\uff0c setsockopt() \u53ea\u63a5\u6536\uff0c\u4e0d\u53d1\u9001\u6570\u636e \u7ec4\u64ad\u5730\u5740 \uff084\u7c7b\uff09 224.0.0.0-224.0.0.255\uff08\u9884\u7559\u7684\u6c38\u4e45\u5730\u5740\uff09 239.0.0.0-239.255.255.255\uff08\u5c40\u57df\u7f51\uff09 struct ip_mreqn struct in_addr","title":"09\u3001\u7ec4\u64ad\u901a\u4fe1\u6d41\u7a0b\uff0820200420\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#102020420","text":"\u8981\u5bf9 struct ip_mreqn \u521d\u59cb\u5316\uff0c\u540d\u79f0\u8bb0\u4e3a \u7f8e\u4eba\u513f\u53bb\u54ea if_nametoindex() \u901a\u8fc7eth0\u8fd9\u6837\u7684\u540d\u79f0\uff0c\u83b7\u53d6mac\u5730\u5740\uff0c if\u4ee3\u8868ifconfig\u7684if \u3002 \u5bf9\u6bd4\u4e00\u4e0b\u7ec4\u64ad\u3001\u5e7f\u64ad\u7684\u4ee3\u7801","title":"10\u3001\u7ec4\u64ad\u670d\u52a1\u5668\u4ee3\u7801\u5b9e\u73b0\uff082020420\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#1120200420","text":"","title":"11\u3001\u7ec4\u64ad\u5ba2\u6237\u7aef\u4ee3\u7801\u5b9e\u73b0\uff0820200420\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#12_1","text":"","title":"12\u3001\u590d\u4e60"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#1320200421","text":"\u6587\u4ef6\u683c\u5f0f \u7ba1\u9053\uff1ap \u5957\u63a5\u5b57\uff1as \u8fd9\u4e24\u4e2a\u6587\u4ef6\u662f\u4f2a\u6587\u4ef6 \uff08\u5728\u78c1\u76d8\u4e0a\u5927\u5c0f\u6c38\u8fdc\u4e3a0\uff0c\u4e0d\u5b58\u5728\u78c1\u76d8\uff0c\u5b58\u5728\u5185\u6838\u7f13\u51b2\u533a\u91cc\uff09 \u6709\u4e24\u79cd\u65b9\u5f0f tcp\u6d41\u7a0b\uff0c \u8bb2\u8fd9\u4e2a udp \u670d\u52a1\u5668\u7aef \u521b\u5efa\u5957\u63a5\u5b57 int lfd = socket(AF_LOCAL,sock_stream,0) \u7ed1\u5b9a struct sockaddr_un serv; serv.sun_family=af_local; strcpy(serv.sun_path,\"server.socket\");bind(lfd,(struct sockaddr_un&serv,len); \u53ea\u6709\u7ed1\u5b9a\u6210\u529f\u540e\uff0c.socket\u6587\u4ef6\u624d\u80fd\u88ab\u521b\u4ef6\u51fa\u6765 \u8bbe\u7f6e\u76d1\u542c listen() \u7b49\u5f85\u63a5\u6536\u6d88\u606f\u8bf7\u6c42 struct sockaddr_un client; int len = sizeof(client); int cfd = accept(lfd,&client,&len); \u901a\u4fe1 send\u548crecv \u65ad\u5f00\u8fde\u63a5 close(cfd),close(lfd) \u5ba2\u6237\u7aef \u521b\u5efa\u5957\u63a5\u5b57 int lfd = socket(AF_LOCAL,sock_stream,0) \u7ed1\u5b9a\u4e00\u4e2a\u5957\u63a5\u5b57\u6587\u4ef6 \uff1a struct sockaddr_un client; client.sun_family=af_local; strcpy(client.sun_path,\"client.socket\");bind(lfd,(struct sockaddr_un&client,len); \u8fde\u63a5\u670d\u52a1\u5668\uff1a struct sockaddr_un serv; serv.sun_family=af_local; strcpy(serv.sun_path,\"server.socket\"); \uff0c \u7136\u540e\u518d\u8fde\u63a5server \uff0c connect(fd,&serv,sizeof(serv)); \u901a\u4fe1 send\u548crecv \u65ad\u5f00\u8fde\u63a5 close(cfd),close(lfd)","title":"13\u3001\u672c\u5730\u5957\u63a5\u5b57\u901a\u4fe1\u6d41\u7a0b\uff0820200421\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#14server20200421","text":"","title":"14\u3001\u672c\u5730\u5957\u63a5\u5b57Server\u5b9e\u73b0\uff0820200421\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#15client20200421","text":"","title":"15\u3001\u672c\u5730\u5957\u63a5\u5b57Client\u5b9e\u73b0\uff0820200421\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#1620200422","text":"\u4f5c\u7528\uff1a \u5224\u65ad\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u662f\u5426\u5904\u4e8e\u8fde\u63a5\u72b6\u6001 \u5fc3\u8df3\u673a\u5236 \u4e0d\u4f1a\u643a\u5e26\u5927\u91cf\u7684\u6570\u636e \u6bcf\u4e2a\u4e00\u5b9a\u65f6\u95f4 \u670d\u52a1\u5668->\u5ba2\u6237\u7aef/\u5ba2\u6237\u7aef->\u670d\u52a1\u5668\u53d1\u9001\u4e00\u4e2a\u6570\u636e\u5305 \u5fc3\u8df3\u5305\u770b\u6210\u4e00\u4e2a\u534f\u8bae \u5e94\u7528\u5c42\u534f\u8bae \u5224\u65ad\u7f51\u7edc\u662f\u5426\u65ad\u5f00 \u6709\u591a\u4e2a\u8fde\u7eed\u7684\u5fc3\u8df3\u5305\u6ca1\u6536\u5230/\u6ca1\u6709\u56de\u590d \u5173\u95ed\u901a\u4fe1\u7684\u5957\u63a5\u5b57 \u91cd\u8fde \u91cd\u65b0\u521d\u59cb\u5957\u63a5\u5b57 \u7ee7\u7eed\u53d1\u9001\u5fc3\u8df3\u5305 \u4e52\u4e53\u5305 \u6bd4\u5fc3\u8df3\u5305\u643a\u5e26\u7684\u6570\u636e\u591a\u4e00\u4e9b \u9664\u4e86\u77e5\u9053\u8fde\u63a5\u662f\u5426\u5b58\u5728\uff0c\u8fd8\u80fd\u83b7\u53d6\u4e00\u4e9b\u4fe1\u606f \u5fc3\u8df3\u5305\u7684\u5b9e\u73b0 -- \u770b\u4e00\u4e0b\u9879\u76ee\u91cc\u7684\u4ee3\u7801","title":"16\u3001\u5fc3\u8df3\u5305\uff0820200422\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#17epollmain20200424","text":"[epoll_loop.c]\u7684\u6e90\u7801\u5b66\u4e60 \u770b\u4ee3\u7801\u65f6\uff0c\u5148\u4e0d\u8981\u8ffd\u6c42\u7ec6\u8282\uff0c\u8981\u5148\u7406\u6e05\u6d41\u7a0b \u3002","title":"17\u3001epoll\u53cd\u5e94\u5806\u6a21\u578bmain\u51fd\u6570\uff0820200424\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#18epoll20200425","text":"","title":"18\u3001epoll\u53cd\u5e94\u5806\u6a21\u578b\u76d1\u542c\u5957\u63a5\u5b57\u521d\u59cb\u51fd\u6570\uff0820200425\uff09"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#19epollacceptconn","text":"","title":"19\u3001epoll\u53cd\u5e94\u5806\u6a21\u578bacceptconn\u51fd\u6570"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#day15libevent","text":"","title":"day15\u3001libevent"},{"location":"90lecture/01Linux%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/#day16xml-json","text":"","title":"day16\u3001xml json"}]}